(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function xl(e,t){const n=Object.create(null),a=e.split(",");for(let o=0;o<a.length;o++)n[a[o]]=!0;return t?o=>!!n[o.toLowerCase()]:o=>!!n[o]}function st(e){if(Be(e)){const t={};for(let n=0;n<e.length;n++){const a=e[n],o=yt(a)?Nh(a):st(a);if(o)for(const r in o)t[r]=o[r]}return t}else{if(yt(e))return e;if(nt(e))return e}}const Lh=/;(?![^(]*\))/g,Rh=/:([^]+)/,jh=/\/\*.*?\*\//gs;function Nh(e){const t={};return e.replace(jh,"").split(Lh).forEach(n=>{if(n){const a=n.split(Rh);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function et(e){let t="";if(yt(e))t=e;else if(Be(e))for(let n=0;n<e.length;n++){const a=et(e[n]);a&&(t+=a+" ")}else if(nt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function Vh(e){if(!e)return null;let{class:t,style:n}=e;return t&&!yt(t)&&(e.class=et(t)),n&&(e.style=st(n)),e}const Dh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Fh=xl(Dh);function _d(e){return!!e||e===""}function Uh(e,t){if(e.length!==t.length)return!1;let n=!0;for(let a=0;n&&a<e.length;a++)n=Lo(e[a],t[a]);return n}function Lo(e,t){if(e===t)return!0;let n=Gu(e),a=Gu(t);if(n||a)return n&&a?e.getTime()===t.getTime():!1;if(n=_o(e),a=_o(t),n||a)return e===t;if(n=Be(e),a=Be(t),n||a)return n&&a?Uh(e,t):!1;if(n=nt(e),a=nt(t),n||a){if(!n||!a)return!1;const o=Object.keys(e).length,r=Object.keys(t).length;if(o!==r)return!1;for(const s in e){const l=e.hasOwnProperty(s),u=t.hasOwnProperty(s);if(l&&!u||!l&&u||!Lo(e[s],t[s]))return!1}}return String(e)===String(t)}function wl(e,t){return e.findIndex(n=>Lo(n,t))}const Ve=e=>yt(e)?e:e==null?"":Be(e)||nt(e)&&(e.toString===kd||!He(e.toString))?JSON.stringify(e,Sd,2):String(e),Sd=(e,t)=>t&&t.__v_isRef?Sd(e,t.value):Ia(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[a,o])=>(n[`${a} =>`]=o,n),{})}:Ya(t)?{[`Set(${t.size})`]:[...t.values()]}:nt(t)&&!Be(t)&&!Ed(t)?String(t):t,Ze={},Aa=[],Dn=()=>{},Gh=()=>!1,Kh=/^on[^a-z]/,Ur=e=>Kh.test(e),kl=e=>e.startsWith("onUpdate:"),Rt=Object.assign,xd=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},zh=Object.prototype.hasOwnProperty,Ue=(e,t)=>zh.call(e,t),Be=Array.isArray,Ia=e=>Ro(e)==="[object Map]",Ya=e=>Ro(e)==="[object Set]",Gu=e=>Ro(e)==="[object Date]",He=e=>typeof e=="function",yt=e=>typeof e=="string",_o=e=>typeof e=="symbol",nt=e=>e!==null&&typeof e=="object",wd=e=>nt(e)&&He(e.then)&&He(e.catch),kd=Object.prototype.toString,Ro=e=>kd.call(e),Yh=e=>Ro(e).slice(8,-1),Ed=e=>Ro(e)==="[object Object]",El=e=>yt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ir=xl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gr=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Xh=/-(\w)/g,Sn=Gr(e=>e.replace(Xh,(t,n)=>n?n.toUpperCase():"")),Hh=/\B([A-Z])/g,Xa=Gr(e=>e.replace(Hh,"-$1").toLowerCase()),Kr=Gr(e=>e.charAt(0).toUpperCase()+e.slice(1)),_s=Gr(e=>e?`on${Kr(e)}`:""),So=(e,t)=>!Object.is(e,t),cr=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},vr=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},ja=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ku;const Wh=()=>Ku||(Ku=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let pn;class Jh{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=pn,!t&&pn&&(this.index=(pn.scopes||(pn.scopes=[])).push(this)-1)}run(t){if(this.active){const n=pn;try{return pn=this,t()}finally{pn=n}}}on(){pn=this}off(){pn=this.parent}stop(t){if(this.active){let n,a;for(n=0,a=this.effects.length;n<a;n++)this.effects[n].stop();for(n=0,a=this.cleanups.length;n<a;n++)this.cleanups[n]();if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this.active=!1}}}function qh(e,t=pn){t&&t.active&&t.effects.push(e)}const Cl=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Cd=e=>(e.w&Xn)>0,Md=e=>(e.n&Xn)>0,Zh=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Xn},Qh=e=>{const{deps:t}=e;if(t.length){let n=0;for(let a=0;a<t.length;a++){const o=t[a];Cd(o)&&!Md(o)?o.delete(e):t[n++]=o,o.w&=~Xn,o.n&=~Xn}t.length=n}},Gs=new WeakMap;let io=0,Xn=1;const Ks=30;let Qt;const pa=Symbol(""),zs=Symbol("");class Ml{constructor(t,n=null,a){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,qh(this,a)}run(){if(!this.active)return this.fn();let t=Qt,n=Fn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Qt,Qt=this,Fn=!0,Xn=1<<++io,io<=Ks?Zh(this):zu(this),this.fn()}finally{io<=Ks&&Qh(this),Xn=1<<--io,Qt=this.parent,Fn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Qt===this?this.deferStop=!0:this.active&&(zu(this),this.onStop&&this.onStop(),this.active=!1)}}function zu(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Fn=!0;const Od=[];function jo(){Od.push(Fn),Fn=!1}function No(){const e=Od.pop();Fn=e===void 0?!0:e}function Ht(e,t,n){if(Fn&&Qt){let a=Gs.get(e);a||Gs.set(e,a=new Map);let o=a.get(n);o||a.set(n,o=Cl()),Td(o)}}function Td(e,t){let n=!1;io<=Ks?Md(e)||(e.n|=Xn,n=!Cd(e)):n=!e.has(Qt),n&&(e.add(Qt),Qt.deps.push(e))}function Tn(e,t,n,a,o,r){const s=Gs.get(e);if(!s)return;let l=[];if(t==="clear")l=[...s.values()];else if(n==="length"&&Be(e)){const u=ja(a);s.forEach((i,c)=>{(c==="length"||c>=u)&&l.push(i)})}else switch(n!==void 0&&l.push(s.get(n)),t){case"add":Be(e)?El(n)&&l.push(s.get("length")):(l.push(s.get(pa)),Ia(e)&&l.push(s.get(zs)));break;case"delete":Be(e)||(l.push(s.get(pa)),Ia(e)&&l.push(s.get(zs)));break;case"set":Ia(e)&&l.push(s.get(pa));break}if(l.length===1)l[0]&&Ys(l[0]);else{const u=[];for(const i of l)i&&u.push(...i);Ys(Cl(u))}}function Ys(e,t){const n=Be(e)?e:[...e];for(const a of n)a.computed&&Yu(a);for(const a of n)a.computed||Yu(a)}function Yu(e,t){(e!==Qt||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const ey=xl("__proto__,__v_isRef,__isVue"),$d=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(_o)),ty=Ol(),ny=Ol(!1,!0),ay=Ol(!0),Xu=oy();function oy(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const a=ze(this);for(let r=0,s=this.length;r<s;r++)Ht(a,"get",r+"");const o=a[t](...n);return o===-1||o===!1?a[t](...n.map(ze)):o}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){jo();const a=ze(this)[t].apply(this,n);return No(),a}}),e}function Ol(e=!1,t=!1){return function(a,o,r){if(o==="__v_isReactive")return!e;if(o==="__v_isReadonly")return e;if(o==="__v_isShallow")return t;if(o==="__v_raw"&&r===(e?t?_y:Ld:t?Bd:Pd).get(a))return a;const s=Be(a);if(!e&&s&&Ue(Xu,o))return Reflect.get(Xu,o,r);const l=Reflect.get(a,o,r);return(_o(o)?$d.has(o):ey(o))||(e||Ht(a,"get",o),t)?l:Fe(l)?s&&El(o)?l:l.value:nt(l)?e?Rd(l):ha(l):l}}const ry=Ad(),sy=Ad(!0);function Ad(e=!1){return function(n,a,o,r){let s=n[a];if(Na(s)&&Fe(s)&&!Fe(o))return!1;if(!e&&(!gr(o)&&!Na(o)&&(s=ze(s),o=ze(o)),!Be(n)&&Fe(s)&&!Fe(o)))return s.value=o,!0;const l=Be(n)&&El(a)?Number(a)<n.length:Ue(n,a),u=Reflect.set(n,a,o,r);return n===ze(r)&&(l?So(o,s)&&Tn(n,"set",a,o):Tn(n,"add",a,o)),u}}function ly(e,t){const n=Ue(e,t);e[t];const a=Reflect.deleteProperty(e,t);return a&&n&&Tn(e,"delete",t,void 0),a}function uy(e,t){const n=Reflect.has(e,t);return(!_o(t)||!$d.has(t))&&Ht(e,"has",t),n}function iy(e){return Ht(e,"iterate",Be(e)?"length":pa),Reflect.ownKeys(e)}const Id={get:ty,set:ry,deleteProperty:ly,has:uy,ownKeys:iy},cy={get:ay,set(e,t){return!0},deleteProperty(e,t){return!0}},dy=Rt({},Id,{get:ny,set:sy}),Tl=e=>e,zr=e=>Reflect.getPrototypeOf(e);function Xo(e,t,n=!1,a=!1){e=e.__v_raw;const o=ze(e),r=ze(t);n||(t!==r&&Ht(o,"get",t),Ht(o,"get",r));const{has:s}=zr(o),l=a?Tl:n?Il:xo;if(s.call(o,t))return l(e.get(t));if(s.call(o,r))return l(e.get(r));e!==o&&e.get(t)}function Ho(e,t=!1){const n=this.__v_raw,a=ze(n),o=ze(e);return t||(e!==o&&Ht(a,"has",e),Ht(a,"has",o)),e===o?n.has(e):n.has(e)||n.has(o)}function Wo(e,t=!1){return e=e.__v_raw,!t&&Ht(ze(e),"iterate",pa),Reflect.get(e,"size",e)}function Hu(e){e=ze(e);const t=ze(this);return zr(t).has.call(t,e)||(t.add(e),Tn(t,"add",e,e)),this}function Wu(e,t){t=ze(t);const n=ze(this),{has:a,get:o}=zr(n);let r=a.call(n,e);r||(e=ze(e),r=a.call(n,e));const s=o.call(n,e);return n.set(e,t),r?So(t,s)&&Tn(n,"set",e,t):Tn(n,"add",e,t),this}function Ju(e){const t=ze(this),{has:n,get:a}=zr(t);let o=n.call(t,e);o||(e=ze(e),o=n.call(t,e)),a&&a.call(t,e);const r=t.delete(e);return o&&Tn(t,"delete",e,void 0),r}function qu(){const e=ze(this),t=e.size!==0,n=e.clear();return t&&Tn(e,"clear",void 0,void 0),n}function Jo(e,t){return function(a,o){const r=this,s=r.__v_raw,l=ze(s),u=t?Tl:e?Il:xo;return!e&&Ht(l,"iterate",pa),s.forEach((i,c)=>a.call(o,u(i),u(c),r))}}function qo(e,t,n){return function(...a){const o=this.__v_raw,r=ze(o),s=Ia(r),l=e==="entries"||e===Symbol.iterator&&s,u=e==="keys"&&s,i=o[e](...a),c=n?Tl:t?Il:xo;return!t&&Ht(r,"iterate",u?zs:pa),{next(){const{value:p,done:d}=i.next();return d?{value:p,done:d}:{value:l?[c(p[0]),c(p[1])]:c(p),done:d}},[Symbol.iterator](){return this}}}}function Pn(e){return function(...t){return e==="delete"?!1:this}}function fy(){const e={get(r){return Xo(this,r)},get size(){return Wo(this)},has:Ho,add:Hu,set:Wu,delete:Ju,clear:qu,forEach:Jo(!1,!1)},t={get(r){return Xo(this,r,!1,!0)},get size(){return Wo(this)},has:Ho,add:Hu,set:Wu,delete:Ju,clear:qu,forEach:Jo(!1,!0)},n={get(r){return Xo(this,r,!0)},get size(){return Wo(this,!0)},has(r){return Ho.call(this,r,!0)},add:Pn("add"),set:Pn("set"),delete:Pn("delete"),clear:Pn("clear"),forEach:Jo(!0,!1)},a={get(r){return Xo(this,r,!0,!0)},get size(){return Wo(this,!0)},has(r){return Ho.call(this,r,!0)},add:Pn("add"),set:Pn("set"),delete:Pn("delete"),clear:Pn("clear"),forEach:Jo(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=qo(r,!1,!1),n[r]=qo(r,!0,!1),t[r]=qo(r,!1,!0),a[r]=qo(r,!0,!0)}),[e,n,t,a]}const[py,my,hy,yy]=fy();function $l(e,t){const n=t?e?yy:hy:e?my:py;return(a,o,r)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?a:Reflect.get(Ue(n,o)&&o in a?n:a,o,r)}const vy={get:$l(!1,!1)},gy={get:$l(!1,!0)},by={get:$l(!0,!1)},Pd=new WeakMap,Bd=new WeakMap,Ld=new WeakMap,_y=new WeakMap;function Sy(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xy(e){return e.__v_skip||!Object.isExtensible(e)?0:Sy(Yh(e))}function ha(e){return Na(e)?e:Al(e,!1,Id,vy,Pd)}function wy(e){return Al(e,!1,dy,gy,Bd)}function Rd(e){return Al(e,!0,cy,by,Ld)}function Al(e,t,n,a,o){if(!nt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=o.get(e);if(r)return r;const s=xy(e);if(s===0)return e;const l=new Proxy(e,s===2?a:n);return o.set(e,l),l}function Pa(e){return Na(e)?Pa(e.__v_raw):!!(e&&e.__v_isReactive)}function Na(e){return!!(e&&e.__v_isReadonly)}function gr(e){return!!(e&&e.__v_isShallow)}function jd(e){return Pa(e)||Na(e)}function ze(e){const t=e&&e.__v_raw;return t?ze(t):e}function Nd(e){return vr(e,"__v_skip",!0),e}const xo=e=>nt(e)?ha(e):e,Il=e=>nt(e)?Rd(e):e;function Vd(e){Fn&&Qt&&(e=ze(e),Td(e.dep||(e.dep=Cl())))}function Dd(e,t){e=ze(e),e.dep&&Ys(e.dep)}function Fe(e){return!!(e&&e.__v_isRef===!0)}function H(e){return ky(e,!1)}function ky(e,t){return Fe(e)?e:new Ey(e,t)}class Ey{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:ze(t),this._value=n?t:xo(t)}get value(){return Vd(this),this._value}set value(t){const n=this.__v_isShallow||gr(t)||Na(t);t=n?t:ze(t),So(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:xo(t),Dd(this))}}function m(e){return Fe(e)?e.value:e}const Cy={get:(e,t,n)=>m(Reflect.get(e,t,n)),set:(e,t,n,a)=>{const o=e[t];return Fe(o)&&!Fe(n)?(o.value=n,!0):Reflect.set(e,t,n,a)}};function Fd(e){return Pa(e)?e:new Proxy(e,Cy)}var Ud;class My{constructor(t,n,a,o){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[Ud]=!1,this._dirty=!0,this.effect=new Ml(t,()=>{this._dirty||(this._dirty=!0,Dd(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=a}get value(){const t=ze(this);return Vd(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Ud="__v_isReadonly";function Oy(e,t,n=!1){let a,o;const r=He(e);return r?(a=e,o=Dn):(a=e.get,o=e.set),new My(a,o,r||!o,n)}function Un(e,t,n,a){let o;try{o=a?e(...a):e()}catch(r){Yr(r,t,n)}return o}function on(e,t,n,a){if(He(e)){const r=Un(e,t,n,a);return r&&wd(r)&&r.catch(s=>{Yr(s,t,n)}),r}const o=[];for(let r=0;r<e.length;r++)o.push(on(e[r],t,n,a));return o}function Yr(e,t,n,a=!0){const o=t?t.vnode:null;if(t){let r=t.parent;const s=t.proxy,l=n;for(;r;){const i=r.ec;if(i){for(let c=0;c<i.length;c++)if(i[c](e,s,l)===!1)return}r=r.parent}const u=t.appContext.config.errorHandler;if(u){Un(u,null,10,[e,s,l]);return}}Ty(e,n,o,a)}function Ty(e,t,n,a=!0){console.error(e)}let wo=!1,Xs=!1;const At=[];let hn=0;const Ba=[];let Cn=null,ua=0;const Gd=Promise.resolve();let Pl=null;function Ha(e){const t=Pl||Gd;return e?t.then(this?e.bind(this):e):t}function $y(e){let t=hn+1,n=At.length;for(;t<n;){const a=t+n>>>1;ko(At[a])<e?t=a+1:n=a}return t}function Bl(e){(!At.length||!At.includes(e,wo&&e.allowRecurse?hn+1:hn))&&(e.id==null?At.push(e):At.splice($y(e.id),0,e),Kd())}function Kd(){!wo&&!Xs&&(Xs=!0,Pl=Gd.then(Yd))}function Ay(e){const t=At.indexOf(e);t>hn&&At.splice(t,1)}function Iy(e){Be(e)?Ba.push(...e):(!Cn||!Cn.includes(e,e.allowRecurse?ua+1:ua))&&Ba.push(e),Kd()}function Zu(e,t=wo?hn+1:0){for(;t<At.length;t++){const n=At[t];n&&n.pre&&(At.splice(t,1),t--,n())}}function zd(e){if(Ba.length){const t=[...new Set(Ba)];if(Ba.length=0,Cn){Cn.push(...t);return}for(Cn=t,Cn.sort((n,a)=>ko(n)-ko(a)),ua=0;ua<Cn.length;ua++)Cn[ua]();Cn=null,ua=0}}const ko=e=>e.id==null?1/0:e.id,Py=(e,t)=>{const n=ko(e)-ko(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Yd(e){Xs=!1,wo=!0,At.sort(Py);const t=Dn;try{for(hn=0;hn<At.length;hn++){const n=At[hn];n&&n.active!==!1&&Un(n,null,14)}}finally{hn=0,At.length=0,zd(),wo=!1,Pl=null,(At.length||Ba.length)&&Yd()}}function By(e,t,...n){if(e.isUnmounted)return;const a=e.vnode.props||Ze;let o=n;const r=t.startsWith("update:"),s=r&&t.slice(7);if(s&&s in a){const c=`${s==="modelValue"?"model":s}Modifiers`,{number:p,trim:d}=a[c]||Ze;d&&(o=n.map(f=>yt(f)?f.trim():f)),p&&(o=n.map(ja))}let l,u=a[l=_s(t)]||a[l=_s(Sn(t))];!u&&r&&(u=a[l=_s(Xa(t))]),u&&on(u,e,6,o);const i=a[l+"Once"];if(i){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,on(i,e,6,o)}}function Ly(e,t,n=!1){const a=t.emitsCache,o=a.get(e);if(o!==void 0)return o;const r=e.emits;let s={};return!r&&!!1?(nt(e)&&a.set(e,null),null):(Be(r)?r.forEach(u=>s[u]=null):Rt(s,r),nt(e)&&a.set(e,s),s)}function Xr(e,t){return!e||!Ur(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ue(e,t[0].toLowerCase()+t.slice(1))||Ue(e,Xa(t))||Ue(e,t))}let Et=null,Hr=null;function br(e){const t=Et;return Et=e,Hr=e&&e.type.__scopeId||null,t}function it(e){Hr=e}function ct(){Hr=null}function F(e,t=Et,n){if(!t||e._n)return e;const a=(...o)=>{a._d&&ii(-1);const r=br(t);let s;try{s=e(...o)}finally{br(r),a._d&&ii(1)}return s};return a._n=!0,a._c=!0,a._d=!0,a}function Ss(e){const{type:t,vnode:n,proxy:a,withProxy:o,props:r,propsOptions:[s],slots:l,attrs:u,emit:i,render:c,renderCache:p,data:d,setupState:f,ctx:h,inheritAttrs:y}=e;let k,E;const g=br(e);try{if(n.shapeFlag&4){const A=o||a;k=mn(c.call(A,A,p,r,f,d,h)),E=u}else{const A=t;k=mn(A.length>1?A(r,{attrs:u,slots:l,emit:i}):A(r,null)),E=t.props?u:Ry(u)}}catch(A){mo.length=0,Yr(A,e,1),k=w(Zt)}let v=k;if(E&&y!==!1){const A=Object.keys(E),{shapeFlag:x}=v;A.length&&x&7&&(s&&A.some(kl)&&(E=jy(E,s)),v=Hn(v,E))}return n.dirs&&(v=Hn(v),v.dirs=v.dirs?v.dirs.concat(n.dirs):n.dirs),n.transition&&(v.transition=n.transition),k=v,br(g),k}const Ry=e=>{let t;for(const n in e)(n==="class"||n==="style"||Ur(n))&&((t||(t={}))[n]=e[n]);return t},jy=(e,t)=>{const n={};for(const a in e)(!kl(a)||!(a.slice(9)in t))&&(n[a]=e[a]);return n};function Ny(e,t,n){const{props:a,children:o,component:r}=e,{props:s,children:l,patchFlag:u}=t,i=r.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return a?Qu(a,s,i):!!s;if(u&8){const c=t.dynamicProps;for(let p=0;p<c.length;p++){const d=c[p];if(s[d]!==a[d]&&!Xr(i,d))return!0}}}else return(o||l)&&(!l||!l.$stable)?!0:a===s?!1:a?s?Qu(a,s,i):!0:!!s;return!1}function Qu(e,t,n){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let o=0;o<a.length;o++){const r=a[o];if(t[r]!==e[r]&&!Xr(n,r))return!0}return!1}function Vy({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const Dy=e=>e.__isSuspense;function Fy(e,t){t&&t.pendingBranch?Be(e)?t.effects.push(...e):t.effects.push(e):Iy(e)}function Wa(e,t){if(Lt){let n=Lt.provides;const a=Lt.parent&&Lt.parent.provides;a===n&&(n=Lt.provides=Object.create(a)),n[e]=t}}function ba(e,t,n=!1){const a=Lt||Et;if(a){const o=a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides;if(o&&e in o)return o[e];if(arguments.length>1)return n&&He(t)?t.call(a.proxy):t}}function rn(e,t){return Xd(e,null,t)}const Zo={};function pt(e,t,n){return Xd(e,t,n)}function Xd(e,t,{immediate:n,deep:a,flush:o,onTrack:r,onTrigger:s}=Ze){const l=Lt;let u,i=!1,c=!1;if(Fe(e)?(u=()=>e.value,i=gr(e)):Pa(e)?(u=()=>e,a=!0):Be(e)?(c=!0,i=e.some(v=>Pa(v)||gr(v)),u=()=>e.map(v=>{if(Fe(v))return v.value;if(Pa(v))return da(v);if(He(v))return Un(v,l,2)})):He(e)?t?u=()=>Un(e,l,2):u=()=>{if(!(l&&l.isUnmounted))return p&&p(),on(e,l,3,[d])}:u=Dn,t&&a){const v=u;u=()=>da(v())}let p,d=v=>{p=E.onStop=()=>{Un(v,l,4)}},f;if(Co)if(d=Dn,t?n&&on(t,l,3,[u(),c?[]:void 0,d]):u(),o==="sync"){const v=Mv();f=v.__watcherHandles||(v.__watcherHandles=[])}else return Dn;let h=c?new Array(e.length).fill(Zo):Zo;const y=()=>{if(E.active)if(t){const v=E.run();(a||i||(c?v.some((A,x)=>So(A,h[x])):So(v,h)))&&(p&&p(),on(t,l,3,[v,h===Zo?void 0:c&&h[0]===Zo?[]:h,d]),h=v)}else E.run()};y.allowRecurse=!!t;let k;o==="sync"?k=y:o==="post"?k=()=>Dt(y,l&&l.suspense):(y.pre=!0,l&&(y.id=l.uid),k=()=>Bl(y));const E=new Ml(u,k);t?n?y():h=E.run():o==="post"?Dt(E.run.bind(E),l&&l.suspense):E.run();const g=()=>{E.stop(),l&&l.scope&&xd(l.scope.effects,E)};return f&&f.push(g),g}function da(e,t){if(!nt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Fe(e))da(e.value,t);else if(Be(e))for(let n=0;n<e.length;n++)da(e[n],t);else if(Ya(e)||Ia(e))e.forEach(n=>{da(n,t)});else if(Ed(e))for(const n in e)da(e[n],t);return e}function Uy(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ut(()=>{e.isMounted=!0}),Yy(()=>{e.isUnmounting=!0}),e}const Wt=[Function,Array],Gy={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Wt,onEnter:Wt,onAfterEnter:Wt,onEnterCancelled:Wt,onBeforeLeave:Wt,onLeave:Wt,onAfterLeave:Wt,onLeaveCancelled:Wt,onBeforeAppear:Wt,onAppear:Wt,onAfterAppear:Wt,onAppearCancelled:Wt},setup(e,{slots:t}){const n=gv(),a=Uy();let o;return()=>{const r=t.default&&Jd(t.default(),!0);if(!r||!r.length)return;let s=r[0];if(r.length>1){for(const y of r)if(y.type!==Zt){s=y;break}}const l=ze(e),{mode:u}=l;if(a.isLeaving)return xs(s);const i=ei(s);if(!i)return xs(s);const c=Hs(i,l,a,n);Ws(i,c);const p=n.subTree,d=p&&ei(p);let f=!1;const{getTransitionKey:h}=i.type;if(h){const y=h();o===void 0?o=y:y!==o&&(o=y,f=!0)}if(d&&d.type!==Zt&&(!ia(i,d)||f)){const y=Hs(d,l,a,n);if(Ws(d,y),u==="out-in")return a.isLeaving=!0,y.afterLeave=()=>{a.isLeaving=!1,n.update.active!==!1&&n.update()},xs(s);u==="in-out"&&i.type!==Zt&&(y.delayLeave=(k,E,g)=>{const v=Wd(a,d);v[String(d.key)]=d,k._leaveCb=()=>{E(),k._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=g})}return s}}},Hd=Gy;function Wd(e,t){const{leavingVNodes:n}=e;let a=n.get(t.type);return a||(a=Object.create(null),n.set(t.type,a)),a}function Hs(e,t,n,a){const{appear:o,mode:r,persisted:s=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:i,onEnterCancelled:c,onBeforeLeave:p,onLeave:d,onAfterLeave:f,onLeaveCancelled:h,onBeforeAppear:y,onAppear:k,onAfterAppear:E,onAppearCancelled:g}=t,v=String(e.key),A=Wd(n,e),x=(T,L)=>{T&&on(T,a,9,L)},I=(T,L)=>{const R=L[1];x(T,L),Be(T)?T.every(B=>B.length<=1)&&R():T.length<=1&&R()},O={mode:r,persisted:s,beforeEnter(T){let L=l;if(!n.isMounted)if(o)L=y||l;else return;T._leaveCb&&T._leaveCb(!0);const R=A[v];R&&ia(e,R)&&R.el._leaveCb&&R.el._leaveCb(),x(L,[T])},enter(T){let L=u,R=i,B=c;if(!n.isMounted)if(o)L=k||u,R=E||i,B=g||c;else return;let N=!1;const j=T._enterCb=K=>{N||(N=!0,K?x(B,[T]):x(R,[T]),O.delayedLeave&&O.delayedLeave(),T._enterCb=void 0)};L?I(L,[T,j]):j()},leave(T,L){const R=String(e.key);if(T._enterCb&&T._enterCb(!0),n.isUnmounting)return L();x(p,[T]);let B=!1;const N=T._leaveCb=j=>{B||(B=!0,L(),j?x(h,[T]):x(f,[T]),T._leaveCb=void 0,A[R]===e&&delete A[R])};A[R]=e,d?I(d,[T,N]):N()},clone(T){return Hs(T,t,n,a)}};return O}function xs(e){if(Ll(e))return e=Hn(e),e.children=null,e}function ei(e){return Ll(e)?e.children?e.children[0]:void 0:e}function Ws(e,t){e.shapeFlag&6&&e.component?Ws(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Jd(e,t=!1,n){let a=[],o=0;for(let r=0;r<e.length;r++){let s=e[r];const l=n==null?s.key:String(n)+String(s.key!=null?s.key:r);s.type===ye?(s.patchFlag&128&&o++,a=a.concat(Jd(s.children,t,l))):(t||s.type!==Zt)&&a.push(l!=null?Hn(s,{key:l}):s)}if(o>1)for(let r=0;r<a.length;r++)a[r].patchFlag=-2;return a}function J(e){return He(e)?{setup:e,name:e.name}:e}const co=e=>!!e.type.__asyncLoader,Ll=e=>e.type.__isKeepAlive;function Ky(e,t,n=Lt,a=!1){if(n){const o=n[e]||(n[e]=[]),r=t.__weh||(t.__weh=(...s)=>{if(n.isUnmounted)return;jo(),Gl(n);const l=on(t,n,e,s);return ho(),No(),l});return a?o.unshift(r):o.push(r),r}}const Wr=e=>(t,n=Lt)=>(!Co||e==="sp")&&Ky(e,(...a)=>t(...a),n),Ut=Wr("m"),zy=Wr("bu"),Yy=Wr("bum"),_a=Wr("um");function Qn(e,t){const n=Et;if(n===null)return e;const a=Zr(n)||n.proxy,o=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[s,l,u,i=Ze]=t[r];s&&(He(s)&&(s={mounted:s,updated:s}),s.deep&&da(l),o.push({dir:s,instance:a,value:l,oldValue:void 0,arg:u,modifiers:i}))}return e}function na(e,t,n,a){const o=e.dirs,r=t&&t.dirs;for(let s=0;s<o.length;s++){const l=o[s];r&&(l.oldValue=r[s].value);let u=l.dir[a];u&&(jo(),on(u,n,8,[e.el,l,e,t]),No())}}const Rl="components";function jl(e,t){return Zd(Rl,e,!0,t)||e}const qd=Symbol();function Nl(e){return yt(e)?Zd(Rl,e,!1)||e:e||qd}function Zd(e,t,n=!0,a=!1){const o=Et||Lt;if(o){const r=o.type;if(e===Rl){const l=wv(r,!1);if(l&&(l===t||l===Sn(t)||l===Kr(Sn(t))))return r}const s=ti(o[e]||r[e],t)||ti(o.appContext[e],t);return!s&&a?r:s}}function ti(e,t){return e&&(e[t]||e[Sn(t)]||e[Kr(Sn(t))])}function Pe(e,t,n,a){let o;const r=n&&n[a];if(Be(e)||yt(e)){o=new Array(e.length);for(let s=0,l=e.length;s<l;s++)o[s]=t(e[s],s,void 0,r&&r[s])}else if(typeof e=="number"){o=new Array(e);for(let s=0;s<e;s++)o[s]=t(s+1,s,void 0,r&&r[s])}else if(nt(e))if(e[Symbol.iterator])o=Array.from(e,(s,l)=>t(s,l,void 0,r&&r[l]));else{const s=Object.keys(e);o=new Array(s.length);for(let l=0,u=s.length;l<u;l++){const i=s[l];o[l]=t(e[i],i,l,r&&r[l])}}else o=[];return n&&(n[a]=o),o}function at(e,t,n={},a,o){if(Et.isCE||Et.parent&&co(Et.parent)&&Et.parent.isCE)return t!=="default"&&(n.name=t),w("slot",n,a&&a());let r=e[t];r&&r._c&&(r._d=!1),_();const s=r&&Qd(r(n)),l=Se(ye,{key:n.key||s&&s.key||`_${t}`},s||(a?a():[]),s&&e._===1?64:-2);return!o&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),r&&r._c&&(r._d=!0),l}function Qd(e){return e.some(t=>Sr(t)?!(t.type===Zt||t.type===ye&&!Qd(t.children)):!0)?e:null}const Js=e=>e?cf(e)?Zr(e)||e.proxy:Js(e.parent):null,fo=Rt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Js(e.parent),$root:e=>Js(e.root),$emit:e=>e.emit,$options:e=>e.type,$forceUpdate:e=>e.f||(e.f=()=>Bl(e.update)),$nextTick:e=>e.n||(e.n=Ha.bind(e.proxy)),$watch:e=>Dn}),ws=(e,t)=>e!==Ze&&!e.__isScriptSetup&&Ue(e,t),Xy={get({_:e},t){const{ctx:n,setupState:a,data:o,props:r,accessCache:s,type:l,appContext:u}=e;let i;if(t[0]!=="$"){const f=s[t];if(f!==void 0)switch(f){case 1:return a[t];case 2:return o[t];case 4:return n[t];case 3:return r[t]}else{if(ws(a,t))return s[t]=1,a[t];if(o!==Ze&&Ue(o,t))return s[t]=2,o[t];if((i=e.propsOptions[0])&&Ue(i,t))return s[t]=3,r[t];if(n!==Ze&&Ue(n,t))return s[t]=4,n[t];s[t]=0}}const c=fo[t];let p,d;if(c)return t==="$attrs"&&Ht(e,"get",t),c(e);if((p=l.__cssModules)&&(p=p[t]))return p;if(n!==Ze&&Ue(n,t))return s[t]=4,n[t];if(d=u.config.globalProperties,Ue(d,t))return d[t]},set({_:e},t,n){const{data:a,setupState:o,ctx:r}=e;return ws(o,t)?(o[t]=n,!0):a!==Ze&&Ue(a,t)?(a[t]=n,!0):Ue(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:a,appContext:o,propsOptions:r}},s){let l;return!!n[s]||e!==Ze&&Ue(e,s)||ws(t,s)||(l=r[0])&&Ue(l,s)||Ue(a,s)||Ue(fo,s)||Ue(o.config.globalProperties,s)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Ue(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Hy(e){const t=e.type,{mixins:n,extends:a}=t,{mixins:o,optionsCache:r,config:{optionMergeStrategies:s}}=e.appContext,l=r.get(t);let u;return l?u=l:!o.length&&!n&&!a?u=t:(u={},o.length&&o.forEach(i=>_r(u,i,s,!0)),_r(u,t,s)),nt(t)&&r.set(t,u),u}function _r(e,t,n,a=!1){const{mixins:o,extends:r}=t;r&&_r(e,r,n,!0),o&&o.forEach(s=>_r(e,s,n,!0));for(const s in t)if(!(a&&s==="expose")){const l=Wy[s]||n&&n[s];e[s]=l?l(e[s],t[s]):t[s]}return e}const Wy={data:ni,props:sa,emits:sa,methods:sa,computed:sa,beforeCreate:Bt,created:Bt,beforeMount:Bt,mounted:Bt,beforeUpdate:Bt,updated:Bt,beforeDestroy:Bt,beforeUnmount:Bt,destroyed:Bt,unmounted:Bt,activated:Bt,deactivated:Bt,errorCaptured:Bt,serverPrefetch:Bt,components:sa,directives:sa,watch:qy,provide:ni,inject:Jy};function ni(e,t){return t?e?function(){return Rt(He(e)?e.call(this,this):e,He(t)?t.call(this,this):t)}:t:e}function Jy(e,t){return sa(ai(e),ai(t))}function ai(e){if(Be(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Bt(e,t){return e?[...new Set([].concat(e,t))]:t}function sa(e,t){return e?Rt(Rt(Object.create(null),e),t):t}function qy(e,t){if(!e)return t;if(!t)return e;const n=Rt(Object.create(null),e);for(const a in t)n[a]=Bt(e[a],t[a]);return n}function Zy(e,t,n,a=!1){const o={},r={};vr(r,qr,1),e.propsDefaults=Object.create(null),ef(e,t,o,r);for(const s in e.propsOptions[0])s in o||(o[s]=void 0);n?e.props=a?o:wy(o):e.type.props?e.props=o:e.props=r,e.attrs=r}function Qy(e,t,n,a){const{props:o,attrs:r,vnode:{patchFlag:s}}=e,l=ze(o),[u]=e.propsOptions;let i=!1;if((a||s>0)&&!(s&16)){if(s&8){const c=e.vnode.dynamicProps;for(let p=0;p<c.length;p++){let d=c[p];if(Xr(e.emitsOptions,d))continue;const f=t[d];if(u)if(Ue(r,d))f!==r[d]&&(r[d]=f,i=!0);else{const h=Sn(d);o[h]=qs(u,l,h,f,e,!1)}else f!==r[d]&&(r[d]=f,i=!0)}}}else{ef(e,t,o,r)&&(i=!0);let c;for(const p in l)(!t||!Ue(t,p)&&((c=Xa(p))===p||!Ue(t,c)))&&(u?n&&(n[p]!==void 0||n[c]!==void 0)&&(o[p]=qs(u,l,p,void 0,e,!0)):delete o[p]);if(r!==l)for(const p in r)(!t||!Ue(t,p))&&(delete r[p],i=!0)}i&&Tn(e,"set","$attrs")}function ef(e,t,n,a){const[o,r]=e.propsOptions;let s=!1,l;if(t)for(let u in t){if(ir(u))continue;const i=t[u];let c;o&&Ue(o,c=Sn(u))?!r||!r.includes(c)?n[c]=i:(l||(l={}))[c]=i:Xr(e.emitsOptions,u)||(!(u in a)||i!==a[u])&&(a[u]=i,s=!0)}if(r){const u=ze(n),i=l||Ze;for(let c=0;c<r.length;c++){const p=r[c];n[p]=qs(o,u,p,i[p],e,!Ue(i,p))}}return s}function qs(e,t,n,a,o,r){const s=e[n];if(s!=null){const l=Ue(s,"default");if(l&&a===void 0){const u=s.default;if(s.type!==Function&&He(u)){const{propsDefaults:i}=o;n in i?a=i[n]:(Gl(o),a=i[n]=u.call(null,t),ho())}else a=u}s[0]&&(r&&!l?a=!1:s[1]&&(a===""||a===Xa(n))&&(a=!0))}return a}function ev(e,t,n=!1){const a=t.propsCache,o=a.get(e);if(o)return o;const r=e.props,s={},l=[];if(!r&&!!1)return nt(e)&&a.set(e,Aa),Aa;if(Be(r))for(let c=0;c<r.length;c++){const p=Sn(r[c]);oi(p)&&(s[p]=Ze)}else if(r)for(const c in r){const p=Sn(c);if(oi(p)){const d=r[c],f=s[p]=Be(d)||He(d)?{type:d}:Object.assign({},d);if(f){const h=li(Boolean,f.type),y=li(String,f.type);f[0]=h>-1,f[1]=y<0||h<y,(h>-1||Ue(f,"default"))&&l.push(p)}}}const i=[s,l];return nt(e)&&a.set(e,i),i}function oi(e){return e[0]!=="$"}function ri(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function si(e,t){return ri(e)===ri(t)}function li(e,t){return Be(t)?t.findIndex(n=>si(n,e)):He(t)&&si(t,e)?0:-1}const tf=e=>e[0]==="_"||e==="$stable",Vl=e=>Be(e)?e.map(mn):[mn(e)],tv=(e,t,n)=>{if(t._n)return t;const a=F((...o)=>Vl(t(...o)),n);return a._c=!1,a},nf=(e,t,n)=>{const a=e._ctx;for(const o in e){if(tf(o))continue;const r=e[o];if(He(r))t[o]=tv(o,r,a);else if(r!=null){const s=Vl(r);t[o]=()=>s}}},af=(e,t)=>{const n=Vl(t);e.slots.default=()=>n},nv=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=ze(t),vr(t,"_",n)):nf(t,e.slots={})}else e.slots={},t&&af(e,t);vr(e.slots,qr,1)},av=(e,t,n)=>{const{vnode:a,slots:o}=e;let r=!0,s=Ze;if(a.shapeFlag&32){const l=t._;l?n&&l===1?r=!1:(Rt(o,t),!n&&l===1&&delete o._):(r=!t.$stable,nf(t,o)),s=t}else t&&(af(e,t),s={default:1});if(r)for(const l in o)!tf(l)&&!(l in s)&&delete o[l]};function of(){return{app:null,config:{isNativeTag:Gh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ov=0;function rv(e,t){return function(a,o=null){He(a)||(a=Object.assign({},a)),o!=null&&!nt(o)&&(o=null);const r=of(),s=new Set;let l=!1;const u=r.app={_uid:ov++,_component:a,_props:o,_container:null,_context:r,_instance:null,version:Ov,get config(){return r.config},set config(i){},use(i,...c){return s.has(i)||(i&&He(i.install)?(s.add(i),i.install(u,...c)):He(i)&&(s.add(i),i(u,...c))),u},mixin(i){return u},component(i,c){return c?(r.components[i]=c,u):r.components[i]},directive(i,c){return c?(r.directives[i]=c,u):r.directives[i]},mount(i,c,p){if(!l){const d=w(a,o);return d.appContext=r,c&&t?t(d,i):e(d,i,p),l=!0,u._container=i,i.__vue_app__=u,Zr(d.component)||d.component.proxy}},unmount(){l&&(e(null,u._container),delete u._container.__vue_app__)},provide(i,c){return r.provides[i]=c,u}};return u}}function Zs(e,t,n,a,o=!1){if(Be(e)){e.forEach((d,f)=>Zs(d,t&&(Be(t)?t[f]:t),n,a,o));return}if(co(a)&&!o)return;const r=a.shapeFlag&4?Zr(a.component)||a.component.proxy:a.el,s=o?null:r,{i:l,r:u}=e,i=t&&t.r,c=l.refs===Ze?l.refs={}:l.refs,p=l.setupState;if(i!=null&&i!==u&&(yt(i)?(c[i]=null,Ue(p,i)&&(p[i]=null)):Fe(i)&&(i.value=null)),He(u))Un(u,l,12,[s,c]);else{const d=yt(u),f=Fe(u);if(d||f){const h=()=>{if(e.f){const y=d?Ue(p,u)?p[u]:c[u]:u.value;o?Be(y)&&xd(y,r):Be(y)?y.includes(r)||y.push(r):d?(c[u]=[r],Ue(p,u)&&(p[u]=c[u])):(u.value=[r],e.k&&(c[e.k]=u.value))}else d?(c[u]=s,Ue(p,u)&&(p[u]=s)):f&&(u.value=s,e.k&&(c[e.k]=s))};s?(h.id=-1,Dt(h,n)):h()}}}const Dt=Fy;function sv(e){return lv(e)}function lv(e,t){const n=Wh();n.__VUE__=!0;const{insert:a,remove:o,patchProp:r,createElement:s,createText:l,createComment:u,setText:i,setElementText:c,parentNode:p,nextSibling:d,setScopeId:f=Dn,insertStaticContent:h}=e,y=($,P,G,z=null,V=null,te=null,ge=!1,ae=null,re=!!P.dynamicChildren)=>{if($===P)return;$&&!ia($,P)&&(z=pe($),_e($,V,te,!0),$=null),P.patchFlag===-2&&(re=!1,P.dynamicChildren=null);const{type:Z,ref:Oe,shapeFlag:xe}=P;switch(Z){case Jr:k($,P,G,z);break;case Zt:E($,P,G,z);break;case ks:$==null&&g(P,G,z,ge);break;case ye:N($,P,G,z,V,te,ge,ae,re);break;default:xe&1?x($,P,G,z,V,te,ge,ae,re):xe&6?j($,P,G,z,V,te,ge,ae,re):(xe&64||xe&128)&&Z.process($,P,G,z,V,te,ge,ae,re,me)}Oe!=null&&V&&Zs(Oe,$&&$.ref,te,P||$,!P)},k=($,P,G,z)=>{if($==null)a(P.el=l(P.children),G,z);else{const V=P.el=$.el;P.children!==$.children&&i(V,P.children)}},E=($,P,G,z)=>{$==null?a(P.el=u(P.children||""),G,z):P.el=$.el},g=($,P,G,z)=>{[$.el,$.anchor]=h($.children,P,G,z,$.el,$.anchor)},v=({el:$,anchor:P},G,z)=>{let V;for(;$&&$!==P;)V=d($),a($,G,z),$=V;a(P,G,z)},A=({el:$,anchor:P})=>{let G;for(;$&&$!==P;)G=d($),o($),$=G;o(P)},x=($,P,G,z,V,te,ge,ae,re)=>{ge=ge||P.type==="svg",$==null?I(P,G,z,V,te,ge,ae,re):L($,P,V,te,ge,ae,re)},I=($,P,G,z,V,te,ge,ae)=>{let re,Z;const{type:Oe,props:xe,shapeFlag:Te,transition:U,dirs:q}=$;if(re=$.el=s($.type,te,xe&&xe.is,xe),Te&8?c(re,$.children):Te&16&&T($.children,re,null,z,V,te&&Oe!=="foreignObject",ge,ae),q&&na($,null,z,"created"),xe){for(const de in xe)de!=="value"&&!ir(de)&&r(re,de,null,xe[de],te,$.children,z,V,Y);"value"in xe&&r(re,"value",null,xe.value),(Z=xe.onVnodeBeforeMount)&&fn(Z,z,$)}O(re,$,$.scopeId,ge,z),q&&na($,null,z,"beforeMount");const le=(!V||V&&!V.pendingBranch)&&U&&!U.persisted;le&&U.beforeEnter(re),a(re,P,G),((Z=xe&&xe.onVnodeMounted)||le||q)&&Dt(()=>{Z&&fn(Z,z,$),le&&U.enter(re),q&&na($,null,z,"mounted")},V)},O=($,P,G,z,V)=>{if(G&&f($,G),z)for(let te=0;te<z.length;te++)f($,z[te]);if(V){let te=V.subTree;if(P===te){const ge=V.vnode;O($,ge,ge.scopeId,ge.slotScopeIds,V.parent)}}},T=($,P,G,z,V,te,ge,ae,re=0)=>{for(let Z=re;Z<$.length;Z++){const Oe=$[Z]=ae?jn($[Z]):mn($[Z]);y(null,Oe,P,G,z,V,te,ge,ae)}},L=($,P,G,z,V,te,ge)=>{const ae=P.el=$.el;let{patchFlag:re,dynamicChildren:Z,dirs:Oe}=P;re|=$.patchFlag&16;const xe=$.props||Ze,Te=P.props||Ze;let U;G&&aa(G,!1),(U=Te.onVnodeBeforeUpdate)&&fn(U,G,P,$),Oe&&na(P,$,G,"beforeUpdate"),G&&aa(G,!0);const q=V&&P.type!=="foreignObject";if(Z?R($.dynamicChildren,Z,ae,G,z,q,te):ge||Ge($,P,ae,null,G,z,q,te,!1),re>0){if(re&16)B(ae,P,xe,Te,G,z,V);else if(re&2&&xe.class!==Te.class&&r(ae,"class",null,Te.class,V),re&4&&r(ae,"style",xe.style,Te.style,V),re&8){const le=P.dynamicProps;for(let de=0;de<le.length;de++){const Re=le[de],Xe=xe[Re],gt=Te[Re];(gt!==Xe||Re==="value")&&r(ae,Re,Xe,gt,V,$.children,G,z,Y)}}re&1&&$.children!==P.children&&c(ae,P.children)}else!ge&&Z==null&&B(ae,P,xe,Te,G,z,V);((U=Te.onVnodeUpdated)||Oe)&&Dt(()=>{U&&fn(U,G,P,$),Oe&&na(P,$,G,"updated")},z)},R=($,P,G,z,V,te,ge)=>{for(let ae=0;ae<P.length;ae++){const re=$[ae],Z=P[ae],Oe=re.el&&(re.type===ye||!ia(re,Z)||re.shapeFlag&70)?p(re.el):G;y(re,Z,Oe,null,z,V,te,ge,!0)}},B=($,P,G,z,V,te,ge)=>{if(G!==z){if(G!==Ze)for(const ae in G)!ir(ae)&&!(ae in z)&&r($,ae,G[ae],null,ge,P.children,V,te,Y);for(const ae in z){if(ir(ae))continue;const re=z[ae],Z=G[ae];re!==Z&&ae!=="value"&&r($,ae,Z,re,ge,P.children,V,te,Y)}"value"in z&&r($,"value",G.value,z.value)}},N=($,P,G,z,V,te,ge,ae,re)=>{const Z=P.el=$?$.el:l(""),Oe=P.anchor=$?$.anchor:l("");let{patchFlag:xe,dynamicChildren:Te,slotScopeIds:U}=P;U&&(ae=ae?ae.concat(U):U),$==null?(a(Z,G,z),a(Oe,G,z),T(P.children,G,Oe,V,te,ge,ae,re)):xe>0&&xe&64&&Te&&$.dynamicChildren?(R($.dynamicChildren,Te,G,V,te,ge,ae),(P.key!=null||V&&P===V.subTree)&&Dl($,P,!0)):Ge($,P,G,Oe,V,te,ge,ae,re)},j=($,P,G,z,V,te,ge,ae,re)=>{P.slotScopeIds=ae,$==null?P.shapeFlag&512?V.ctx.activate(P,G,z,ge,re):K(P,G,z,V,te,ge,re):D($,P,re)},K=($,P,G,z,V,te,ge)=>{const ae=$.component=vv($,z,V);if(Ll($)&&(ae.ctx.renderer=me),bv(ae),ae.asyncDep){if(V&&V.registerDep(ae,fe),!$.el){const re=ae.subTree=w(Zt);E(null,re,P,G)}return}fe(ae,$,P,G,V,te,ge)},D=($,P,G)=>{const z=P.component=$.component;if(Ny($,P,G))if(z.asyncDep&&!z.asyncResolved){Le(z,P,G);return}else z.next=P,Ay(z.update),z.update();else P.el=$.el,z.vnode=P},fe=($,P,G,z,V,te,ge)=>{const ae=()=>{if($.isMounted){let{next:Oe,bu:xe,u:Te,parent:U,vnode:q}=$,le=Oe,de;aa($,!1),Oe?(Oe.el=q.el,Le($,Oe,ge)):Oe=q,xe&&cr(xe),(de=Oe.props&&Oe.props.onVnodeBeforeUpdate)&&fn(de,U,Oe,q),aa($,!0);const Re=Ss($),Xe=$.subTree;$.subTree=Re,y(Xe,Re,p(Xe.el),pe(Xe),$,V,te),Oe.el=Re.el,le===null&&Vy($,Re.el),Te&&Dt(Te,V),(de=Oe.props&&Oe.props.onVnodeUpdated)&&Dt(()=>fn(de,U,Oe,q),V)}else{let Oe;const{el:xe,props:Te}=P,{bm:U,m:q,parent:le}=$,de=co(P);if(aa($,!1),U&&cr(U),!de&&(Oe=Te&&Te.onVnodeBeforeMount)&&fn(Oe,le,P),aa($,!0),xe&&we){const Re=()=>{$.subTree=Ss($),we(xe,$.subTree,$,V,null)};de?P.type.__asyncLoader().then(()=>!$.isUnmounted&&Re()):Re()}else{const Re=$.subTree=Ss($);y(null,Re,G,z,$,V,te),P.el=Re.el}if(q&&Dt(q,V),!de&&(Oe=Te&&Te.onVnodeMounted)){const Re=P;Dt(()=>fn(Oe,le,Re),V)}(P.shapeFlag&256||le&&co(le.vnode)&&le.vnode.shapeFlag&256)&&$.a&&Dt($.a,V),$.isMounted=!0,P=G=z=null}},re=$.effect=new Ml(ae,()=>Bl(Z),$.scope),Z=$.update=()=>re.run();Z.id=$.uid,aa($,!0),Z()},Le=($,P,G)=>{P.component=$;const z=$.vnode.props;$.vnode=P,$.next=null,Qy($,P.props,z,G),av($,P.children,G),jo(),Zu(),No()},Ge=($,P,G,z,V,te,ge,ae,re=!1)=>{const Z=$&&$.children,Oe=$?$.shapeFlag:0,xe=P.children,{patchFlag:Te,shapeFlag:U}=P;if(Te>0){if(Te&128){$e(Z,xe,G,z,V,te,ge,ae,re);return}else if(Te&256){vt(Z,xe,G,z,V,te,ge,ae,re);return}}U&8?(Oe&16&&Y(Z,V,te),xe!==Z&&c(G,xe)):Oe&16?U&16?$e(Z,xe,G,z,V,te,ge,ae,re):Y(Z,V,te,!0):(Oe&8&&c(G,""),U&16&&T(xe,G,z,V,te,ge,ae,re))},vt=($,P,G,z,V,te,ge,ae,re)=>{$=$||Aa,P=P||Aa;const Z=$.length,Oe=P.length,xe=Math.min(Z,Oe);let Te;for(Te=0;Te<xe;Te++){const U=P[Te]=re?jn(P[Te]):mn(P[Te]);y($[Te],U,G,null,V,te,ge,ae,re)}Z>Oe?Y($,V,te,!0,!1,xe):T(P,G,z,V,te,ge,ae,re,xe)},$e=($,P,G,z,V,te,ge,ae,re)=>{let Z=0;const Oe=P.length;let xe=$.length-1,Te=Oe-1;for(;Z<=xe&&Z<=Te;){const U=$[Z],q=P[Z]=re?jn(P[Z]):mn(P[Z]);if(ia(U,q))y(U,q,G,null,V,te,ge,ae,re);else break;Z++}for(;Z<=xe&&Z<=Te;){const U=$[xe],q=P[Te]=re?jn(P[Te]):mn(P[Te]);if(ia(U,q))y(U,q,G,null,V,te,ge,ae,re);else break;xe--,Te--}if(Z>xe){if(Z<=Te){const U=Te+1,q=U<Oe?P[U].el:z;for(;Z<=Te;)y(null,P[Z]=re?jn(P[Z]):mn(P[Z]),G,q,V,te,ge,ae,re),Z++}}else if(Z>Te)for(;Z<=xe;)_e($[Z],V,te,!0),Z++;else{const U=Z,q=Z,le=new Map;for(Z=q;Z<=Te;Z++){const ft=P[Z]=re?jn(P[Z]):mn(P[Z]);ft.key!=null&&le.set(ft.key,Z)}let de,Re=0;const Xe=Te-q+1;let gt=!1,Ot=0;const qe=new Array(Xe);for(Z=0;Z<Xe;Z++)qe[Z]=0;for(Z=U;Z<=xe;Z++){const ft=$[Z];if(Re>=Xe){_e(ft,V,te,!0);continue}let Kt;if(ft.key!=null)Kt=le.get(ft.key);else for(de=q;de<=Te;de++)if(qe[de-q]===0&&ia(ft,P[de])){Kt=de;break}Kt===void 0?_e(ft,V,te,!0):(qe[Kt-q]=Z+1,Kt>=Ot?Ot=Kt:gt=!0,y(ft,P[Kt],G,null,V,te,ge,ae,re),Re++)}const rt=gt?uv(qe):Aa;for(de=rt.length-1,Z=Xe-1;Z>=0;Z--){const ft=q+Z,Kt=P[ft],zo=ft+1<Oe?P[ft+1].el:z;qe[Z]===0?y(null,Kt,G,zo,V,te,ge,ae,re):gt&&(de<0||Z!==rt[de]?oe(Kt,G,zo,2):de--)}}},oe=($,P,G,z,V=null)=>{const{el:te,type:ge,transition:ae,children:re,shapeFlag:Z}=$;if(Z&6){oe($.component.subTree,P,G,z);return}if(Z&128){$.suspense.move(P,G,z);return}if(Z&64){ge.move($,P,G,me);return}if(ge===ye){a(te,P,G);for(let xe=0;xe<re.length;xe++)oe(re[xe],P,G,z);a($.anchor,P,G);return}if(ge===ks){v($,P,G);return}if(z!==2&&Z&1&&ae)if(z===0)ae.beforeEnter(te),a(te,P,G),Dt(()=>ae.enter(te),V);else{const{leave:xe,delayLeave:Te,afterLeave:U}=ae,q=()=>a(te,P,G),le=()=>{xe(te,()=>{q(),U&&U()})};Te?Te(te,q,le):le()}else a(te,P,G)},_e=($,P,G,z=!1,V=!1)=>{const{type:te,props:ge,ref:ae,children:re,dynamicChildren:Z,shapeFlag:Oe,patchFlag:xe,dirs:Te}=$;if(ae!=null&&Zs(ae,null,G,$,!0),Oe&256){P.ctx.deactivate($);return}const U=Oe&1&&Te,q=!co($);let le;if(q&&(le=ge&&ge.onVnodeBeforeUnmount)&&fn(le,P,$),Oe&6)Mt($.component,G,z);else{if(Oe&128){$.suspense.unmount(G,z);return}U&&na($,null,P,"beforeUnmount"),Oe&64?$.type.remove($,P,G,V,me,z):Z&&(te!==ye||xe>0&&xe&64)?Y(Z,P,G,!1,!0):(te===ye&&xe&384||!V&&Oe&16)&&Y(re,P,G),z&&De($)}(q&&(le=ge&&ge.onVnodeUnmounted)||U)&&Dt(()=>{le&&fn(le,P,$),U&&na($,null,P,"unmounted")},G)},De=$=>{const{type:P,el:G,anchor:z,transition:V}=$;if(P===ye){dt(G,z);return}if(P===ks){A($);return}const te=()=>{o(G),V&&!V.persisted&&V.afterLeave&&V.afterLeave()};if($.shapeFlag&1&&V&&!V.persisted){const{leave:ge,delayLeave:ae}=V,re=()=>ge(G,te);ae?ae($.el,te,re):re()}else te()},dt=($,P)=>{let G;for(;$!==P;)G=d($),o($),$=G;o(P)},Mt=($,P,G)=>{const{bum:z,scope:V,update:te,subTree:ge,um:ae}=$;z&&cr(z),V.stop(),te&&(te.active=!1,_e(ge,$,P,G)),ae&&Dt(ae,P),Dt(()=>{$.isUnmounted=!0},P),P&&P.pendingBranch&&!P.isUnmounted&&$.asyncDep&&!$.asyncResolved&&$.suspenseId===P.pendingId&&(P.deps--,P.deps===0&&P.resolve())},Y=($,P,G,z=!1,V=!1,te=0)=>{for(let ge=te;ge<$.length;ge++)_e($[ge],P,G,z,V)},pe=$=>$.shapeFlag&6?pe($.component.subTree):$.shapeFlag&128?$.suspense.next():d($.anchor||$.el),Ee=($,P,G)=>{$==null?P._vnode&&_e(P._vnode,null,null,!0):y(P._vnode||null,$,P,null,null,null,G),Zu(),zd(),P._vnode=$},me={p:y,um:_e,m:oe,r:De,mt:K,mc:T,pc:Ge,pbc:R,n:pe,o:e};let ne,we;return t&&([ne,we]=t(me)),{render:Ee,hydrate:ne,createApp:rv(Ee,ne)}}function aa({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function Dl(e,t,n=!1){const a=e.children,o=t.children;if(Be(a)&&Be(o))for(let r=0;r<a.length;r++){const s=a[r];let l=o[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=o[r]=jn(o[r]),l.el=s.el),n||Dl(s,l)),l.type===Jr&&(l.el=s.el)}}function uv(e){const t=e.slice(),n=[0];let a,o,r,s,l;const u=e.length;for(a=0;a<u;a++){const i=e[a];if(i!==0){if(o=n[n.length-1],e[o]<i){t[a]=o,n.push(a);continue}for(r=0,s=n.length-1;r<s;)l=r+s>>1,e[n[l]]<i?r=l+1:s=l;i<e[n[r]]&&(r>0&&(t[a]=n[r-1]),n[r]=a)}}for(r=n.length,s=n[r-1];r-- >0;)n[r]=s,s=t[s];return n}const iv=e=>e.__isTeleport,po=e=>e&&(e.disabled||e.disabled===""),ui=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Qs=(e,t)=>{const n=e&&e.to;return yt(n)?t?t(n):null:n},cv={__isTeleport:!0,process(e,t,n,a,o,r,s,l,u,i){const{mc:c,pc:p,pbc:d,o:{insert:f,querySelector:h,createText:y,createComment:k}}=i,E=po(t.props);let{shapeFlag:g,children:v,dynamicChildren:A}=t;if(e==null){const x=t.el=y(""),I=t.anchor=y("");f(x,n,a),f(I,n,a);const O=t.target=Qs(t.props,h),T=t.targetAnchor=y("");O&&(f(T,O),s=s||ui(O));const L=(R,B)=>{g&16&&c(v,R,B,o,r,s,l,u)};E?L(n,I):O&&L(O,T)}else{t.el=e.el;const x=t.anchor=e.anchor,I=t.target=e.target,O=t.targetAnchor=e.targetAnchor,T=po(e.props),L=T?n:I,R=T?x:O;if(s=s||ui(I),A?(d(e.dynamicChildren,A,L,o,r,s,l),Dl(e,t,!0)):u||p(e,t,L,R,o,r,s,l,!1),E)T||Qo(t,n,x,i,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const B=t.target=Qs(t.props,h);B&&Qo(t,B,null,i,0)}else T&&Qo(t,I,O,i,1)}rf(t)},remove(e,t,n,a,{um:o,o:{remove:r}},s){const{shapeFlag:l,children:u,anchor:i,targetAnchor:c,target:p,props:d}=e;if(p&&r(c),(s||!po(d))&&(r(i),l&16))for(let f=0;f<u.length;f++){const h=u[f];o(h,t,n,!0,!!h.dynamicChildren)}},move:Qo,hydrate:dv};function Qo(e,t,n,{o:{insert:a},m:o},r=2){r===0&&a(e.targetAnchor,t,n);const{el:s,anchor:l,shapeFlag:u,children:i,props:c}=e,p=r===2;if(p&&a(s,t,n),(!p||po(c))&&u&16)for(let d=0;d<i.length;d++)o(i[d],t,n,2);p&&a(l,t,n)}function dv(e,t,n,a,o,r,{o:{nextSibling:s,parentNode:l,querySelector:u}},i){const c=t.target=Qs(t.props,u);if(c){const p=c._lpa||c.firstChild;if(t.shapeFlag&16)if(po(t.props))t.anchor=i(s(e),t,l(e),n,a,o,r),t.targetAnchor=p;else{t.anchor=s(e);let d=p;for(;d;)if(d=s(d),d&&d.nodeType===8&&d.data==="teleport anchor"){t.targetAnchor=d,c._lpa=t.targetAnchor&&s(t.targetAnchor);break}i(p,t,c,n,a,o,r)}rf(t)}return t.anchor&&s(t.anchor)}const Fl=cv;function rf(e){const t=e.ctx;if(t&&t.ut){let n=e.children[0].el;for(;n!==e.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}const ye=Symbol(void 0),Jr=Symbol(void 0),Zt=Symbol(void 0),ks=Symbol(void 0),mo=[];let en=null;function _(e=!1){mo.push(en=e?null:[])}function fv(){mo.pop(),en=mo[mo.length-1]||null}let Eo=1;function ii(e){Eo+=e}function sf(e){return e.dynamicChildren=Eo>0?en||Aa:null,fv(),Eo>0&&en&&en.push(e),e}function M(e,t,n,a,o,r){return sf(C(e,t,n,a,o,r,!0))}function Se(e,t,n,a,o){return sf(w(e,t,n,a,o,!0))}function Sr(e){return e?e.__v_isVNode===!0:!1}function ia(e,t){return e.type===t.type&&e.key===t.key}const qr="__vInternal",lf=({key:e})=>e??null,dr=({ref:e,ref_key:t,ref_for:n})=>e!=null?yt(e)||Fe(e)||He(e)?{i:Et,r:e,k:t,f:!!n}:e:null;function C(e,t=null,n=null,a=0,o=null,r=e===ye?0:1,s=!1,l=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&lf(t),ref:t&&dr(t),scopeId:Hr,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:a,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Et};return l?(Ul(u,n),r&128&&e.normalize(u)):n&&(u.shapeFlag|=yt(n)?8:16),Eo>0&&!s&&en&&(u.patchFlag>0||r&6)&&u.patchFlag!==32&&en.push(u),u}const w=pv;function pv(e,t=null,n=null,a=0,o=null,r=!1){if((!e||e===qd)&&(e=Zt),Sr(e)){const l=Hn(e,t,!0);return n&&Ul(l,n),Eo>0&&!r&&en&&(l.shapeFlag&6?en[en.indexOf(e)]=l:en.push(l)),l.patchFlag|=-2,l}if(kv(e)&&(e=e.__vccOpts),t){t=uf(t);let{class:l,style:u}=t;l&&!yt(l)&&(t.class=et(l)),nt(u)&&(jd(u)&&!Be(u)&&(u=Rt({},u)),t.style=st(u))}const s=yt(e)?1:Dy(e)?128:iv(e)?64:nt(e)?4:He(e)?2:0;return C(e,t,n,a,o,s,r,!0)}function uf(e){return e?jd(e)||qr in e?Rt({},e):e:null}function Hn(e,t,n=!1){const{props:a,ref:o,patchFlag:r,children:s}=e,l=t?mv(a||{},t):a;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&lf(l),ref:t&&t.ref?n&&o?Be(o)?o.concat(dr(t)):[o,dr(t)]:dr(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ye?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Hn(e.ssContent),ssFallback:e.ssFallback&&Hn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function $t(e=" ",t=0){return w(Jr,null,e,t)}function ce(e="",t=!1){return t?(_(),Se(Zt,null,e)):w(Zt,null,e)}function mn(e){return e==null||typeof e=="boolean"?w(Zt):Be(e)?w(ye,null,e.slice()):typeof e=="object"?jn(e):w(Jr,null,String(e))}function jn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Hn(e)}function Ul(e,t){let n=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(Be(t))n=16;else if(typeof t=="object")if(a&65){const o=t.default;o&&(o._c&&(o._d=!1),Ul(e,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!(qr in t)?t._ctx=Et:o===3&&Et&&(Et.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else He(t)?(t={default:t,_ctx:Et},n=32):(t=String(t),a&64?(n=16,t=[$t(t)]):n=8);e.children=t,e.shapeFlag|=n}function mv(...e){const t={};for(let n=0;n<e.length;n++){const a=e[n];for(const o in a)if(o==="class")t.class!==a.class&&(t.class=et([t.class,a.class]));else if(o==="style")t.style=st([t.style,a.style]);else if(Ur(o)){const r=t[o],s=a[o];s&&r!==s&&!(Be(r)&&r.includes(s))&&(t[o]=r?[].concat(r,s):s)}else o!==""&&(t[o]=a[o])}return t}function fn(e,t,n,a=null){on(e,t,7,[n,a])}const hv=of();let yv=0;function vv(e,t,n){const a=e.type,o=(t?t.appContext:e.appContext)||hv,r={uid:yv++,vnode:e,type:a,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new Jh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ev(a,o),emitsOptions:Ly(a,o),emit:null,emitted:null,propsDefaults:Ze,inheritAttrs:a.inheritAttrs,ctx:Ze,data:Ze,props:Ze,attrs:Ze,slots:Ze,refs:Ze,setupState:Ze,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=By.bind(null,r),e.ce&&e.ce(r),r}let Lt=null;const gv=()=>Lt||Et,Gl=e=>{Lt=e,e.scope.on()},ho=()=>{Lt&&Lt.scope.off(),Lt=null};function cf(e){return e.vnode.shapeFlag&4}let Co=!1;function bv(e,t=!1){Co=t;const{props:n,children:a}=e.vnode,o=cf(e);Zy(e,n,o,t),nv(e,a);const r=o?_v(e,t):void 0;return Co=!1,r}function _v(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=Nd(new Proxy(e.ctx,Xy));const{setup:a}=n;if(a){const o=e.setupContext=a.length>1?xv(e):null;Gl(e),jo();const r=Un(a,e,0,[e.props,o]);if(No(),ho(),wd(r)){if(r.then(ho,ho),t)return r.then(s=>{ci(e,s,t)}).catch(s=>{Yr(s,e,0)});e.asyncDep=r}else ci(e,r,t)}else df(e,t)}function ci(e,t,n){He(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:nt(t)&&(e.setupState=Fd(t)),df(e,n)}let di;function df(e,t,n){const a=e.type;if(!e.render){if(!t&&di&&!a.render){const o=a.template||Hy(e).template;if(o){const{isCustomElement:r,compilerOptions:s}=e.appContext.config,{delimiters:l,compilerOptions:u}=a,i=Rt(Rt({isCustomElement:r,delimiters:l},s),u);a.render=di(o,i)}}e.render=a.render||Dn}}function Sv(e){return new Proxy(e.attrs,{get(t,n){return Ht(e,"get","$attrs"),t[n]}})}function xv(e){const t=a=>{e.exposed=a||{}};let n;return{get attrs(){return n||(n=Sv(e))},slots:e.slots,emit:e.emit,expose:t}}function Zr(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Fd(Nd(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in fo)return fo[n](e)},has(t,n){return n in t||n in fo}}))}function wv(e,t=!0){return He(e)?e.displayName||e.name:e.name||t&&e.__name}function kv(e){return He(e)&&"__vccOpts"in e}const b=(e,t)=>Oy(e,t,Co);function Ev(e,t,n){const a=arguments.length;return a===2?nt(t)&&!Be(t)?Sr(t)?w(e,null,[t]):w(e,t):w(e,null,t):(a>3?n=Array.prototype.slice.call(arguments,2):a===3&&Sr(n)&&(n=[n]),w(e,t,n))}const Cv=Symbol(""),Mv=()=>ba(Cv),Ov="3.2.45",Tv="http://www.w3.org/2000/svg",ca=typeof document<"u"?document:null,fi=ca&&ca.createElement("template"),$v={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,a)=>{const o=t?ca.createElementNS(Tv,e):ca.createElement(e,n?{is:n}:void 0);return e==="select"&&a&&a.multiple!=null&&o.setAttribute("multiple",a.multiple),o},createText:e=>ca.createTextNode(e),createComment:e=>ca.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ca.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,a,o,r){const s=n?n.previousSibling:t.lastChild;if(o&&(o===r||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===r||!(o=o.nextSibling)););else{fi.innerHTML=a?`<svg>${e}</svg>`:e;const l=fi.content;if(a){const u=l.firstChild;for(;u.firstChild;)l.appendChild(u.firstChild);l.removeChild(u)}t.insertBefore(l,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Av(e,t,n){const a=e._vtc;a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function Iv(e,t,n){const a=e.style,o=yt(n);if(n&&!o){for(const r in n)el(a,r,n[r]);if(t&&!yt(t))for(const r in t)n[r]==null&&el(a,r,"")}else{const r=a.display;o?t!==n&&(a.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(a.display=r)}}const pi=/\s*!important$/;function el(e,t,n){if(Be(n))n.forEach(a=>el(e,t,a));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const a=Pv(e,t);pi.test(n)?e.setProperty(Xa(a),n.replace(pi,""),"important"):e[a]=n}}const mi=["Webkit","Moz","ms"],Es={};function Pv(e,t){const n=Es[t];if(n)return n;let a=Sn(t);if(a!=="filter"&&a in e)return Es[t]=a;a=Kr(a);for(let o=0;o<mi.length;o++){const r=mi[o]+a;if(r in e)return Es[t]=r}return t}const hi="http://www.w3.org/1999/xlink";function Bv(e,t,n,a,o){if(a&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(hi,t.slice(6,t.length)):e.setAttributeNS(hi,t,n);else{const r=Fh(t);n==null||r&&!_d(n)?e.removeAttribute(t):e.setAttribute(t,r?"":n)}}function Lv(e,t,n,a,o,r,s){if(t==="innerHTML"||t==="textContent"){a&&s(a,o,r),e[t]=n??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const u=n??"";(e.value!==u||e.tagName==="OPTION")&&(e.value=u),n==null&&e.removeAttribute(t);return}let l=!1;if(n===""||n==null){const u=typeof e[t];u==="boolean"?n=_d(n):n==null&&u==="string"?(n="",l=!0):u==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(t)}function Nn(e,t,n,a){e.addEventListener(t,n,a)}function Rv(e,t,n,a){e.removeEventListener(t,n,a)}function jv(e,t,n,a,o=null){const r=e._vei||(e._vei={}),s=r[t];if(a&&s)s.value=a;else{const[l,u]=Nv(t);if(a){const i=r[t]=Fv(a,o);Nn(e,l,i,u)}else s&&(Rv(e,l,s,u),r[t]=void 0)}}const yi=/(?:Once|Passive|Capture)$/;function Nv(e){let t;if(yi.test(e)){t={};let a;for(;a=e.match(yi);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Xa(e.slice(2)),t]}let Cs=0;const Vv=Promise.resolve(),Dv=()=>Cs||(Vv.then(()=>Cs=0),Cs=Date.now());function Fv(e,t){const n=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=n.attached)return;on(Uv(a,n.value),t,5,[a])};return n.value=e,n.attached=Dv(),n}function Uv(e,t){if(Be(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(a=>o=>!o._stopped&&a&&a(o))}else return t}const vi=/^on[a-z]/,Gv=(e,t,n,a,o=!1,r,s,l,u)=>{t==="class"?Av(e,a,o):t==="style"?Iv(e,n,a):Ur(t)?kl(t)||jv(e,t,n,a,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Kv(e,t,a,o))?Lv(e,t,a,r,s,l,u):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),Bv(e,t,a,o))};function Kv(e,t,n,a){return a?!!(t==="innerHTML"||t==="textContent"||t in e&&vi.test(t)&&He(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||vi.test(t)&&yt(n)?!1:t in e}const Bn="transition",ro="animation",Kl=(e,{slots:t})=>Ev(Hd,zv(e),t);Kl.displayName="Transition";const ff={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Kl.props=Rt({},Hd.props,ff);const oa=(e,t=[])=>{Be(e)?e.forEach(n=>n(...t)):e&&e(...t)},gi=e=>e?Be(e)?e.some(t=>t.length>1):e.length>1:!1;function zv(e){const t={};for(const N in e)N in ff||(t[N]=e[N]);if(e.css===!1)return t;const{name:n="v",type:a,duration:o,enterFromClass:r=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:u=r,appearActiveClass:i=s,appearToClass:c=l,leaveFromClass:p=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=e,h=Yv(o),y=h&&h[0],k=h&&h[1],{onBeforeEnter:E,onEnter:g,onEnterCancelled:v,onLeave:A,onLeaveCancelled:x,onBeforeAppear:I=E,onAppear:O=g,onAppearCancelled:T=v}=t,L=(N,j,K)=>{ra(N,j?c:l),ra(N,j?i:s),K&&K()},R=(N,j)=>{N._isLeaving=!1,ra(N,p),ra(N,f),ra(N,d),j&&j()},B=N=>(j,K)=>{const D=N?O:g,fe=()=>L(j,N,K);oa(D,[j,fe]),bi(()=>{ra(j,N?u:r),Ln(j,N?c:l),gi(D)||_i(j,a,y,fe)})};return Rt(t,{onBeforeEnter(N){oa(E,[N]),Ln(N,r),Ln(N,s)},onBeforeAppear(N){oa(I,[N]),Ln(N,u),Ln(N,i)},onEnter:B(!1),onAppear:B(!0),onLeave(N,j){N._isLeaving=!0;const K=()=>R(N,j);Ln(N,p),Wv(),Ln(N,d),bi(()=>{N._isLeaving&&(ra(N,p),Ln(N,f),gi(A)||_i(N,a,k,K))}),oa(A,[N,K])},onEnterCancelled(N){L(N,!1),oa(v,[N])},onAppearCancelled(N){L(N,!0),oa(T,[N])},onLeaveCancelled(N){R(N),oa(x,[N])}})}function Yv(e){if(e==null)return null;if(nt(e))return[Ms(e.enter),Ms(e.leave)];{const t=Ms(e);return[t,t]}}function Ms(e){return ja(e)}function Ln(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function ra(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function bi(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Xv=0;function _i(e,t,n,a){const o=e._endId=++Xv,r=()=>{o===e._endId&&a()};if(n)return setTimeout(r,n);const{type:s,timeout:l,propCount:u}=Hv(e,t);if(!s)return a();const i=s+"end";let c=0;const p=()=>{e.removeEventListener(i,d),r()},d=f=>{f.target===e&&++c>=u&&p()};setTimeout(()=>{c<u&&p()},l+1),e.addEventListener(i,d)}function Hv(e,t){const n=window.getComputedStyle(e),a=h=>(n[h]||"").split(", "),o=a(`${Bn}Delay`),r=a(`${Bn}Duration`),s=Si(o,r),l=a(`${ro}Delay`),u=a(`${ro}Duration`),i=Si(l,u);let c=null,p=0,d=0;t===Bn?s>0&&(c=Bn,p=s,d=r.length):t===ro?i>0&&(c=ro,p=i,d=u.length):(p=Math.max(s,i),c=p>0?s>i?Bn:ro:null,d=c?c===Bn?r.length:u.length:0);const f=c===Bn&&/\b(transform|all)(,|$)/.test(a(`${Bn}Property`).toString());return{type:c,timeout:p,propCount:d,hasTransform:f}}function Si(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,a)=>xi(n)+xi(e[a])))}function xi(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function Wv(){return document.body.offsetHeight}const Va=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Be(t)?n=>cr(t,n):t};function Jv(e){e.target.composing=!0}function wi(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Qr={created(e,{modifiers:{lazy:t,trim:n,number:a}},o){e._assign=Va(o);const r=a||o.props&&o.props.type==="number";Nn(e,t?"change":"input",s=>{if(s.target.composing)return;let l=e.value;n&&(l=l.trim()),r&&(l=ja(l)),e._assign(l)}),n&&Nn(e,"change",()=>{e.value=e.value.trim()}),t||(Nn(e,"compositionstart",Jv),Nn(e,"compositionend",wi),Nn(e,"change",wi))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:a,number:o}},r){if(e._assign=Va(r),e.composing||document.activeElement===e&&e.type!=="range"&&(n||a&&e.value.trim()===t||(o||e.type==="number")&&ja(e.value)===t))return;const s=t??"";e.value!==s&&(e.value=s)}},qv={deep:!0,created(e,t,n){e._assign=Va(n),Nn(e,"change",()=>{const a=e._modelValue,o=Mo(e),r=e.checked,s=e._assign;if(Be(a)){const l=wl(a,o),u=l!==-1;if(r&&!u)s(a.concat(o));else if(!r&&u){const i=[...a];i.splice(l,1),s(i)}}else if(Ya(a)){const l=new Set(a);r?l.add(o):l.delete(o),s(l)}else s(pf(e,r))})},mounted:ki,beforeUpdate(e,t,n){e._assign=Va(n),ki(e,t,n)}};function ki(e,{value:t,oldValue:n},a){e._modelValue=t,Be(t)?e.checked=wl(t,a.props.value)>-1:Ya(t)?e.checked=t.has(a.props.value):t!==n&&(e.checked=Lo(t,pf(e,!0)))}const Zv={deep:!0,created(e,{value:t,modifiers:{number:n}},a){const o=Ya(t);Nn(e,"change",()=>{const r=Array.prototype.filter.call(e.options,s=>s.selected).map(s=>n?ja(Mo(s)):Mo(s));e._assign(e.multiple?o?new Set(r):r:r[0])}),e._assign=Va(a)},mounted(e,{value:t}){Ei(e,t)},beforeUpdate(e,t,n){e._assign=Va(n)},updated(e,{value:t}){Ei(e,t)}};function Ei(e,t){const n=e.multiple;if(!(n&&!Be(t)&&!Ya(t))){for(let a=0,o=e.options.length;a<o;a++){const r=e.options[a],s=Mo(r);if(n)Be(t)?r.selected=wl(t,s)>-1:r.selected=t.has(s);else if(Lo(Mo(r),t)){e.selectedIndex!==a&&(e.selectedIndex=a);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Mo(e){return"_value"in e?e._value:e.value}function pf(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Qv=["ctrl","shift","alt","meta"],eg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Qv.some(n=>e[`${n}Key`]&&!t.includes(n))},Ke=(e,t)=>(n,...a)=>{for(let o=0;o<t.length;o++){const r=eg[t[o]];if(r&&r(n,t))return}return e(n,...a)},mf={beforeMount(e,{value:t},{transition:n}){e._vod=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):so(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:a}){!t!=!n&&(a?t?(a.beforeEnter(e),so(e,!0),a.enter(e)):a.leave(e,()=>{so(e,!1)}):so(e,t))},beforeUnmount(e,{value:t}){so(e,t)}};function so(e,t){e.style.display=t?e._vod:"none"}const tg=Rt({patchProp:Gv},$v);let Ci;function ng(){return Ci||(Ci=sv(tg))}const ag=(...e)=>{const t=ng().createApp(...e),{mount:n}=t;return t.mount=a=>{const o=og(a);if(!o)return;const r=t._component;!He(r)&&!r.render&&!r.template&&(r.template=o.innerHTML),o.innerHTML="";const s=n(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),s},t};function og(e){return yt(e)?document.querySelector(e):e}const rg={class:"cnavas-mode-panel"},sg=J({__name:"CanvasModepanel",props:{canvasMode:null},emits:["change-mode"],setup(e,{emit:t}){function n(a){t("change-mode",a)}return(a,o)=>(_(),M("div",rg,[C("button",{type:"button",class:et({selected:e.canvasMode==="edit"}),onClick:o[0]||(o[0]=r=>n("edit"))}," Edit ",2),C("button",{type:"button",class:et({selected:e.canvasMode==="pose"}),onClick:o[1]||(o[1]=r=>n("pose"))}," Pose ",2),C("button",{type:"button",class:et({selected:e.canvasMode==="weight"}),onClick:o[2]||(o[2]=r=>n("weight"))}," Weight ",2)]))}});const Me=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n},lg=Me(sg,[["__scopeId","data-v-fd46187a"]]),ug={key:0,class:"canvas-command"},ig={key:0,class:"command"},cg=J({__name:"CommandExamPanel",props:{availableCommandList:{default:()=>[]}},setup(e){return(t,n)=>(_(),Se(Kl,null,{default:F(()=>[e.availableCommandList.length>0?(_(),M("div",ug,[C("ul",null,[(_(!0),M(ye,null,Pe(e.availableCommandList,a=>(_(),M("li",{key:a.command},[a.command?(_(),M("span",ig,Ve(a.command)+":",1)):ce("",!0),C("span",null,Ve(a.title),1)]))),128))])])):ce("",!0)]),_:1}))}});const zl=Me(cg,[["__scopeId","data-v-0fbccacb"]]),dg={key:0,class:"drop-menu"},fg=["onClick"],pg={key:0},mg=J({__name:"DropdownMenu",props:{label:null,items:{default:()=>[]}},setup(e){const t=H(),n=H(!1);function a(s){var l;s.target instanceof Element&&((l=t.value)!=null&&l.contains(s.target)||(n.value=!1))}pt(n,s=>{s?window.addEventListener("mousemove",a):window.removeEventListener("mousemove",a)});function o(){n.value=!n.value}function r(s){s==null||s(),n.value=!1}return(s,l)=>(_(),M("div",{ref_key:"root",ref:t,class:"dropdown-menu"},[C("button",{type:"button",onClick:o},Ve(e.label),1),n.value?(_(),M("ul",dg,[(_(!0),M(ye,null,Pe(e.items,u=>(_(),M(ye,{key:u.label},[C("li",null,[C("button",{type:"button",onClick:i=>r(u.exec)},Ve(u.label),9,fg)]),u.underline?(_(),M("hr",pg)):ce("",!0)],64))),128))])):ce("",!0)],512))}});const hg=Me(mg,[["__scopeId","data-v-9bbe2402"]]),yg={class:"group-wrapper"},vg=J({__name:"CanvasToolMenuGroups",props:{groups:{default:()=>[]}},setup(e){return(t,n)=>(_(),M("div",yg,[(_(!0),M(ye,null,Pe(e.groups,a=>(_(),Se(hg,{key:a.label,items:a.items,label:a.label,class:"group"},null,8,["items","label"]))),128))]))}});const hf=Me(vg,[["__scopeId","data-v-b4b0b460"]]),gg=["transform"],bg=C("rect",{width:"10",height:"10",stroke:"none",class:"fill-background-second"},null,-1),_g=C("path",{d:"M2 7L8 7L5 2z","stroke-linejoin":"round",stroke:"none",class:"fill-background"},null,-1),Sg=[bg,_g],xr=J({__name:"UpIcon",props:{flipped:{type:Boolean,default:!1},right:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10",transform:`rotate(${e.right?90:0}) scale(1, ${e.flipped?-1:1})`},Sg,8,gg))}}),xg={class:"input-wrapper"},wg=["disabled","data-keep-focus"],kg=J({__name:"TextInput",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},realtime:{type:Boolean,default:!1},keepFocus:{type:Boolean,default:!1}},emits:["update:model-value","blur"],setup(e,{emit:t}){const n=e,a=H(),o=H(n.autofocus),r=H("");rn(()=>{r.value=n.modelValue}),pt(r,()=>{n.realtime&&t("update:model-value",r.value)});function s(){r.value!==n.modelValue&&t("update:model-value",r.value)}function l(){var c,p;(c=a.value)==null||c.focus(),(p=a.value)==null||p.select()}Ut(()=>{var c,p;n.autofocus&&((c=a.value)==null||c.focus(),(p=a.value)==null||p.select())});function u(){o.value=!1,t("blur")}const i=()=>o.value=!0;return(c,p)=>(_(),M("div",xg,[Qn(C("input",{ref_key:"inputEl",ref:a,"onUpdate:modelValue":p[0]||(p[0]=d=>r.value=d),type:"text",disabled:e.disabled,"data-keep-focus":e.keepFocus,onChange:s,onFocus:i,onBlur:u},null,40,wg),[[Qr,r.value]]),!o.value&&!e.disabled?(_(),M("div",{key:0,class:"input-forward",onClick:l})):ce("",!0)]))}});const Gn=Me(kg,[["__scopeId","data-v-a20938b3"]]),Eg=J({__name:"DeltaText",props:{deltaList:null},setup(e){return(t,n)=>(_(),M("p",null,[(_(!0),M(ye,null,Pe(e.deltaList,(a,o)=>(_(),M("span",{key:o,class:et({hit:a.hit})},Ve(a.text),3))),128))]))}});const Cg=Me(Eg,[["__scopeId","data-v-48d60cf7"]]);function Mg(e,t){const n=t.indexOf(e);return n===-1?void 0:{from:n,length:e.length}}function Og(e,t){const n=[],a=e.toLowerCase();let o=t;for(;o.length>0;){const r=Mg(a,o.toLowerCase());if(!r){n.push({text:o});break}r.from>0&&n.push({text:o.slice(0,r.from)}),n.push({text:o.slice(r.from,r.from+r.length),hit:!0}),o=o.slice(r.from+r.length)}return n}const Tg=e=>(it("data-v-ac05903c"),e=e(),ct(),e),$g={key:0,class:"keyword-block"},Ag={key:1,class:"not-found"},Ig=Tg(()=>C("p",null,"Not found",-1)),Pg=[Ig],Bg={key:2},Lg=["onClick","onMousemove"],Rg={key:1},Mi=26,Oi=26,jg=J({__name:"PopupMenuList",props:{popupMenuList:null,enabledSearch:{type:Boolean,default:!1}},setup(e){const t=e,n=b(()=>t.popupMenuList.findIndex(u=>u.focus)),a=b(()=>{const u=n.value;return u!==-1?`translateY(-${u*Mi+Oi}px)`:""}),o=b(()=>t.popupMenuList.findIndex(u=>u.opened)),r=b(()=>{var c;const u=(c=t.popupMenuList[o.value])==null?void 0:c.children;if(!u)return 0;const i=Math.ceil(u.length/2)-1;return(o.value-i)*Mi+Oi-1}),s=H(""),l=b(()=>{if(!s.value)return t.popupMenuList;const u=s.value.toLowerCase();return t.popupMenuList.flatMap(i=>[i,...i.children??[]].filter(c=>c.exec&&!c.children&&c.label.toLowerCase().includes(u))).sort((i,c)=>i.label.length-c.label.length)});return(u,i)=>{const c=jl("PopupMenuList",!0);return _(),M("div",{class:"popup-menu-list-wrapper",style:st({transform:m(a)})},[e.enabledSearch?(_(),M("div",$g,[w(Gn,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=p=>s.value=p),realtime:"",autofocus:"","keep-focus":""},null,8,["modelValue"])])):ce("",!0),s.value&&m(l).length===0?(_(),M("div",Ag,Pg)):(_(),M("ul",Bg,[(_(!0),M(ye,null,Pe(m(l),p=>(_(),M("li",{key:p.label},[C("button",{type:"button",onClick:p.exec,onMousemove:p.hover},[s.value?(_(),Se(Cg,{key:0,"delta-list":m(Og)(s.value,p.label)},null,8,["delta-list"])):(_(),M("p",Rg,Ve(p.label),1)),p.children?(_(),Se(xr,{key:2,right:"",class:"right-arrow"})):ce("",!0)],40,Lg),p.children&&p.opened?(_(),Se(c,{key:0,"popup-menu-list":p.children,style:st({top:`${m(r)}px`}),class:"children"},null,8,["popup-menu-list","style"])):ce("",!0)]))),128))]))],4)}}});const Yl=Me(jg,[["__scopeId","data-v-ac05903c"]]);/*! okageo v3.0.8, License MIT, git+https://github.com/miyanokomiya/okageo.git */var Ng=Object.defineProperty,Ti=Object.getOwnPropertySymbols,Vg=Object.prototype.hasOwnProperty,Dg=Object.prototype.propertyIsEnumerable,$i=(e,t,n)=>t in e?Ng(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ai=(e,t)=>{for(var n in t||(t={}))Vg.call(t,n)&&$i(e,n,t[n]);if(Ti)for(var n of Ti(t))Dg.call(t,n)&&$i(e,n,t[n]);return e};const Wn=1e-6,ot=[1,0,0,1,0,0];function he(e,t){return{x:e,y:t}}function ee(e,t){return he(e.x+t.x,e.y+t.y)}function Ce(e,t){return he(e.x-t.x,e.y-t.y)}function Ne(e,t){return he(e.x*t,e.y*t)}function La(e,t){const n=Ce(e,t);return Math.abs(n.x)<Wn&&Math.abs(n.y)<Wn}function It(e,t){return ya(Ce(e,t))}function Fg(e,t=!1){if(e.length<2)return 0;let n=0;for(let a=0;a<e.length-1;a++)n+=It(e[a],e[a+1]);return t&&(n+=It(e[e.length-1],e[0])),n}function ya(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function Da(e){return ya(e)<Wn}function Ug(e,t){return e.x*t.y-e.y*t.x}function wr(e,t){return e.x*t.x+e.y*t.y}function yf(e,t){return Ne(ee(e,t),1/2)}function Gg(e){return he(e.x+e.width/2,e.y+e.height/2)}function vf(e){return e.length===0?he(0,0):Ne(e.reduce((t,n)=>ee(t,n),he(0,0)),1/e.length)}function ht(e,t=he(0,0)){const n=Ce(e,t);return Math.atan2(n.y,n.x)}function er(e,t=he(0,0)){return ee(Ne(Ce(t,e),2),e)}function wt(e,t,n=he(0,0)){const a=Ce(e,n),o=Math.sin(t),r=Math.cos(t);return ee(he(r*a.x-o*a.y,o*a.x+r*a.y),n)}function Kg(e,t=he(0,0)){const n=Math.sin(e),a=Math.cos(e);return(o,r)=>{const s=Ce(o,t);return ee(r?he(a*s.x+n*s.y,-n*s.x+a*s.y):he(a*s.x-n*s.y,n*s.x+a*s.y),t)}}function zg(e,t,n){if(fa(e))return fa(t)?[]:[-n/t];const a=t*t-4*e*n;if(a<0)return[];const o=.5/e;if(fa(a))return[-t*o];const r=Math.sqrt(a);return[(-t+r)*o,(-t-r)*o]}function es(e,t){if(t.length!==2)throw new Error("line must be length = 2");const n=t[0],a=t[1],o=Ce(a,n),r=Ce(e,n),s=wr(o,r)/wr(o,o);return ee(n,Ne(o,s))}function Yg(e,t){const{ta:n,tb:a,tc:o,td:r}=Xg(e,t);return o*r<=0&&n*a<=0}function Xg(e,t){const n=e[0].x,a=e[0].y,o=e[1].x,r=e[1].y,s=t[0].x,l=t[0].y,u=t[1].x,i=t[1].y,c=(s-u)*(a-l)+(l-i)*(s-n),p=(s-u)*(r-l)+(l-i)*(s-o),d=(n-o)*(l-a)+(a-r)*(n-s),f=(n-o)*(i-a)+(a-r)*(n-u);return{ta:c,tb:p,tc:d,td:f}}function Hg(e,t){const n=Ug(e,t);return Math.abs(n)<Wn}function Ii(e,t){return Da(Ce(e,es(e,t)))}function Wg(e,t){if(!Da(Ce(e,es(e,t))))return!1;const n=Ce(t[1],t[0]),a=Ce(e,t[0]);return!(wr(n,a)<0||ya(n)<ya(a))}function Jg(e,t){if(Math.abs(t[0].y-t[1].y)<Wn)return!1;let n,a;if(t[0].y<t[1].y?[a,n]=t:[n,a]=t,e.y<a.y||n.y<=e.y)return!1;const o=qg(t,[e,he(e.x+1,e.y)]);return!(!o||o.x<=e.x)}function Pi(e,t){if(t.find(a=>e.x===a.x&&e.y===a.y))return!0;const n=t.map((a,o)=>[a,o<t.length-1?t[o+1]:t[0]]).filter(a=>!La(a[0],a[1]));for(let a=0;a<n.length;a++){const o=n[a];if(Wg(e,o))return!0}return n.filter(a=>Jg(e,a)).length%2===1}function qg(e,t){if(Hg(Ce(e[0],e[1]),Ce(t[0],t[1])))return null;if(Ii(e[0],t))return Ai({},e[0]);if(Ii(e[1],t))return Ai({},e[1]);const n=((t[1].x-t[0].x)*(e[0].y-t[0].y)-(t[1].y-t[0].y)*(e[0].x-t[0].x))/2,a=((t[1].x-t[0].x)*(t[0].y-e[1].y)-(t[1].y-t[0].y)*(t[0].x-e[1].x))/2,o=n/(n+a);return 0<o&&o<1?he(e[0].x+(e[1].x-e[0].x)*o,e[0].y+(e[1].y-e[0].y)*o):null}function Zg(e,t){const n=t,a=1-n,o=Ne(e[0],a*a),r=Ne(e[1],2*n*a),s=Ne(e[2],n*n);return he(o.x+r.x+s.x,o.y+r.y+s.y)}function tr(e){return t=>Zg(e,t)}function Qg(e,t){const n=t,a=1-n,o=Ne(e[0],a*a*a),r=Ne(e[1],3*n*a*a),s=Ne(e[2],3*n*n*a),l=Ne(e[3],n*n*n);return he(o.x+r.x+s.x+l.x,o.y+r.y+s.y+l.y)}function nr(e){return t=>Qg(e,t)}function eb(e,t){const[n,a,o,r]=e,s=-n.x+3*a.x-3*o.x+r.x,l=3*n.x-6*a.x+3*o.x,u=-3*n.x+3*a.x,i=n.x-t,c=ab(s,l,u,i),p=c*c,d=p*c,f=1-c,h=f*f;return h*f*n.y+3*c*h*a.y+3*p*f*o.y+d*r.y}function Bi(e,t,n,a,o,r,s){if(Math.abs(e*t)<Wn)return R=>$a(n,a,R);const l=Kg(s),u=n,i=a,c=l(he((u.x-i.x)/2,(u.y-i.y)/2),!0),p=c.x*c.x,d=c.y*c.y,f=p/e/e+d/t/t,h=f>1?Math.sqrt(f):1,{x:y,y:k}=he(Math.abs(e)*h,Math.abs(t)*h),E=y*y,g=k*k,v=Ne(Ne(he(y*c.y/k,-k*c.x/y),Math.sqrt(Math.max(0,E*g-E*d-g*p)/(E*d+g*p))),o===r?-1:1),A=ee(l(v),Ne(ee(u,i),.5)),x=he((c.x-v.x)/y,(c.y-v.y)/k),I=he((-c.x-v.x)/y,(-c.y-v.y)/k),O=ht(x),T=(ht(I)-ht(x))%(2*Math.PI),L=!r&&0<T?T-2*Math.PI:r&&T<0?T+2*Math.PI:T;return R=>{if(R===0)return n;if(R===1)return a;{const B=O+L*R;return ee(l(he(y*Math.cos(B),k*Math.sin(B))),A)}}}function $a(e,t,n){return ee(e,Ne(Ce(t,e),n))}function tb(e,t){if(t<=1)return[e(0),e(1)];const n=[];let a=1/t;for(let o=0;o<=t;o++)n.push(e(a*o));return n}function nb(e){const[t,n,a,o,r,s]=e,l=t*o-n*a;return[o/l,-n/l,-a/l,t/l,(a*s-o*r)/l,-(t*s-n*r)/l]}function tl(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}function Ja(e){return e.reduce((t,n)=>tl(t,n),ot)}function kr(e,t,n){return e*(1-n)+t*n}function fr(e,t,n){return he(kr(e.x,t.x,n),kr(e.y,t.y,n))}function ab(e,t,n,a){const o=ob(e,t,n,a);if(o.length===0)return 0;const r=rb(o,0,1);if(r===void 0)throw new Error("Error: Cannot resolve uniquely in 0 <= t <= 1.");return Math.max(Math.min(r,1),0)}function ob(e,t,n,a){if(fa(e))return zg(t,n,a);const o=(3*e*n-t*t)/(3*e*e),r=(2*t*t*t-9*e*t*n+27*e*e*a)/(27*e*e*e),s=-t/(3*e);if(fa(o)&&fa(r))return[s];const l=(27*r*r+4*o*o*o)/108;if(fa(l)){const u=Math.sign(r)*Math.pow(Math.abs(r)/2,.3333333333333333);return[-2*u+s,u+s]}else if(l>0){const u=Math.sqrt(l),i=-r/2+u,c=-r/2-u,p=Math.sign(i)*Math.pow(Math.abs(i),1/3),d=Math.sign(c)*Math.pow(Math.abs(c),1/3);return[p+d+s]}else{const u=-r/2,i=Math.sqrt(-l),c=Math.atan2(i,u),p=2*Math.pow(u*u+i*i,1/6),d=Math.cos(c/3),f=Math.cos((c+2*Math.PI)/3),h=Math.cos((c+4*Math.PI)/3),y=p*d+s,k=p*f+s,E=p*h+s;return[y,k,E]}}function rb(e,t,n){return e.find(a=>!!(t<=a&&a<=n||Li(a,t)||Li(a,n)))}function Li(e,t){return Math.abs(e-t)<Wn}function fa(e){return Math.abs(e)<Wn}function lt(e=-1/0,t=1/0,n){return Math.max(Math.min(n,t),e)}function va(e,t,n){return e===t?e:t<n?(n-t)%(t-e)+e:n<e?t-(e-n)%(t-e):n}function sb(e,t,n){const a=t-e,o=2*a;if(o===0)return e;const r=Math.abs(n-e)%o;return r<a?r+e:o-r+e}const la=e=>+e,gf={bezierSplitSize:10,ellipseSplitSize:20};function lb(e){if(e.length===8)return[e[0],la(e[1]),la(e[2]),la(e[3]),e[4]!=="0",e[5]!=="0",la(e[6]),la(e[7])];{const[t,...n]=e;return[t,...n.map(la)]}}function Xl(e){return xf(e).map(t=>lb(t))}function bf(e){return e.map(t=>t===!0?"1":t===!1?"0":t.toString()).join(" ")}function _f(e){return ub(Xl(e))}function ub(e){const t=[];let n=he(0,0),a=n,o=n,r=1;return e.forEach(s=>{switch(s[0]){case"M":{const l=he(s[1],s[2]);t.push({command:"M",segment:[l,l]}),n=l,o=l,r=1,a=l;break}case"m":{const l=he(s[1],s[2]);t.push({command:"m",segment:[l,l]}),n=l,a=l,o=l,r=1;break}case"L":{const l=a,u=he(s[1],s[2]);t.push({command:"L",segment:[l,u]}),n!=null||(n=u),o=u,r=1,a=u;break}case"l":{const l=a,u=ee(a,he(s[1],s[2]));t.push({command:"l",segment:[l,u]}),n!=null||(n=u),o=u,r=1,a=u;break}case"H":{const l=a,u=he(s[1],l.y);t.push({command:"H",segment:[l,u]}),o=u,r=1,a=u;break}case"h":{const l=a,u=he(s[1]+l.x,l.y);t.push({command:"h",segment:[l,u]}),o=u,r=1,a=u;break}case"V":{const l=a,u=he(l.x,s[1]);t.push({command:"V",segment:[l,u]}),o=u,r=1,a=u;break}case"v":{const l=a,u=he(l.x,s[1]+l.y);t.push({command:"v",segment:[l,u]}),o=u,r=1,a=u;break}case"Q":{const l=a,u=he(s[1],s[2]),i=he(s[3],s[4]);t.push({command:"Q",lerpFn:tr([l,u,i]),curve:!0}),o=u,r=2,a=i;break}case"q":{const l=a,u=ee(l,he(s[1],s[2])),i=ee(l,he(s[3],s[4]));t.push({command:"q",lerpFn:tr([l,u,i]),curve:!0}),o=u,r=2,a=i;break}case"T":{const l=a,u=r===2?er(o,l):l,i=he(s[1],s[2]);t.push({command:"T",lerpFn:tr([l,u,i]),curve:!0}),o=u,r=2,a=i;break}case"t":{const l=a,u=r===2?er(o,l):l,i=ee(l,he(s[1],s[2]));t.push({command:"t",lerpFn:tr([l,u,i]),curve:!0}),o=u,r=2,a=i;break}case"C":{const l=a,u=he(s[1],s[2]),i=he(s[3],s[4]),c=he(s[5],s[6]);t.push({command:"C",lerpFn:nr([l,u,i,c]),curve:!0}),o=i,r=3,a=c;break}case"c":{const l=a,u=ee(l,he(s[1],s[2])),i=ee(l,he(s[3],s[4])),c=ee(l,he(s[5],s[6]));t.push({command:"c",lerpFn:nr([l,u,i,c]),curve:!0}),o=i,r=3,a=c;break}case"S":{const l=a,u=r===3?er(o,l):l,i=he(s[1],s[2]),c=he(s[3],s[4]);t.push({command:"S",lerpFn:nr([l,u,i,c]),curve:!0}),o=i,r=3,a=c;break}case"s":{const l=a,u=r===3?er(o,l):l,i=ee(l,he(s[1],s[2])),c=ee(l,he(s[3],s[4]));t.push({command:"s",lerpFn:nr([l,u,i,c]),curve:!0}),o=i,r=3,a=c;break}case"A":{const l=a,u=s[1],i=s[2],c=s[4],p=s[5],d=s[3]/180*Math.PI,f=he(s[6],s[7]);t.push({command:"A",lerpFn:Bi(u,i,l,f,c,p,d),curve:!0}),o=f,r=1,a=f;break}case"a":{const l=a,u=s[1],i=s[2],c=s[4],p=s[5],d=s[3]/180*Math.PI,f=ee(l,he(s[6],s[7]));t.push({command:"a",lerpFn:Bi(u,i,l,f,c,p,d),curve:!0}),o=f,r=1,a=f;break}case"Z":case"z":{const l=a,u=n;t.push({command:s[0],segment:[l,u]}),o=u,r=1,a=u;break}}}),t}function ib(e,t=gf.bezierSplitSize){return _f(e).map(n=>({lerpFn:n.curve?n.lerpFn:a=>$a(n.segment[0],n.segment[1],a),length:Fg(n.curve?tb(n.lerpFn,t):n.segment)}))}function cb(e){return e.reduce((t,n)=>t+n.length,0)}function db(e,t){let n=Math.max(t,0);for(let a=0;a<e.length;a++){const o=e[a];if(n<o.length)return o.lerpFn(n/o.length);n-=o.length}return e.length>0?e[e.length-1].lerpFn(1):he(0,0)}function Sf(e){const t=[],n=[];let a,o=he(0,0),r=o,s=o,l=1;for(let u=0;u<e.length;u++){switch(a=e[u],a[0]){case"M":{o=r=s=he(a[1],a[2]),l=1;break}case"m":{o=r=s=ee(he(a[1],a[2]),r),l=1;break}case"L":{const i=he(a[1],a[2]);o!=null||(o=i),r=s=i,l=1;break}case"l":{const i=ee(he(a[1],a[2]),r);o!=null||(o=i),r=s=i,l=1;break}case"H":{r=s=he(a[1],r.y),l=1;break}case"h":{r=s=he(a[1]+r.x,r.y),l=1;break}case"V":{r=s=he(r.x,a[1]),l=1;break}case"v":{r=s=he(r.x,a[1]+r.y),l=1;break}case"Q":{s=he(a[1],a[2]),r=he(a[3],a[4]),l=2;break}case"q":{s=he(a[1]+r.x,a[2]+r.y),r=he(a[3]+r.x,a[4]+r.y),l=2;break}case"T":{s=l===2?$a(s,r,2):r,r=he(a[1],a[2]),l=2;break}case"t":{s=l===2?$a(s,r,2):r,r=he(a[1]+r.x,a[2]+r.y),l=2;break}case"C":{s=he(a[3],a[4]),r=he(a[5],a[6]),l=3;break}case"c":{s=he(a[3]+r.x,a[4]+r.y),r=he(a[5]+r.x,a[6]+r.y),l=3;break}case"S":{s=l===3?$a(s,r,2):r,r=he(a[3],a[4]),l=3;break}case"s":{s=l===3?$a(s,r,2):r,r=he(a[3]+r.x,a[4]+r.y),l=3;break}case"A":{r=s=he(a[6],a[7]),l=1;break}case"a":{r=s=he(a[6]+r.x,a[7]+r.y),l=1;break}case"Z":case"z":{r=s=o,l=1;break}default:throw wf()}n.push(s),t.push(r)}return{points:t,controls:n}}function ar(e){return/Q|q|T|t|C|c|S|s|A|a/.test(e)}function fb(e){if(e.length<2)return e;const t=[],{points:n,controls:a}=Sf(e),o=e.length;let r,s,l=!1;for(let u=o-1;0<=u;u--)switch(r=e[u],s=n[u===0?o-1:u-1],r[0]){case"M":l&&(ar(t[t.length-1][0])?t.push(["Z"]):t[t.length-1]=["Z"],l=!1),t.push([r[0],s.x,s.y]);break;case"m":l&&(ar(t[t.length-1][0])?t.push(["z"]):t[t.length-1]=["z"],l=!1),u===0?t.push(["M",s.x,s.y]):t.push([r[0],-r[1],-r[2]]);break;case"L":l&&u===0&&(ar(t[t.length-1][0])?t.push(["Z"]):t[t.length-1]=["Z"],l=!1),t.push([r[0],s.x,s.y]);break;case"l":l&&u===0&&(ar(t[t.length-1][0])?t.push(["z"]):t[t.length-1]=["z"],l=!1),u===0?t.push(["L",s.x,s.y]):t.push([r[0],-r[1],-r[2]]);break;case"H":t.push([r[0],s.x]);break;case"h":t.push([r[0],-r[1]]);break;case"V":t.push([r[0],s.y]);break;case"v":t.push([r[0],-r[1]]);break;case"Q":{t.push([r[0],r[1],r[2],s.x,s.y]);break}case"q":{t.push([r[0],r[1]-r[3],r[2]-r[4],-r[3],-r[4]]);break}case"T":{const i=a[u];t.push(["Q",i.x,i.y,s.x,s.y]);break}case"t":{const i=n[u],c=a[u];t.push(["q",c.x-i.x,c.y-i.y,-r[1],-r[2]]);break}case"C":{t.push([r[0],r[3],r[4],r[1],r[2],s.x,s.y]);break}case"c":{t.push([r[0],r[3]-r[5],r[4]-r[6],r[1]-r[5],r[2]-r[6],-r[5],-r[6]]);break}case"S":{const i=a[u];t.push(["C",r[1],r[2],i.x,i.y,s.x,s.y]);break}case"s":{const i=n[u],c=a[u];t.push(["c",r[1]-r[3],r[2]-r[4],c.x-i.x,c.y-i.y,-r[3],-r[4]]);break}case"A":{t.push([r[0],r[1],r[2],r[3],r[4],!r[5],s.x,s.y]);break}case"a":{t.push([r[0],r[1],r[2],r[3],r[4],!r[5],-r[6],-r[7]]);break}case"Z":l=!0,t.push(["L",s.x,s.y]);break;case"z":{l=!0;const i=n[u];t.push(["l",s.x-i.x,s.y-i.y]);break}}return t.unshift(t.pop()),t}function Ri(e,t){return e.map(n=>{const a=[...n];switch(a[0]){case"H":a[1]+=t.x;break;case"V":a[1]+=t.y;break;case"A":a[6]+=t.x,a[7]+=t.y;break;default:if(a[0]===a[0].toUpperCase())for(let o=1;o<a.length-1;o+=2)a[o]+=t.x,a[o+1]+=t.y;break}return a})}function pb(e,t){return e.map(n=>{const a=[...n];switch(a[0]){case"H":case"h":a[1]*=t.x;break;case"V":case"v":a[1]*=t.y;break;case"A":case"a":a[1]*=Math.abs(t.x),a[2]*=Math.abs(t.y),t.x*t.y<0&&(a[5]=!a[5]),a[6]*=t.x,a[7]*=t.y;break;default:for(let o=1;o<a.length-1;o+=2)a[o]*=t.x,a[o+1]*=t.y;break}return a})}function mb(e){const t=e.some(a=>/H|V/.test(a[0])),{points:n}=Sf(t?e:[]);return e.map((a,o)=>{switch(a[0]){case"H":return["L",a[1],n[o].y];case"h":return["l",a[1],0];case"V":return["L",n[o].x,a[1]];case"v":return["l",0,a[1]];default:return a}})}function hb(e,t){const n=Math.sin(t),a=Math.cos(t);return mb(e).map(o=>{const r=[...o];switch(r[0]){case"A":case"a":{r[3]+=t*180/Math.PI;const s=r[6],l=r[7];r[6]=a*s-n*l,r[7]=n*s+a*l;break}default:for(let s=1;s<r.length-1;s+=2){const l=r[s],u=r[s+1];r[s]=a*l-n*u,r[s+1]=n*l+a*u}break}return r})}function yb(e,t=gf.bezierSplitSize){const n=Math.max(1,t);let a=[],o=1/n;return _f(e).forEach(r=>{if(!(r.command==="Z"||r.command==="z"))if(r.curve)for(let s=1;s<=n;s++)a.push(r.lerpFn(o*s));else a.push(r.segment[1])}),a}const ji=/M|m|L|l|H|h|V|v|C|c|S|s|Q|q|T|t|A|a|Z|z/g;function xf(e){const t=e.replace(ji," $& ").replace(/([^e])(-|\+)/g,"$1 $2").split(/,| /).filter(o=>o).flatMap(vb);let n="M";const a=[];for(let o=0;o<t.length;){const r=[];switch(t[o].match(ji)?(r.push(t[o]),n=r[0],o++):n.toUpperCase()!=="Z"&&r.push(n),r[0].toUpperCase()){case"Z":break;case"V":case"H":r.push(t[o]),o+=1;break;case"M":case"L":case"T":r.push(t[o],t[o+1]),o+=2;break;case"Q":case"S":r.push(t[o],t[o+1],t[o+2],t[o+3]),o+=4;break;case"C":r.push(t[o],t[o+1],t[o+2],t[o+3],t[o+4],t[o+5]),o+=6;break;case"A":r.push(t[o],t[o+1],t[o+2],t[o+3],t[o+4],t[o+5],t[o+6]),o+=7;break;default:throw wf()}a.push(r)}return a}function vb(e){const t=e.split(/\./);return t.length<=2?[e]:[`${t[0]}.${t[1]}`,...t.slice(2).map(n=>`0.${n}`)]}function gb(e){return`matrix(${e.join(",")})`}function bb(e){const t=e.split(")").map(n=>`${n})`).map(n=>_b(n));return Ja(t)}function _b(e){return/translateX/.test(e)?xb(e):/translateY/.test(e)?wb(e):/translate/.test(e)?Sb(e):/skewX/.test(e)?kb(e):/skewY/.test(e)?Eb(e):/scaleX/.test(e)?Mb(e):/scaleY/.test(e)?Ob(e):/scale/.test(e)?Cb(e):/rotate/.test(e)?Tb(e):/matrix/.test(e)?$b(e):[...ot]}function sn(e){return e.trim().replace(/,/g," ").split(/ +/).map(t=>la(t))}function Sb(e){const t=e.match(/translate\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:n.length===1?[1,0,0,1,n[0],0]:[1,0,0,1,n[0],n[1]]}function xb(e){const t=e.match(/translateX\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:[1,0,0,1,n[0],0]}function wb(e){const t=e.match(/translateY\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:[1,0,0,1,0,n[0]]}function kb(e){const t=e.match(/skewX\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:[1,0,Math.tan(n[0]*Math.PI/180),1,0,0]}function Eb(e){const t=e.match(/skewY\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:[1,Math.tan(n[0]*Math.PI/180),0,1,0,0]}function Cb(e){const t=e.match(/scale\((.+)\)/);if(!t||t.length<2)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:n.length===1?[n[0],0,0,n[0],0,0]:[n[0],0,0,n[1],0,0]}function Mb(e){const t=e.match(/scaleX\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:[n[0],0,0,1,0,0]}function Ob(e){const t=e.match(/scaleY\((.+)\)/);if(!t||t.length<1)return[...ot];const n=sn(t[1]);return n.length<1?[...ot]:[1,0,0,n[0],0,0]}function Tb(e){const t=e.match(/rotate\((.+)\)/);if(!t||t.length<2)return[...ot];const n=sn(t[1]);if(sn.length<1)return[...ot];const a=n[0]/180*Math.PI,o=Math.cos(a),r=Math.sin(a),s=[o,r,-r,o,0,0];return n.length>2?tl(tl([1,0,0,1,n[1],n[2]],s),[1,0,0,1,-n[1],-n[2]]):s}function $b(e){const t=e.match(/matrix\((.+)\)/);if(!t||t.length<2)return[...ot];const n=sn(t[1]);return n.length<5?[...ot]:n.slice(0,6)}function wf(){return new Error("Unexpected error")}const Ab=window.navigator.userAgent.toLowerCase();function Ib(){return Ab.indexOf("mac os x")!==-1}function Kn(e){return e.ctrlKey||e.metaKey}function tn(){return Ib()?"Command":"Ctrl"}function Pb(e,t){var n,a,o;Kn(e)?(n=t.ctrl)==null||n.call(t):e.shiftKey?(a=t.shift)==null||a.call(t):(o=t.plain)==null||o.call(t)}function gn(e){return{shift:e.shiftKey,ctrl:Kn(e),button:e.button}}function Oo(e){return{key:e.key,shift:e.shiftKey,ctrl:Kn(e)}}function Ni(e){return!e.shift&&!!e.ctrl&&(e.key==="v"||e.key==="c")}const kf=ha({size:{width:window.innerWidth,height:window.innerHeight}});window.addEventListener("resize",()=>{kf.size={width:window.innerWidth,height:window.innerHeight}});function Hl(){return{state:kf}}function Bb(e,t=!1){Ut(()=>{window.addEventListener("scroll",e,t)}),_a(()=>{window.removeEventListener("scroll",e,t)})}function Lb(e,t=!1){Ut(()=>{window.addEventListener("click",e,t)}),_a(()=>{window.removeEventListener("click",e,t)})}function Vo(e){Ut(()=>{window.addEventListener("mousemove",e)}),_a(()=>{window.removeEventListener("mousemove",e)})}function Do(e){Ut(()=>{window.addEventListener("mouseup",e),window.addEventListener("mouseleave",e)}),_a(()=>{window.removeEventListener("mouseup",e),window.removeEventListener("mouseleave",e)})}function Rb(e){Ut(()=>{window.addEventListener("keydown",e)}),_a(()=>{window.removeEventListener("keydown",e)})}function ts(e){let t=!1,n={x:0,y:0};const a=H({x:0,y:0}),o=H(),r=H("move");Vo(u=>{var d,f;if(!t||!o.value){const h={x:u.pageX,y:u.pageY},y=Ce(a.value,h);a.value=h,(d=e.onGlobalMove)==null||d.call(e,{base:n,p:h,d:y,...gn(u)});return}const i={x:r.value==="move-v"?0:u.movementX,y:r.value==="move-h"?0:u.movementY};if(ya(i)>200)return;const c=gn(u);o.value=ee(o.value,Ne(i,c.shift?.1:1)),a.value=o.value;const p={base:n,p:o.value,d:i,...c};(f=e.onGlobalMove)==null||f.call(e,p),e.onMove(p)});function s(){o.value=void 0,t=!1,document.exitPointerLock()}Do(u=>{var i;t&&(s(),(i=e.onUp)==null||i.call(e,u))});function l(){var u;t&&!document.pointerLockElement&&(t=!1,(u=e.onEscape)==null||u.call(e))}return document.addEventListener("pointerlockchange",l),_a(()=>{document.removeEventListener("pointerlockchange",l)}),{globalCurrent:b(()=>a.value),current:b(()=>o.value),motion:r,requestPointerLock(u,i="move"){n=a.value,r.value=i,o.value=a.value,u.preventDefault(),u.target.requestPointerLock(),t=!0},requestPointerLockFromElement(u,i="move"){n=a.value,r.value=i,o.value=a.value,u.requestPointerLock(),t=!0},exitPointerLock:s}}const ns=e=>(it("data-v-14983842"),e=e(),ct(),e),jb=["transform"],Nb=ns(()=>C("circle",{r:"2"},null,-1)),Vb=["transform"],Db=ns(()=>C("path",{d:"M20,0L10,-10L10,10z"},null,-1)),Fb=ns(()=>C("path",{d:"M-20,0L-10,-10L-10,10z"},null,-1)),Ub=[Db,Fb],Gb=ns(()=>C("g",{class:"stroke-text"},[C("line",{x1:"-10",x2:"10"}),C("line",{y1:"-10",y2:"10"})],-1)),Kb=[Gb],ka=13,zb=J({__name:"GlobalCursor",props:{p:{default:void 0},cursor:{default:"move"},rotate:{default:0}},setup(e){const t=e,n=Hl(),a=b(()=>{if(t.p)return{x:va(0,n.state.size.width,t.p.x),y:va(0,n.state.size.height,t.p.y)}}),o=H();let r=0;pt(()=>t.p,(i,c)=>{!c&&i?(o.value=i,clearTimeout(r)):c&&!i&&(r=setTimeout(()=>{o.value=void 0},200))});const s=b(()=>{if(o.value)return`translate(${o.value.x-ka}px, ${o.value.y-ka}px)`}),l=b(()=>a.value?`translate(${a.value.x-ka}px, ${a.value.y-ka}px)`:o.value?`translate(${o.value.x-ka}px, ${o.value.y-ka}px)`:void 0),u=b(()=>{switch(t.cursor){case"move":return[0,90];case"move-h":return[0];case"move-v":return[90]}return[]});return(i,c)=>m(l)?(_(),Se(Fl,{key:0,to:"body"},[(_(),M("svg",{class:et(["global-cursor",{fade:!e.p}]),style:st({transform:m(l)}),xmlns:"http://www.w3.org/2000/svg",viewBox:"-20 -20 40 40",stroke:"none"},[C("g",{transform:`rotate(${e.rotate})`,class:"stroke-text"},[Nb,(_(!0),M(ye,null,Pe(m(u),p=>(_(),M("g",{key:p,transform:`rotate(${p})`},Ub,8,Vb))),128))],8,jb)],6)),m(s)?(_(),M("svg",{key:0,class:"global-cursor",style:st({transform:m(s)}),xmlns:"http://www.w3.org/2000/svg",viewBox:"-20 -20 40 40"},Kb,4)):ce("",!0)])):ce("",!0)}});const Yb=Me(zb,[["__scopeId","data-v-14983842"]]),W={BOOLEAN:"BOOLEAN",SCALER:"SCALER",VECTOR2:"VECTOR2",TRANSFORM:"TRANSFORM",COLOR:"COLOR",TEXT:"TEXT",BONE:"BONE",OBJECT:"OBJECT",D:"D",STOP:"STOP",GENERICS:"GENERICS",INPUT:"INPUT",OUTPUT:"OUTPUT",UNKNOWN:"UNKNOWN"},Qe={UNIT:"UNIT",ARRAY:"ARRAY",UNIT_OR_ARRAY:"UNIT_OR_ARRAY"},Xb=[{key:"pad",value:0},{key:"reflect",value:1},{key:"repeat",value:2}],Hb=[{key:"userSpaceOnUse",value:0},{key:"objectBoundingBox",value:1}],Ef={SPREAD_METHOD:Xb,SPACE_UNITS:Hb};function To(e,t){var o;const n=Ef[e]??[],a=lt(0,n.length-1,Math.floor(t));return((o=n.find(r=>r.value===a))==null?void 0:o.key)??""}function Wb(e,t){const n=H(),a=b(e);function o(){return Object.keys(a.value).sort().join(",")}function r(){n.value=ze(t.value)}let s=o();return r(),zy(()=>{const l=o();s!==l&&(r(),s=l)}),{cache:n,updateCache:r}}function Jb(e){let t,n=!0;function a(){return n&&(t=e(),n=!1),t}function o(){n=!0}return{update:o,getValue:a}}function Cf(e,t,n=100){const a=new Map;function o(s){const l=e(s),u=a.get(l)??t(s);return a.delete(l),a.set(l,u),a.size>n&&a.delete(a.keys().next().value),u}function r(){a.clear()}return{getValue:o,clear:r}}function qb(e,t){let n={};function a(r){return r in n||(n[r]=t(e[r])),n[r]}function o(){n={}}return{getValue:a,clear:o}}let Zb=e=>crypto.getRandomValues(new Uint8Array(e)),Qb=(e,t,n)=>{let a=(2<<Math.log(e.length-1)/Math.LN2)-1,o=-~(1.6*a*t/e.length);return(r=t)=>{let s="";for(;;){let l=n(o),u=o;for(;u--;)if(s+=e[l[u]&a]||"",s.length===r)return s}}},e0=(e,t=21)=>Qb(e,t,Zb);const Vi="abcdefghijklmnopqrstuvwxyz",t0=e0(Vi+Vi.toUpperCase()+"0123456789-",12),We=()=>`b${t0()}`,Di=/\.[0-9]{3,}$/;function Fi(e){return Di.test(e)?e.replace(Di,t=>"."+`${parseInt(t.slice(1),10)+1}`.padStart(3,"0")):`${e}.001`}function qt(e,t){const n=new Map(t.map(o=>[o,!0]));if(!n.has(e))return e;let a=Fi(e);for(;n.has(a);)a=Fi(a);return a}function n0(e,t,n){const a=e.concat(),o=a[t];return!o||o.name===n?e:(a[t]={...o,name:qt(n,a.map(r=>r.name))},a)}function a0(e,t){if(t<=0||e.length-1<t)return e;const n=e.concat(),a=n[t-1];return n[t-1]=n[t],n[t]=a,n}function o0(e,t){if(t<0||e.length-1<=t)return e;const n=e.concat(),a=n[t+1];return n[t+1]=n[t],n[t]=a,n}function Er(e,t=!1){const n=[],a=new Set(Object.keys(e)),o=new Set,r={resolve(s){e[s]&&a.has(s)&&n.push(s),a.delete(s)},getDeps(s){if(o.has(s)){if(t)throw new Error("Circular dependency is detected.");return}return o.add(s),e[s]}};for(;a.size>0;)Mf(r,a.values().next().value);return n}function Mf(e,t){const n=e.getDeps(t);n&&Object.keys(n).forEach(a=>Mf(e,a)),e.resolve(t)}function r0(e,t,n){if(!e[t])return{path:[],processed:[t]};if(e[t][n])return{path:[t,n],processed:[t,n]};let a=[];const o=new Set([t]);let r=new Map(Object.keys(e[t]).map(s=>[s,[t]]));for(;r.size>0;){const s=new Map;for(const[l,u]of r){const i=e[l];if(!(!i||o.has(l)))if(o.add(l),i[n]){a=[...u,l,n],o.add(n),s.clear();break}else{const c=[...u,l];Object.keys(i).forEach(p=>r.set(p,c))}}r=s}return{path:a,processed:Array.from(o.values())}}function s0(e,t){const n=[],a=new Set(Object.keys(e)),o=new Set([t]),r={...e};delete r[t];for(const s of a){if(o.has(s))continue;const l=r0(r,s,t);l.path.length>0&&l.path.forEach((u,i)=>{i!==l.path.length-1&&n.push(u)}),l.processed.forEach(u=>{delete r[u],o.add(u)})}return n}function l0(e,t){return e.reduce((n,a)=>(n[a]=t,n),{})}function xn(e,t){return e.reduce((n,a)=>{const o=a[t];return n[o]=a,n},{})}function Sa(e,t){const n={};return e.forEach(a=>{n[a[t]]?n[a[t]].push(a):n[a[t]]=[a]}),n}function Of(e){return Object.keys(e).flatMap(t=>e[t])}function ke(e){return Object.keys(e).map(t=>e[t])}function Q(e,t){return Object.keys(e).reduce((n,a)=>(n[a]=t(e[a],a),n),{})}function tt(e,t){return Object.keys(t).reduce((n,a)=>(e[a]!==void 0&&(n[a]=e[a]),n),{})}function _t(e,t){return Je(e,(n,a)=>t[a]===void 0)}function Je(e,t){return Object.keys(e).reduce((n,a)=>(t(e[a],a)&&(n[a]=e[a]),n),{})}function u0(e,t,n){return ke({...xn(e,n),...xn(t,n)})}function i0(e,t,n,a=!1){const o=xn(e,n),r=xn(t,n);return ke(Je(o,(s,l)=>{var u;return s[n]===((u=r[l])==null?void 0:u[n])===a}))}function Fa(e,t,n=""){const a=e[t];return!a||!e[a.parentId]||n===a.parentId?[]:[...Fa(e,a.parentId,n),a.parentId]}function c0(e,t,n){const a=Fa(e,t),o=a.findIndex(l=>l===n);if(o!==-1)return[...a.slice(o),t];const r=Fa(e,n),s=r.findIndex(l=>l===t);return s!==-1?[...r.slice(s),n]:[t,n]}function Tf(e){return/\.r\.?/.test(e)?"r":/\.R\.?/.test(e)?"R":/\.l\.?/.test(e)?"l":/\.L\.?/.test(e)?"L":""}const Ui={"":"",r:"l",R:"L",l:"r",L:"R"};function nl(e){const t=Tf(e);return Ui[t]?e.replace(`.${t}`,`.${Ui[t]}`):e}function $f(e,t){const n=e.map(a=>a[t]).sort().reduce((a,o,r)=>(a[o]=r,a),{});return e.concat().sort((a,o)=>n[a[t]]-n[o[t]])}function Af(e){return e.reduce((t,n)=>d0(t,n),{})}function d0(e,t){return Object.keys(t).reduce((n,a)=>(n[a]?n[a]+=t[a]:n[a]=t[a],n),{...e})}function f0(e){return ie(ke(e).map(t=>({...t,id:We()})))}function Gi(e){const t=Object.keys(e);return t.length>0?e[t[0]]:void 0}function Cr(e,t,n){return{..._t(e,t),...n(tt(e,t))}}function p0(e,t){const n=Object.keys(e),a=Object.keys(t);return n.length!==a.length?!1:n.every(o=>e[o]===t[o])}function If(e,t,n=(a,o)=>a===o){if(!e)return t;if(!t)return e;const a=Object.keys(t).length>1;let o=!0;const r=Object.keys({...e,...t}).reduce((s,l)=>(n(e[l],t[l])&&!a||(o=o&&!!e[l]&&!!t[l]&&n(e[l],t[l]),s[l]=t[l]??e[l]),s),{});if(!o)return r}function Pf(e,t,n){return n?{...e,[t]:n}:_t(e,{[t]:!0})}function m0(e){return Array.from(new Set(e))}function h0(e){return{...e,id:We()}}function y0(e,t,n){const a=e[0];return a?a[t]:n}function v0(e,t=n=>!!n){const n=[],a=[];return e.forEach(o=>{t(o)?n.push(o):a.push(o)}),[n,a]}function $n(e,t){return e.reduce((n,a)=>(n[a]=t(a),n),{})}function Bf(e,t){const n=Object.entries(e),a=Object.entries(t);return n.length===a.length&&n.every(([o,r])=>r===t[o])}function Ki(e,t){return(e||t)&&!(e&&t)}function g0(e,t){if(t){const n={...e},a=e[t];if(a)return delete n[t],Object.entries(n).concat([[t,a]])}return Object.entries(e)}function b0(e,t=(n,a)=>n===a){const n=new Set;let a;return e.forEach((o,r)=>{!a||!t(a.item,o)?a={item:o,from:r}:a.from+1<r&&n.add(r-1)}),e.map((o,r)=>n.has(r)?void 0:o)}function _0(e){return Array.from(new Set(e.flatMap(n=>n?Object.keys(n):[]))).reduce((n,a)=>(b0(e.map(o=>o==null?void 0:o[a])).forEach((o,r)=>{o&&(n[r][a]=o)}),n),e.map(()=>({}))).map(n=>Object.keys(n).length===0?void 0:n)}function S0(e,t,n=!1){const a=Math.floor(1/t),o=e.filter((r,s)=>s%a===0);return n&&Number.isInteger(e.length*t)&&o.push(e[e.length-1]),o}function al(e){return e!=null}function Lf(e){return Je(e,al)}function Rf(e={},t=!1){const n=t?We():e.id??"";return{name:"",armatureId:"",nodes:[],...e,id:n}}function Wl(e={},t=!1){const n=t?We():e.id??"";return{name:"",nodes:[],...e,id:n}}function pr(e={},t=!1){const n=t?We():e.id??"";return{index:0,...e,id:n}}function as(e={},t=!1){const n=t?We():e.id??"";return{tag:"",attributes:{},children:[],...e,id:n}}function x0(e={},t=!1){const n=t?We():e.id??"";return{index:0,tag:"",...e,id:n}}function Jl(e={},t=!1){const n=t?We():e.id??"";return{armatureId:"",svgTree:as(),elements:[],viewBox:{x:0,y:0,width:400,height:400},...e,id:n}}function ve(e={}){return{translate:{x:0,y:0},origin:{x:0,y:0},rotate:0,scale:{x:1,y:1},...e}}function jf(e={},t=!1){const n=t?We():e.id??"";return{name:"",armatureId:"",keyframes:[],...e,id:n}}function zn(e={},t=!1){const n=t?We():e.id??"";return{name:"",transform:ve(),parentId:"",connected:!1,head:{x:0,y:0},tail:{x:0,y:0},inheritRotation:!0,inheritScale:!0,constraints:[],...e,id:n}}function ol(e={},t=!1){const n=t?We():e.id??"";return{name:"",transform:ve(),bones:[],...e,id:n}}function ie(e){return xn(e,"id")}function Os(e){return xn(e,"targetId")}function Mr(e,t){return Object.keys({...e,...t}).reduce((n,a)=>(n[a]={...e[a]??{},...t[a]??{}},n),{})}function Nf(e,t=!1){return e?t?!!e.head&&!!e.tail:!!e.head||!!e.tail:!1}const ql=1.1,yn=10;function zt(e,t){const n=Math.pow(10,-e);return Math.round(t*n)/n}function Ea(e,t){const n=Math.abs(Math.round(t)),a=Math.sign(t),o=n.toString().length;return o>=e?n*a:zt(o-e,t)}function Or(e,t){return Math.round(t/e)*e}function zi(e){return va(-Math.PI,Math.PI,e)}function w0(e,t){return e>0&&t<e-Math.PI?t+Math.PI*2:e<0&&t>e+Math.PI?t-Math.PI*2:t}function Vf(e,t){const n=zi(e),a=zi(t);return w0(n,a)-n}const k0=ve();function E0(e){return C0(e,k0)}function C0(e,t){return!(!La(e.translate,t.translate)||!La(e.scale,t.scale)||!La(e.origin,t.origin)||e.rotate!==t.rotate)}function Df(e){const t=Math.round(Math.log(e)/Math.log(ql));return t<5?10:t<8?20:t<11?50:100}function Ff(e,t=15){return rl(e,t)}function Uf(e,t=.1){return{x:rl(e.x,t),y:rl(e.y,t)}}function rl(e,t=1){return Math.round(e/t)*t}function M0(e){const t=e.width>0?e.x:e.x+e.width,n=e.height>0?e.y:e.y+e.height;return{x:t,y:n,width:Math.abs(e.width),height:Math.abs(e.height)}}function Zl(e){return ht(e.tail,e.head)/Math.PI*180}function Yi(e){return e.transform.rotate+Zl(e)}function $o(e){return ee(e.head,Ao(e))}function qa(e){return ht(e.tail,e.head)-Math.PI/2}function Ao(e){const t=qa(e);return wt(e.transform.translate,t)}function xa(e){const t=qa(e);return{toLocal:n=>wt(n,-t),toWorld:n=>wt(n,t)}}function Xi(e){const t=e.head.x-e.tail.x,n=e.head.y-e.tail.y;return t*t+n*n}function Ua(e,t,n={x:0,y:0}){return{x:n.x+(e.x-n.x)*t.x,y:n.y+(e.y-n.y)*t.y}}function O0(e){return{x:e.x===0?0:1/e.x,y:e.y===0?0:1/e.y}}function bn(e,t){return ee(wt(Ua(e,t.scale,t.origin),t.rotate/180*Math.PI,t.origin),t.translate)}function Gf(e,t){const n=ht(e.tail,e.head),a=wt(e.transform.translate,n-Math.PI/2),o=bn(e.head,ve({translate:a})),r=bn(e.tail,ve({...e.transform,translate:a,origin:e.head,scale:{x:1,y:1}})),s=bn(t,ve({...e.transform,translate:a,origin:e.head,scale:{x:1,y:1}}));if(La(o,r))return s;const l=es(s,[o,r]),u=Ce(l,o),i=Ce(s,l);return ee(ee(Ne(u,e.transform.scale.y),Ne(i,e.transform.scale.x)),o)}function T0(e,t){return bn(e,{...t,translate:{x:0,y:0}})}function $0(e,t){return{...bn(e,{...t,rotate:0}),width:e.width*t.scale.x,height:e.height*t.scale.y}}function A0(e){const t=e.rotate/180*Math.PI,n=Math.cos(t),a=Math.sin(t);return Ja([[1,0,0,1,e.translate.x,e.translate.y],[1,0,0,1,e.origin.x,e.origin.y],[n,a,-a,n,0,0],[e.scale.x,0,0,e.scale.y,0,0],[1,0,0,1,-e.origin.x,-e.origin.y]])}function I0(e){const t=e.x+e.width,n=e.y+e.height;return a=>!(t<a.x||n<a.y||a.x+a.width<e.x||a.y+a.height<e.y)}function os(e){const t=e.flatMap(l=>[l.x,l.x+l.width]),n=e.flatMap(l=>[l.y,l.y+l.height]),a=Math.min(...t),o=Math.max(...t),r=Math.min(...n),s=Math.max(...n);return{x:a,y:r,width:o-a,height:s-r}}function P0(e,t){return{x:e.x-t,y:e.y-t,width:e.width+t*2,height:e.height+t*2}}const B0={x:1,y:0},L0={x:1,y:1};function R0(e,t=0,n=1,a=1){return o=>{const r=o/360-1,s=o+t;return ve({rotate:s,translate:Ne(wt(B0,s*Math.PI/180),e*o/360*Math.pow(n,r)),scale:Ne(L0,Math.pow(a,r))})}}function j0(e,t,n=0){const a=360/e,o={x:t,y:0};return r=>{const s=r*a;return ve({translate:wt(o,(s+n)*Math.PI/180),rotate:s})}}function N0(e,t,n,a,o,r){const s=r?{x:(n-1)*e/2,y:(a-1)*t/2}:void 0,l=[...Array(a)].map((p,d)=>d*t),u=[...Array(n)].map((p,d)=>d*e),i=o*Math.PI/180,c=l.flatMap(p=>u.map(d=>ve({translate:wt(s?Ce({x:d,y:p},s):{x:d,y:p},i)})));return p=>c[p]}function Kf(e,t,n){const a=es(n,[{x:0,y:0},t]);if(e<=0||Da(a))return a;const o=ya(a),r={x:a.x/o,y:a.y/o},s=Math.round(o/e)*e;return Ne(r,s)}function zf(e,t,n){if(e<=0)return n;const a=wt(n,-t),o={x:Math.round(a.x/e)*e,y:Math.round(a.y/e)*e};return wt(o,t)}function V0(e,t,n){return wr(Ce(t,e),Ce(n,e))<0}function Hi(e,t,n){const a=Ce(t,e),o=Ce(n,e),r=ht(a),s=ht(o);return ee(e,wt(o,r+Math.PI-s))}function Fo(e){return`rgba(${e.r},${e.g},${e.b},${e.a})`}const D0=Cf(e=>`${e.h},${e.s}${e.v}`,e=>{const t=Za(e);return`rgb(${zt(-1,t.r)},${zt(-1,t.g)},${zt(-1,t.b)})`});function F0(e){return D0.getValue(e)}function Ts(e,t,n,a){const o=(a+e/60)%6;return n-n*t*Math.max(Math.min(o,4-o,1),0)}function Za(e){const t=va(0,360,e.h);return{r:lt(0,1,Ts(t,e.s,e.v,5))*255,g:lt(0,1,Ts(t,e.s,e.v,3))*255,b:lt(0,1,Ts(t,e.s,e.v,1))*255,a:e.a}}function Ql(e){return ve({translate:{x:e.s*100,y:e.v*100},rotate:e.h,scale:{x:e.a,y:1}})}function U0(e,t){return ve({translate:yf(e.translate,t.translate),rotate:(e.rotate+t.rotate)/2,scale:{x:(e.scale.x+t.scale.x)/2,y:1}})}function G0(e,t,n,a){const o=a[t.targetId];if(!o)return a;const r=K0(e,t,a),s=a[t.poleTargetId],l=$o(o);let u=s?Yf($o(s),r,t.smoothJoint?l:void 0):r;for(let i=0;i<t.iterations;i++)u=z0(l,u);return{...a,...ie(u.map((i,c)=>({...i,transform:ap(r[c].transform,i.transform,t.influence)})))}}function K0(e,t,n){return t.chainLength===0?[]:[...Fa(n,e).map(o=>n[o]),n[e]].slice(-t.chainLength)}function z0(e,t){if(t.length===0)return t;let n=e;const a=t.concat().reverse().map(r=>{const[s,l,u]=X0(n,r);return n=u,{...r,transform:{...r.transform,rotate:s,translate:l}}}).reverse(),o=Ce(Ao(t[0]),Ao(a[0]));return a.map(r=>({...r,transform:{...r.transform,translate:ee(r.transform.translate,xa(r).toLocal(o))}}))}function Y0(e){return ee(e.head,Ne(Ce(e.tail,e.head),e.transform.scale.y))}function X0(e,t){const n=xa(t),a=n.toWorld(t.transform.translate),o=ee(t.head,a),r=ee(Y0(t),a),s=ht(e,o)-ht(r,o),l=wt(r,s,o),u=ee(t.transform.translate,n.toLocal(Ce(e,l)));return[s/Math.PI*180,u,ee(t.head,n.toWorld(u))]}function Yf(e,t,n){if(t.length===0)return t;const a=t[0],o=ee(a.head,Ao(a));let r=1;if(n){const i=It(o,e)+It(e,n),c=t.reduce((p,d)=>p+It(d.head,d.tail)*d.transform.scale.y,0);r=Math.min(i/c,1)}const s=ht(e,o);let l=a,u={x:0,y:0};return t.map(i=>{const c=xa(i),p=c.toWorld(i.transform.translate),d=ee(i.head,p),f=ee(i.tail,p),h=s-ht(f,d),y=h/Math.PI*180,k={...i,transform:{origin:i.transform.origin,rotate:y,translate:ee(i.transform.translate,c.toLocal(u)),scale:{x:i.transform.scale.x,y:i.transform.scale.y*r}}};return l=k,u=Ce(wt(l.tail,h,l.head),l.tail),k})}function H0(e,t){return{...t,targetId:e[t.targetId]??t.targetId,poleTargetId:e[t.poleTargetId]??t.poleTargetId}}function W0(e={}){return{targetId:"",poleTargetId:"",iterations:20,chainLength:2,influence:1,...e}}function J0(e){return Af([e.targetId?{[e.targetId]:1}:{},e.poleTargetId?{[e.poleTargetId]:1}:{}])}const q0=Object.freeze(Object.defineProperty({__proto__:null,apply:G0,getDependentCountMap:J0,getOption:W0,immigrate:H0,straightToPoleTarget:Yf},Symbol.toStringTag,{value:"Module"}));function Z0(e,t,n,a){const o=a[e];if(!o||o.connected)return a;const r=xa(o);if(t.spaceType==="world"){const s=$o(o),l=Wi(t,s);return{...a,[e]:{...o,transform:{...o.transform,translate:r.toLocal(Ce(ee(s,l),o.head))}}}}else{const s=n[e];if(!s)return a;const l=s.transform.translate,u=Wi(t,l),i=r.toWorld(ee(l,u)),c=ee(s.head,i),p=a[o.parentId]?Gf(a[o.parentId],c):c,d=Ce(p,c);return{...a,[e]:{...o,transform:{...o.transform,translate:r.toLocal(ee(i,d))}}}}}function Wi(e,t){const n={x:lt(e.useMinX?e.minX:void 0,e.useMaxX?e.maxX:void 0,t.x),y:lt(e.useMinY?e.minY:void 0,e.useMaxY?e.maxY:void 0,t.y)};return Ne(Ce(n,t),e.influence)}function Q0(e,t){return t}function e_(e={}){return{spaceType:"world",influence:1,minX:0,maxX:0,minY:0,maxY:0,useMinX:!1,useMaxX:!1,useMinY:!1,useMaxY:!1,...e}}function t_(e){return{}}const n_=Object.freeze(Object.defineProperty({__proto__:null,apply:Z0,getDependentCountMap:t_,getOption:e_,immigrate:Q0},Symbol.toStringTag,{value:"Module"}));function a_(e,t,n,a){var r;const o=a[e];if(!o)return a;if(t.spaceType==="world"){const s=Zl(o);return{...a,[e]:{...o,transform:{...o.transform,rotate:Ji(t,o.transform.rotate-s)}}}}else if(t.spaceType==="local"){const s=Ji(t,n[e].transform.rotate);return{...a,[e]:{...o,transform:{...o.transform,rotate:o.inheritRotation?s+((r=a[o.parentId])==null?void 0:r.transform.rotate):s}}}}return a}function Ji(e,t){const a=lt(e.useMin?e.min:void 0,e.useMax?e.max:void 0,t)-t;return t+a*e.influence}function o_(e,t){return t}function r_(e={}){return{spaceType:"world",min:0,max:0,useMin:!1,useMax:!1,influence:1,...e}}function s_(e){return{}}const l_=Object.freeze(Object.defineProperty({__proto__:null,apply:a_,getDependentCountMap:s_,getOption:r_,immigrate:o_},Symbol.toStringTag,{value:"Module"}));function u_(e,t,n,a){const o=a[e];if(!o)return a;if(t.spaceType==="world"){const r=o.transform.scale,s=qi(t,r);return{...a,[e]:{...o,transform:{...o.transform,scale:ee(r,s)}}}}else{const r=n[e];if(!r)return a;const s=r.transform.scale,l=qi(t,s),u=o.inheritScale&&a[o.parentId]?a[o.parentId].transform.scale:{x:1,y:1};return{...a,[e]:{...o,transform:{...o.transform,scale:Ua(ee(s,l),u)}}}}}function qi(e,t){const n={x:lt(e.useMinX?e.minX:void 0,e.useMaxX?e.maxX:void 0,t.x),y:lt(e.useMinY?e.minY:void 0,e.useMaxY?e.maxY:void 0,t.y)};return Ne(Ce(n,t),e.influence)}function i_(e,t){return t}function c_(e={}){return{spaceType:"world",influence:1,minX:0,maxX:0,minY:0,maxY:0,useMinX:!1,useMaxX:!1,useMinY:!1,useMaxY:!1,...e}}function d_(e){return{}}const f_=Object.freeze(Object.defineProperty({__proto__:null,apply:u_,getDependentCountMap:d_,getOption:c_,immigrate:i_},Symbol.toStringTag,{value:"Module"}));function p_(e,t,n,a){var c,p,d,f,h;const o=a[t.targetId],r=a[e];if(!o||!r)return a;const s=r.inheritRotation?((c=a[r.parentId])==null?void 0:c.transform.rotate)??0:0,l=(t.targetSpaceType==="world"?Yi(o):((d=(p=n[t.targetId])==null?void 0:p.transform)==null?void 0:d.rotate)??0)*(t.invert?-1:1),u=t.ownerSpaceType==="world"?Yi(r):((h=(f=n[e])==null?void 0:f.transform)==null?void 0:h.rotate)??0,i=(l-u)*t.influence;return{...a,[e]:{...r,transform:{...r.transform,rotate:t.ownerSpaceType==="world"?u+i-Zl(r):u+i+s}}}}function m_(e,t){return{...t,targetId:e[t.targetId]??t.targetId}}function h_(e={}){return{targetSpaceType:"world",ownerSpaceType:"world",targetId:"",influence:1,invert:!1,...e}}function y_(e){return{[e.targetId]:1}}const v_=Object.freeze(Object.defineProperty({__proto__:null,apply:p_,getDependentCountMap:y_,getOption:h_,immigrate:m_},Symbol.toStringTag,{value:"Module"}));function g_(e,t,n,a){var p,d,f,h;const o=a[t.targetId],r=a[e];if(!o||!r)return a;const s=a[r.parentId]?Ao(a[r.parentId]):{x:0,y:0},l=Ua(t.targetSpaceType==="world"?$o(o):((d=(p=n[t.targetId])==null?void 0:p.transform)==null?void 0:d.translate)??{x:0,y:0},{x:t.invertX?-1:1,y:t.invertY?-1:1}),u=t.ownerSpaceType==="world"?$o(r):((h=(f=n[e])==null?void 0:f.transform)==null?void 0:h.translate)??{x:0,y:0},i=Ua(Ce(l,u),{x:t.copyX?t.influence:0,y:t.copyY?t.influence:0}),c=xa(r);return{...a,[e]:{...r,transform:{...r.transform,translate:t.ownerSpaceType==="world"?c.toLocal(Ce(ee(u,i),r.head)):ee(ee(u,i),s)}}}}function b_(e,t){return{...t,targetId:e[t.targetId]??t.targetId}}function __(e={}){return{targetSpaceType:"world",ownerSpaceType:"world",targetId:"",influence:1,copyX:!0,copyY:!0,invertX:!1,invertY:!1,...e}}function S_(e){return{[e.targetId]:1}}const x_=Object.freeze(Object.defineProperty({__proto__:null,apply:g_,getDependentCountMap:S_,getOption:__,immigrate:b_},Symbol.toStringTag,{value:"Module"}));function w_(e,t,n,a){var c,p,d,f,h;const o=a[t.targetId],r=a[e];if(!o||!r)return a;const s=((c=a[r.parentId])==null?void 0:c.transform.scale)??{x:1,y:1},l=t.targetSpaceType==="world"?o.transform.scale:((d=(p=n[t.targetId])==null?void 0:p.transform)==null?void 0:d.scale)??{x:1,y:1},u=t.ownerSpaceType==="world"?r.transform.scale:((h=(f=n[e])==null?void 0:f.transform)==null?void 0:h.scale)??{x:1,y:1},i=Ua(Ce({x:Math.pow(l.x,t.power),y:Math.pow(l.y,t.power)},u),{x:t.copyX?t.influence:0,y:t.copyY?t.influence:0});return{...a,[e]:{...r,transform:{...r.transform,scale:t.ownerSpaceType==="world"?ee(u,i):Ua(ee(u,i),s)}}}}function k_(e,t){return{...t,targetId:e[t.targetId]??t.targetId}}function E_(e={}){return{targetSpaceType:"world",ownerSpaceType:"world",targetId:"",influence:1,power:1,copyX:!0,copyY:!0,...e}}function C_(e){return{[e.targetId]:1}}const M_=Object.freeze(Object.defineProperty({__proto__:null,apply:w_,getDependentCountMap:C_,getOption:E_,immigrate:k_},Symbol.toStringTag,{value:"Module"}));function rs(e){switch(e){case"IK":return q0;case"LIMIT_LOCATION":return n_;case"LIMIT_ROTATION":return l_;case"LIMIT_SCALE":return f_;case"COPY_LOCATION":return x_;case"COPY_ROTATION":return v_;case"COPY_SCALE":return M_}}function O_(e,t,n,a){return rs(n.type).apply(a,n.option,e,t)}function T_(e,t,n,a){const o=t[a];return o?o.constraints.reduce((r,s)=>({...r,...O_(e,r,n[s],o.id)}),t):t}function $_(e,t,n=a=>a.id){return t.map(a=>({...a,id:n(a),option:A_(e,a.type,a.option)}))}function A_(e,t,n){return rs(t).immigrate(e,n)}function Xf(e,t=!1){const n=t?We():e.id??"";return{type:e.type,name:(e==null?void 0:e.name)??"",option:I_(e.type,e==null?void 0:e.option),id:n}}function I_(e,t={}){return rs(e).getOption(t)}function P_(e,t){const n=ie(e),a=Hf(n,t);return Er(Q(a,r=>Q(r,()=>!0))).map(r=>n[r])}function Hf(e,t){return Q(e,n=>Af(n.constraints.map(a=>B_(t[a])).concat(n.parentId?{[n.parentId]:1}:{})))}function B_(e){return rs(e.type).getDependentCountMap(e.option)}function L_(e){const t=e.head,n=qa(e),a=Math.cos(n),o=Math.sin(n),r=e.transform.rotate/180*Math.PI,s=Math.cos(r),l=Math.sin(r);return Ja([[1,0,0,1,t.x,t.y],[a,o,-o,a,0,0],[1,0,0,1,e.transform.translate.x,e.transform.translate.y],[s,l,-l,s,0,0],[e.transform.scale.x,0,0,e.transform.scale.y,0,0],[a,-o,o,a,0,0],[1,0,0,1,-t.x,-t.y]])}function Ga(e,t){return ve({scale:ee(e.scale,t.scale),rotate:e.rotate+t.rotate,translate:ee(e.translate,t.translate),origin:ee(e.origin,t.origin)})}function Wf(e,t){return ve({scale:Ce(e.scale,t.scale),rotate:e.rotate-t.rotate,translate:Ce(e.translate,t.translate),origin:Ce(e.origin,t.origin)})}function eu(e,t){return ve({scale:{x:e.scale.x*t.scale.x,y:e.scale.y*t.scale.y},rotate:e.rotate+t.rotate,translate:ee(e.translate,t.translate),origin:ee(e.origin,t.origin)})}function R_(e){return ve({scale:O0(e.scale),rotate:-e.rotate,translate:Ne(e.translate,-1),origin:Ne(e.origin,-1)})}function j_(e){return e.reduce((t,n)=>eu(t,n),ve())}function sl(e,t,n){const a=n.head?bn(e.head,t):e.head,o=n.tail?bn(e.tail,t):e.tail;return{...e,head:a,tail:o}}function wa(e,t){const n=j_(t),a=qa(e),o=wt(n.translate,a),r=bn(e.head,ve({translate:o})),s=bn(e.tail,ve({...n,translate:o,origin:e.head,scale:{x:1,y:1}}));return{...e,head:r,tail:ee(Ne(Ce(s,r),n.scale.y),r),transform:ve({scale:{x:n.scale.y===0?0:n.scale.x/n.scale.y,y:1}})}}function Zi(e,t=!1){const n=t?e.head:e.tail;return zn({head:n,tail:n,parentId:t?e.parentId:e.id,connected:t?e.connected:!0},!0)}function Tr(e,t){return e.find(n=>n.id===t)}function N_(e,t,n=!1){return e.filter(a=>a.parentId===t&&(!n||a.connected))}function Jf(e,t,n,a=!1){const o=Tr(e,t);if(!o||Object.keys(n).length===0)return{};let r={[t]:n};if(!a){if(n.head&&o.connected){const s=Tr(e,o.parentId);s&&(r={...Jf(e,s.id,{tail:!0},a),...r})}n.tail&&N_(e,o.id,!0).forEach(s=>{r[s.id]={head:!0}})}return r}function qf(e,t){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];return ke(t).reduce((a,o)=>{const r=wa(o,[o.transform]),s=Pi(r.head,n),l=Pi(r.tail,n);return(s||l)&&(a[o.id]=e1({head:s,tail:l}),s||delete a[o.id].head,l||delete a[o.id].tail),a},{})}function Zf(e){const t=wa(e,[e.transform]),n=t.head,a=t.tail,o=Math.min(n.x,a.x),r=Math.max(n.x,a.x),s=Math.min(n.y,a.y),l=Math.max(n.y,a.y);return{x:o,y:s,width:r-o,height:l-s}}function V_(e,t){if(!t.parentId&&!t.connected)return t;const n=Tr(e,t.parentId);return n?t.connected?{...t,head:n.tail}:t:{...t,connected:!1,parentId:""}}function mr(e){return e.reduce((t,n)=>{if(!n.parentId)return t;const a=Tr(e,n.parentId);return a?n.connected&&(t[n.id]={connected:La(a.tail,n.head)}):t[n.id]={connected:!1,parentId:""},t},{})}function Yn(e,t){const n=Object.keys(t).map(a=>{const o=[],r=wa(e[a],[e[a].transform]);return t[a].head&&o.push(r.head),t[a].tail&&o.push(r.tail),o}).flat();return vf(n)}function tu(e){const t=Object.keys(e).map(n=>wa(e[n],[e[n].transform]).head);return vf(t)}function nu(e){const t=[],n=Object.keys(e).reduce((a,o)=>{const r=e[o];return!r.parentId||!e[r.parentId]?t.push(r):a[r.parentId]?a[r.parentId].push(r):a[r.parentId]=[r],a},{});return t.map(a=>({...a,children:Qf(n,a.id)}))}function Qf(e,t){var n;return((n=e[t])==null?void 0:n.map(a=>({...a,children:Qf(e,a.id)})))??[]}function au(e,t){return P_(ke(e),t).reduce((n,a)=>ep(e,n,t,a.id),{})}function ep(e,t,n,a){if(t[a])return t;let o=t;const r=e[a];return r.parentId?(o[r.parentId]||(o={...o,...ep(e,o,n,r.parentId)}),o={...o,[a]:D_(o[r.parentId],r)}):o={...o,[a]:r},o={...o,...T_(e,o,n,a)},o}function D_(e,t){const n=xa(t),a=t.connected?{x:0,y:0}:t.transform.translate,o=ee(t.head,n.toWorld(a)),r=Gf(e,o),s=Ce(r,o);return{...t,transform:{translate:ee(a,n.toLocal(s)),rotate:t.inheritRotation?t.transform.rotate+e.transform.rotate:t.transform.rotate,scale:t.inheritScale?{x:t.transform.scale.x*e.transform.scale.x,y:t.transform.scale.y*e.transform.scale.y}:t.transform.scale,origin:{x:0,y:0}}}}function tp(e){return e.map(t=>{const{children:n,...a}=t;return a}).concat(e.flatMap(t=>tp(t.children)))}function F_(e,t){return ie(np(nu(e),t))}function np(e,t){return e.flatMap(n=>{if(Nf(t[n.id])){const{children:a,...o}=n;return[o]}else return np(n.children,t)})}function ap(e,t,n){return ve({scale:fr(e.scale,t.scale,n),rotate:kr(e.rotate,t.rotate,n),origin:fr(e.origin,t.origin,n),translate:fr(e.translate,t.translate,n)})}function ou(e,t,n,a={}){const o=Q(ie(t),s=>$_(e,s.constraints.map(l=>n[l]),l=>a.resetConstraintId?We():l.id));return{bones:t.map(s=>({...s,parentId:e[s.parentId]??s.parentId,constraints:o[s.id].map(l=>l.id)})),constraints:ke(o).flat()}}function op(e,t,n){const a=Q(e,()=>We()),o=Object.values(a).reduce((s,l)=>(s[l]=!0,s),{}),r=ou(a,ke(Q(e,s=>{const l={...s,id:a[s.id],name:qt(s.name,n)};return n.push(l.name),l})).sort((s,l)=>s.name>=l.name?1:-1),t,{resetConstraintId:!0});return{bones:r.bones.map(s=>!s.parentId||o[s.parentId]?s:{...s,connected:!1}),createdConstraints:r.constraints}}function U_(e,t,n){const a=Object.keys(e).reduce((i,c)=>(i[e[c].name]=c,i),{}),o={},r={};n.forEach(i=>{if(K_(e,i)){const c=nl(e[i].name);a[c]?o[i]=a[c]:o[i]=We(),r[i]=c}});const s=Object.keys(o).map(i=>{const c=e[i],p=r[i],d=Fa(e,c.id);return zn({...z_(c,d[0]?e[d[0]].tail:c.head),id:o[i],name:p})}),l=ou(G_({...e,...ie(s)},!0),s,t,{resetConstraintId:!0}),u=mr(ke({...e,...ie(l.bones)}));return{bones:l.bones.map(i=>u[i.id]?{...i,...u[i.id]}:i),createdConstraints:l.constraints}}function G_(e,t=!1){const n=Object.keys(e).reduce((a,o)=>(nl(e[o].name)!==e[o].name&&(a[nl(e[o].name)]=o),a),{});return Object.keys(e).reduce((a,o)=>{const r=n[e[o].name];return r?a[o]=r:t&&(a[o]=o),a},{})}function K_(e,t){return!(!e[t]||!e[t].name||!Tf(e[t].name)||Fa(e,t).length===0)}function z_(e,t){const n={x:Ce(t,e.head).x*2,y:0},a=ee(e.head,n),o={x:ee(ee(e.tail,n),Ne(Ce(e.head,e.tail),2)).x,y:e.tail.y};return{...e,head:a,tail:o}}function Y_(e,t){const n=nu(e[t]?{...e,[t]:{...e[t],parentId:""}}:e);return X_(tp(n.filter(a=>a.id!==t))).map(a=>a.id)}function X_(e){return $f(e,"name")}function rp(e,t,n,a){const o={},r=n.reduce((s,l)=>{const u=a(s.bones,s.constraints,l);return Object.keys(u.bones).forEach(i=>{o[i]=!0,s.bones[i]=u.bones[i]}),Object.keys(u.constraints).forEach(i=>{s.constraints[i]=u.constraints[i]}),s},{bones:{...e},constraints:{...t}});return{bones:tt(r.bones,o),constraints:tt(r.constraints,o)}}function H_(e,t,n=We){return rp(e,{},t,(a,o,r)=>({bones:W_(a,r,n),constraints:{}})).bones}function W_(e,t,n=We){const a=e[t];if(!a)return e;const[o,r]=J_(a,ke(e).map(s=>s.name),n);return{...ie(ke(e).filter(s=>s.parentId===t).map(s=>({...s,parentId:r.id}))),[o.id]:o,[r.id]:r}}function J_(e,t,n){const a=yf(e.head,e.tail);return[zn({...e,tail:a}),zn({...e,id:n(),name:qt(e.name,t),head:a,parentId:e.id,connected:!0,constraints:[],inheritRotation:!0,inheritScale:!0})]}function q_(e,t,n){return rp(e,t,n,Z_)}function Z_(e,t,n){const a=e[n];if(!a)return{bones:{},constraints:{}};const o=Je(Hf(e,t),s=>n in s),r=ou({[n]:a.parentId},ke(e).filter(s=>!!o[s.id]).map(s=>{if(s.parentId!==n||!s.connected)return s;const l=e[n];if(!l.parentId)return{...s,parentId:"",connected:!1};const u=e[l.parentId];return u?{...s,parentId:l.parentId,head:u.tail}:s}),t);return{bones:ie(r.bones),constraints:ie(r.constraints)}}function sp(e){return e.concat().sort((t,n)=>Xi(n)-Xi(t))}function Q_(e,t){const n=xa(e);if(!t)return o=>n.toLocal(o);const a=R_(t);return o=>n.toLocal(T0(o,a))}function e1(e){const t={};return e.head&&(t.head=!0),e.tail&&(t.tail=!0),t}function se(e={}){return{id:"",type:"scaler",data:{},inputs:{},position:{x:0,y:0},...e}}const S=Q(W,e=>({type:e,struct:Qe.UNIT})),St={createdInputs:{disabled:{value:!1},parent:{value:""},transform:{value:ve()},fill:{value:ve()},stroke:{value:ve()},"stroke-width":{value:1}},inputs:{disabled:{type:S.BOOLEAN,default:!1},parent:{type:S.OBJECT,default:""},transform:{type:S.TRANSFORM,default:ve()},fill:{type:S.COLOR,default:ve()},stroke:{type:S.COLOR,default:ve()},"stroke-width":{type:S.SCALER,default:1}},outputs:{object:S.OBJECT,parent:S.OBJECT},getComputation(e){return(t,n)=>({object:t.disabled?"":e({id:n.id,parent:t.parent,transform:t.transform,fill:t.fill,stroke:t.stroke,"stroke-width":t["stroke-width"]}),parent:t.parent})}};function ln(e){return e.find(t=>!!t&&t.type!==W.GENERICS)}function Xt(e,t){return e===void 0&&t===void 0||(e==null?void 0:e.type)===(t==null?void 0:t.type)&&(e==null?void 0:e.struct)===(t==null?void 0:t.struct)}function t1(e,t){return(n,a)=>{var o;return((o=t.find(r=>r.some(s=>s.key===n&&s.output===a)))==null?void 0:o.map(r=>({...r,id:e})))??void 0}}function ss(e,t,n,a=!1){const o=e.getTransform(t);return r=>r.map((s,l)=>{const u=e.cloneObject(t,{parent:n},`${n}_${l}`),i={...s,rotate:a?0:s.rotate};return e.setTransform(u,o?eu(o,i):i),u})}function lp(e,t){let n=0;return t.map((a,o)=>{const r=a.relative?n+a.offset:a.offset;return n+=a.offset,{id:`${e}_stop_${o}`,parent:e,attributes:{offset:r,"stop-color":a.color}}})}const n1={create(e={}){return{...se({inputs:{},...e}),type:"get_frame"}},data:{},inputs:{},outputs:{frame:S.SCALER,end_frame:S.SCALER},computation(e,t,n){const a=n.getFrameInfo();return{frame:a.currentFrame,end_frame:a.endFrame}},width:120,color:"#f0e68c",label:"Get Frame"},a1=Object.freeze(Object.defineProperty({__proto__:null,struct:n1},Symbol.toStringTag,{value:"Module"})),o1={create(e={}){return{...se({data:{value:0},inputs:{},...e}),type:"scaler"}},data:{value:{type:S.SCALER,default:0}},inputs:{},outputs:{value:S.SCALER},computation(e,t){return{value:t.data.value}},width:120,color:"#f0e68c",label:"Number"},r1=Object.freeze(Object.defineProperty({__proto__:null,struct:o1},Symbol.toStringTag,{value:"Module"})),s1={create(e={}){return{...se({inputs:{x:{value:0},y:{value:0}},...e}),type:"make_vector2"}},data:{},inputs:{x:{type:S.SCALER,default:0},y:{type:S.SCALER,default:0}},outputs:{vector2:S.VECTOR2},computation(e){return{vector2:e}},width:140,color:"#f0e68c",label:"Make Vector2"},l1=Object.freeze(Object.defineProperty({__proto__:null,struct:s1},Symbol.toStringTag,{value:"Module"})),u1={create(e={}){return{...se({inputs:{vector2:{value:{x:0,y:0}}},...e}),type:"break_vector2"}},data:{},inputs:{vector2:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{x:S.SCALER,y:S.SCALER},computation(e){return{x:e.vector2.x,y:e.vector2.y}},width:140,color:"#f0e68c",label:"Break Vector2"},i1=Object.freeze(Object.defineProperty({__proto__:null,struct:u1},Symbol.toStringTag,{value:"Module"})),c1={create(e={}){return{...se({inputs:{translate:{value:{x:0,y:0}},rotate:{value:0},scale:{value:{x:1,y:1}},origin:{value:{x:0,y:0}}},...e}),type:"make_transform"}},data:{},inputs:{translate:{type:S.VECTOR2,default:{x:0,y:0}},rotate:{type:S.SCALER,default:0},scale:{type:{type:W.VECTOR2,struct:Qe.UNIT,scale:.1},default:{x:1,y:1}},origin:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{transform:S.TRANSFORM},computation(e){return{transform:ve({translate:e.translate,rotate:e.rotate,scale:e.scale,origin:e.origin})}},width:160,color:"#f0e68c",label:"Make Transform"},d1=Object.freeze(Object.defineProperty({__proto__:null,struct:c1},Symbol.toStringTag,{value:"Module"})),f1={create(e={}){return{...se({inputs:{transform:{value:ve()}},...e}),type:"break_transform"}},data:{},inputs:{transform:{type:S.TRANSFORM,default:ve()}},outputs:{translate:S.VECTOR2,rotate:S.SCALER,scale:S.VECTOR2,origin:S.VECTOR2},computation(e){return{translate:e.transform.translate,rotate:e.transform.rotate,scale:e.transform.scale,origin:e.transform.origin}},width:160,color:"#f0e68c",label:"Break Transform"},p1=Object.freeze(Object.defineProperty({__proto__:null,struct:f1},Symbol.toStringTag,{value:"Module"})),m1={create(e={}){return{...se({inputs:{transform:{value:ve()},vector2:{value:{x:0,y:0}}},...e}),type:"apply_transform"}},data:{},inputs:{transform:{type:S.TRANSFORM,default:ve()},vector2:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{vector2:S.VECTOR2},computation(e){return{vector2:bn(e.vector2,e.transform)}},width:160,color:"#f0e68c",label:"Apply Transform"},h1=Object.freeze(Object.defineProperty({__proto__:null,struct:m1},Symbol.toStringTag,{value:"Module"})),y1={create(e={}){return{...se({data:{color:ve()},inputs:{},...e}),type:"color"}},data:{color:{type:S.COLOR,default:ve()}},inputs:{},outputs:{color:S.COLOR},computation(e,t){return{color:t.data.color}},width:120,color:"#f0e68c",label:"Color"},v1=Object.freeze(Object.defineProperty({__proto__:null,struct:y1},Symbol.toStringTag,{value:"Module"})),$s={type:W.SCALER,struct:Qe.UNIT,scale:.1},g1={create(e={}){return{...se({inputs:{h:{value:0},s:{value:0},v:{value:0},a:{value:1}},...e}),type:"make_color"}},data:{},inputs:{h:{type:S.SCALER,default:0},s:{type:$s,default:0},v:{type:$s,default:0},a:{type:$s,default:1}},outputs:{color:S.COLOR},computation(e){return{color:Ql({...e})}},width:140,color:"#f0e68c",label:"Make Color"},b1=Object.freeze(Object.defineProperty({__proto__:null,struct:g1},Symbol.toStringTag,{value:"Module"})),_1={create(e={}){return{...se({inputs:{color:{value:ve()}},...e}),type:"break_color"}},data:{},inputs:{color:{type:S.COLOR,default:ve()}},outputs:{h:S.SCALER,s:S.SCALER,v:S.SCALER,a:{type:W.SCALER,struct:Qe.UNIT,scale:.1}},computation(e){return{...eo(e.color)}},width:140,color:"#f0e68c",label:"Break Color"},S1=Object.freeze(Object.defineProperty({__proto__:null,struct:_1},Symbol.toStringTag,{value:"Module"})),x1={create(e={}){return{...se({inputs:{a:{value:void 0},b:{value:void 0}},...e}),type:"add_generics"}},data:{},inputs:{a:{type:S.GENERICS,default:void 0},b:{type:S.GENERICS,default:void 0}},outputs:{value:S.GENERICS},computation(e,t){var a;const n=(a=this.getOutputType)==null?void 0:a.call(this,t,"value");return{value:w1(n)(e.a,e.b)}},width:100,color:"#4169e1",textColor:"#fff",label:"a + b",getOutputType(e,t){switch(t){case"value":return ln([e.inputs.a.genericsType,e.inputs.b.genericsType])??S.GENERICS;default:return S.GENERICS}},genericsChains:[[{key:"a"},{key:"b"},{key:"value",output:!0}]],getErrors(e){const t=ln([e.inputs.a.genericsType,e.inputs.b.genericsType]);if(t)switch(t.type){case W.SCALER:case W.VECTOR2:case W.TRANSFORM:case W.COLOR:case W.TEXT:case W.D:return;default:return["invalid type to operate"]}}};function w1(e){if(!e)return Qi;if(e.struct===Qe.ARRAY)return k1;switch(e.type){case W.SCALER:return E1;case W.VECTOR2:return C1;case W.TRANSFORM:return M1;case W.COLOR:return O1;case W.TEXT:return T1;case W.D:return $1;default:return Qi}}function Qi(){}function k1(e=[],t=[]){return e.concat(t)}function E1(e=0,t=0){return e+t}const ll={x:0,y:0};function C1(e=ll,t=ll){return ee(e,t)}const $r=ve({scale:ll});function M1(e=$r,t=$r){return Ga(e,t)}function O1(e=$r,t=$r){return U0(e,t)}function T1(e="",t=""){return e+t}function $1(e=[],t=[]){return e.concat(t)}const A1=Object.freeze(Object.defineProperty({__proto__:null,struct:x1},Symbol.toStringTag,{value:"Module"})),I1={create(e={}){return{...se({inputs:{a:{value:void 0},b:{value:void 0}},...e}),type:"sub_generics"}},data:{},inputs:{a:{type:S.GENERICS,default:void 0},b:{type:S.GENERICS,default:void 0}},outputs:{value:S.GENERICS},computation(e,t){var a;const n=(a=this.getOutputType)==null?void 0:a.call(this,t,"value");return{value:P1(n)(e.a,e.b)}},width:100,color:"#4169e1",textColor:"#fff",label:"a - b",getOutputType(e,t){switch(t){case"value":return ln([e.inputs.a.genericsType,e.inputs.b.genericsType])??S.GENERICS;default:return S.GENERICS}},genericsChains:[[{key:"a"},{key:"b"},{key:"value",output:!0}]],getErrors(e){const t=ln([e.inputs.a.genericsType,e.inputs.b.genericsType]);if(t){if(t.struct!==Qe.UNIT)return["invalid type to operate"];switch(t.type){case W.SCALER:case W.VECTOR2:case W.TRANSFORM:return;default:return["invalid type to operate"]}}}};function P1(e){if(!e||e.struct===Qe.ARRAY)return As;switch(e.type){case W.SCALER:return L1;case W.VECTOR2:return B1;case W.TRANSFORM:return R1;default:return As}}function As(){}function B1(e=ul,t=ul){return Ce(e,t)}function L1(e=0,t=0){return e-t}const ul={x:0,y:0},ec=ve({scale:ul});function R1(e=ec,t=ec){return Wf(e,t)}const j1=Object.freeze(Object.defineProperty({__proto__:null,struct:I1},Symbol.toStringTag,{value:"Module"})),N1={create(e={}){return{...se({inputs:{a:{value:0},b:{value:1}},...e}),type:"multi_scaler"}},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.SCALER,default:1}},outputs:{value:S.SCALER},computation(e){return{value:e.a*e.b}},width:100,color:"#4169e1",textColor:"#fff",label:"a x b"},V1=Object.freeze(Object.defineProperty({__proto__:null,struct:N1},Symbol.toStringTag,{value:"Module"})),D1={create(e={}){return{...se({inputs:{a:{value:0},b:{value:1}},...e}),type:"divide_scaler"}},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.SCALER,default:1}},outputs:{value:S.SCALER},computation(e){return{value:e.a/(e.b===0?1:e.b)}},width:100,color:"#4169e1",textColor:"#fff",label:"a / b"},F1=Object.freeze(Object.defineProperty({__proto__:null,struct:D1},Symbol.toStringTag,{value:"Module"})),U1={create(e={}){return se({inputs:{a:{value:0},b:{value:1}},...e,type:"remainder"})},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.SCALER,default:1}},outputs:{value:S.SCALER},computation(e){return{value:e.a%(e.b===0?1:e.b)}},width:100,color:"#4169e1",textColor:"#fff",label:"a % b"},G1=Object.freeze(Object.defineProperty({__proto__:null,struct:U1},Symbol.toStringTag,{value:"Module"})),K1={create(e={}){return{...se({inputs:{rotate:{value:0}},...e}),type:"sin"}},data:{},inputs:{rotate:{type:S.SCALER,default:0}},outputs:{value:S.SCALER},computation(e){return{value:Math.sin(e.rotate*Math.PI/180)}},width:100,color:"#4169e1",textColor:"#fff",label:"Sin"},z1=Object.freeze(Object.defineProperty({__proto__:null,struct:K1},Symbol.toStringTag,{value:"Module"})),Y1={create(e={}){return{...se({inputs:{rotate:{value:0}},...e}),type:"cos"}},data:{},inputs:{rotate:{type:S.SCALER,default:0}},outputs:{value:S.SCALER},computation(e){return{value:Math.cos(e.rotate*Math.PI/180)}},width:100,color:"#4169e1",textColor:"#fff",label:"Cos"},X1=Object.freeze(Object.defineProperty({__proto__:null,struct:Y1},Symbol.toStringTag,{value:"Module"})),H1={create(e={}){return{...se({inputs:{rotate:{value:0},radius:{value:1}},...e}),type:"polar_coord"}},data:{},inputs:{rotate:{type:S.SCALER,default:0},radius:{type:S.SCALER,default:1}},outputs:{vector2:S.VECTOR2},computation(e){const t=e.rotate*Math.PI/180;return{vector2:{x:e.radius*Math.cos(t),y:e.radius*Math.sin(t)}}},width:140,color:"#4169e1",textColor:"#fff",label:"Polar Coord"},W1=Object.freeze(Object.defineProperty({__proto__:null,struct:H1},Symbol.toStringTag,{value:"Module"})),J1={create(e={}){return{...se({inputs:{vector2:{value:{x:1,y:0}}},...e}),type:"invert_polar_coord"}},data:{},inputs:{vector2:{type:S.VECTOR2,default:{x:1,y:0}}},outputs:{rotate:S.SCALER,radius:S.SCALER},computation(e){const t=ya(e.vector2);return{rotate:ht(e.vector2)*180/Math.PI,radius:t}},width:160,color:"#4169e1",textColor:"#fff",label:"Invert Polar Coord"},q1=Object.freeze(Object.defineProperty({__proto__:null,struct:J1},Symbol.toStringTag,{value:"Module"})),Z1={create(e={}){return{...se({inputs:{x:{value:0},t:{value:2}},...e}),type:"pow"}},data:{},inputs:{x:{type:S.SCALER,default:0},t:{type:S.SCALER,default:2}},outputs:{value:S.SCALER},computation(e){return{value:Math.pow(e.x,e.t)}},width:100,color:"#4169e1",textColor:"#fff",label:"x ^ t"},Q1=Object.freeze(Object.defineProperty({__proto__:null,struct:Z1},Symbol.toStringTag,{value:"Module"})),eS={create(e={}){return{...se({inputs:{vector2:{value:{x:0,y:0}},scale:{value:1}},...e}),type:"scale_vector2"}},data:{},inputs:{vector2:{type:S.VECTOR2,default:{x:0,y:0}},scale:{type:S.SCALER,default:1}},outputs:{vector2:S.VECTOR2},computation(e){return{vector2:Ne(e.vector2,e.scale)}},width:140,color:"#4169e1",textColor:"#fff",label:"Scale Vector2"},tS=Object.freeze(Object.defineProperty({__proto__:null,struct:eS},Symbol.toStringTag,{value:"Module"})),nS={create(e={}){return{...se({inputs:{a:{value:{x:0,y:0}},b:{value:{x:0,y:0}}},...e}),type:"distance"}},data:{},inputs:{a:{type:S.VECTOR2,default:{x:0,y:0}},b:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{distance:S.SCALER},computation(e){return{distance:It(e.a,e.b)}},width:140,color:"#f0e68c",label:"Distance"},aS=Object.freeze(Object.defineProperty({__proto__:null,struct:nS},Symbol.toStringTag,{value:"Module"})),oS={create(e={}){return{...se({inputs:{vector2:{value:{x:0,y:0}},rotate:{value:0},origin:{value:{x:0,y:0}}},...e}),type:"rotate_vector2"}},data:{},inputs:{vector2:{type:S.VECTOR2,default:{x:0,y:0}},rotate:{type:S.SCALER,default:0},origin:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{vector2:S.VECTOR2},computation(e){return{vector2:wt(e.vector2,e.rotate*Math.PI/180,e.origin)}},width:140,color:"#f0e68c",label:"Rotate Vector2"},rS=Object.freeze(Object.defineProperty({__proto__:null,struct:oS},Symbol.toStringTag,{value:"Module"})),sS={create(e={}){return{...se({inputs:{a:{value:void 0},b:{value:void 0},alpha:{value:0}},...e}),type:"lerp_generics"}},data:{},inputs:{a:{type:S.GENERICS,default:void 0},b:{type:S.GENERICS,default:void 0},alpha:{type:{type:W.SCALER,struct:Qe.UNIT,scale:.1},default:0}},outputs:{value:S.GENERICS},computation(e,t){var a;const n=(a=this.getOutputType)==null?void 0:a.call(this,t,"value");return{value:lS(n)(e.a,e.b,lt(0,1,e.alpha))}},width:140,color:"#4169e1",textColor:"#fff",label:"Lerp Number",getOutputType(e,t){switch(t){case"value":return ln([e.inputs.a.genericsType,e.inputs.b.genericsType])??S.GENERICS;default:return S.GENERICS}},genericsChains:[[{key:"a"},{key:"b"},{key:"value",output:!0}]],getErrors(e){const t=ln([e.inputs.a.genericsType,e.inputs.b.genericsType]);if(t){if(t.struct!==Qe.UNIT)return["invalid type to operate"];switch(t.type){case W.SCALER:case W.VECTOR2:case W.TRANSFORM:case W.COLOR:return;default:return["invalid type to operate"]}}}};function lS(e){if(!e||e.struct===Qe.ARRAY)return Is;switch(e.type){case W.SCALER:return uS;case W.VECTOR2:return iS;case W.TRANSFORM:case W.COLOR:return cS;default:return Is}}function Is(){}function uS(e=0,t=0,n){return kr(e,t,n)}const tc={x:0,y:0};function iS(e=tc,t=tc,n){return fr(e,t,n)}const nc=ve();function cS(e=nc,t=nc,n){return ap(e,t,n)}const dS=Object.freeze(Object.defineProperty({__proto__:null,struct:sS},Symbol.toStringTag,{value:"Module"})),fS={create(e={}){return{...se({inputs:{number:{value:0},from:{value:0},to:{value:1},loop:{value:!1}},...e}),type:"clamp"}},data:{},inputs:{number:{type:S.SCALER,default:0},from:{type:S.SCALER,default:0},to:{type:S.SCALER,default:1},loop:{type:S.BOOLEAN,default:!1}},outputs:{value:S.SCALER},computation(e){return{value:e.loop?va(e.from,e.to,e.number):lt(e.from,e.to,e.number)}},width:140,color:"#4169e1",textColor:"#fff",label:"Clamp"},pS=Object.freeze(Object.defineProperty({__proto__:null,struct:fS},Symbol.toStringTag,{value:"Module"})),mS={create(e={}){return{...se({inputs:{number:{value:0},from:{value:0},to:{value:1}},...e}),type:"round_trip"}},data:{},inputs:{number:{type:S.SCALER,default:0},from:{type:S.SCALER,default:0},to:{type:S.SCALER,default:1}},outputs:{value:S.SCALER},computation(e){return{value:sb(e.from,e.to,e.number)}},width:140,color:"#4169e1",textColor:"#fff",label:"Round Trip"},hS=Object.freeze(Object.defineProperty({__proto__:null,struct:mS},Symbol.toStringTag,{value:"Module"})),yS={create(e={}){return{...se({data:{bone:""},inputs:{},...e}),type:"get_bone"}},data:{bone:{type:S.BONE,default:""}},inputs:{},outputs:{transform:S.TRANSFORM,height:S.SCALER},computation(e,t,n){return n.getBoneSummary(t.data.bone)??{transform:ve(),height:0}},width:120,color:"#dc143c",textColor:"#fff",label:"Get Bone"},vS=Object.freeze(Object.defineProperty({__proto__:null,struct:yS},Symbol.toStringTag,{value:"Module"})),gS={create(e={}){return{...se({data:{object:""},inputs:{},...e}),type:"get_object"}},data:{object:{type:S.OBJECT,default:""}},inputs:{},outputs:{object:S.OBJECT},computation(e,t,n){return{object:t.data.object}},width:120,color:"#dc143c",textColor:"#fff",label:"Get Object"},bS=Object.freeze(Object.defineProperty({__proto__:null,struct:gS},Symbol.toStringTag,{value:"Module"})),_S={create(e={}){return{...se({inputs:{object:{value:""},index:{value:0}},...e}),type:"get_child"}},data:{},inputs:{object:{type:S.OBJECT,default:""},index:{type:S.SCALER,default:0}},outputs:{child:S.OBJECT},computation(e,t,n){const a=Math.floor(e.index);return e.object?{child:n.getChildId(e.object,a)??""}:{child:""}},width:120,color:"#dc143c",textColor:"#fff",label:"Get Child"},SS=Object.freeze(Object.defineProperty({__proto__:null,struct:_S},Symbol.toStringTag,{value:"Module"})),xS={create(e={}){return{...se({inputs:{object:{value:""}},...e}),type:"get_transform"}},data:{},inputs:{object:{type:S.OBJECT,default:""}},outputs:{transform:S.TRANSFORM},computation(e,t,n){return{transform:n.getTransform(e.object)??ve()}},width:140,color:"#dc143c",textColor:"#fff",label:"Get Transform"},wS=Object.freeze(Object.defineProperty({__proto__:null,struct:xS},Symbol.toStringTag,{value:"Module"})),kS={create(e={}){return{...se({inputs:{object:{value:""},transform:{value:ve()}},...e}),type:"set_transform"}},data:{},inputs:{object:{type:S.OBJECT,default:""},transform:{type:S.TRANSFORM,default:ve()}},outputs:{object:S.OBJECT},computation(e,t,n){return n.setTransform(e.object,e.transform),{object:e.object}},width:140,color:"#dc143c",textColor:"#fff",label:"Set Transform"},ES=Object.freeze(Object.defineProperty({__proto__:null,struct:kS},Symbol.toStringTag,{value:"Module"})),CS={create(e={}){return{...se({inputs:{object:{value:""},transform:{value:ve({scale:{x:0,y:0}})}},...e}),type:"add_transform"}},data:{},inputs:{object:{type:S.OBJECT,default:""},transform:{type:S.TRANSFORM,default:ve()}},outputs:{object:S.OBJECT},computation(e,t,n){const a=n.getTransform(e.object);return n.setTransform(e.object,a?Ga(a,e.transform):e.transform),{object:e.object}},width:140,color:"#dc143c",textColor:"#fff",label:"Add Transform"},MS=Object.freeze(Object.defineProperty({__proto__:null,struct:CS},Symbol.toStringTag,{value:"Module"})),OS={create(e={}){return{...se({inputs:{object:{value:""},color:{value:ve()}},...e}),type:"set_fill"}},data:{},inputs:{object:{type:S.OBJECT,default:""},color:{type:S.COLOR,default:ve()}},outputs:{object:S.OBJECT},computation(e,t,n){return n.setFill(e.object,e.color),{object:e.object}},width:120,color:"#dc143c",textColor:"#fff",label:"Set Fill"},TS=Object.freeze(Object.defineProperty({__proto__:null,struct:OS},Symbol.toStringTag,{value:"Module"})),$S={create(e={}){return{...se({inputs:{object:{value:""},color:{value:ve()}},...e}),type:"set_stroke"}},data:{},inputs:{object:{type:S.OBJECT,default:""},color:{type:S.COLOR,default:ve()}},outputs:{object:S.OBJECT},computation(e,t,n){return n.setStroke(e.object,e.color),{object:e.object}},width:120,color:"#dc143c",textColor:"#fff",label:"Set Stroke"},AS=Object.freeze(Object.defineProperty({__proto__:null,struct:$S},Symbol.toStringTag,{value:"Module"})),IS={create(e={}){return{...se({inputs:{object:{value:""},length:{value:0},max_length:{value:100}},...e}),type:"set_stroke_length"}},data:{},inputs:{object:{type:S.OBJECT,default:""},length:{type:S.SCALER,default:0},max_length:{type:S.SCALER,default:0}},outputs:{object:S.OBJECT},computation(e,t,n){return e.object?(n.setAttributes(e.object,{"stroke-dasharray":e.max_length.toString(),"stroke-dashoffset":e.max_length-e.length}),{object:e.object}):{object:""}},width:160,color:"#dc143c",textColor:"#fff",label:"Set Stroke Length"},PS=Object.freeze(Object.defineProperty({__proto__:null,struct:IS},Symbol.toStringTag,{value:"Module"})),BS={create(e={}){return{...se({inputs:{object:{value:""},fill_gradient:{value:""},stroke_gradient:{value:""}},...e}),type:"set_gradient"}},data:{},inputs:{object:{type:S.OBJECT,default:""},fill_gradient:{type:S.OBJECT,default:""},stroke_gradient:{type:S.OBJECT,default:""}},outputs:{object:S.OBJECT},computation(e,t,n){return n.setFill(e.object,e.fill_gradient),n.setStroke(e.object,e.stroke_gradient),{object:e.object}},width:140,color:"#dc143c",textColor:"#fff",label:"Set Gradient"},LS=Object.freeze(Object.defineProperty({__proto__:null,struct:BS},Symbol.toStringTag,{value:"Module"})),RS={create(e={}){return{...se({inputs:{object:{value:""},centered:{value:!1},x:{value:0},y:{value:0},width:{value:400},height:{value:400}},...e}),type:"set_viewbox"}},data:{},inputs:{object:{type:S.OBJECT,default:""},centered:{type:S.BOOLEAN,default:!1},x:{type:S.SCALER,default:0},y:{type:S.SCALER,default:0},width:{type:S.SCALER,default:400},height:{type:S.SCALER,default:400}},outputs:{object:S.OBJECT},computation(e,t,n){return n.setAttributes(e.object,{viewBox:{x:e.centered?e.x-e.width/2:e.x,y:e.centered?e.y-e.height/2:e.y,width:e.width,height:e.height}}),{object:e.object}},width:140,color:"#dc143c",textColor:"#fff",label:"Set Viewbox"},jS=Object.freeze(Object.defineProperty({__proto__:null,struct:RS},Symbol.toStringTag,{value:"Module"})),NS={create(e={}){return{...se({inputs:{disabled:{value:!1},object:{value:""}},...e}),type:"hide_object"}},data:{},inputs:{disabled:{type:S.BOOLEAN,default:!1},object:{type:S.OBJECT,default:""}},outputs:{object:S.OBJECT},computation(e,t,n){if(!e.disabled){const a=ve({scale:{x:0,y:1}});n.setStroke(e.object,a),n.setFill(e.object,a)}return{object:e.object}},width:120,color:"#dc143c",textColor:"#fff",label:"Hide Object"},VS=Object.freeze(Object.defineProperty({__proto__:null,struct:NS},Symbol.toStringTag,{value:"Module"})),DS={create(e={}){return{...se({inputs:{object:{value:""}},...e}),type:"clone_object"}},data:{},inputs:{object:{type:S.OBJECT,default:""}},outputs:{origin:S.OBJECT,clone:S.OBJECT},computation(e,t,n){const a=n.cloneObject(e.object,{},t.id);return{origin:e.object,clone:a}},width:140,color:"#dc143c",textColor:"#fff",label:"Clone Object"},FS=Object.freeze(Object.defineProperty({__proto__:null,struct:DS},Symbol.toStringTag,{value:"Module"})),US={create(e={}){return{...se({inputs:{object:{value:""}},...e}),type:"group_clone_object"}},data:{},inputs:{object:{type:S.OBJECT,default:""}},outputs:{origin:S.OBJECT,group:S.OBJECT,clone:S.OBJECT},computation(e,t,n){const a=n.createCloneGroupObject(e.object,{id:t.id}),o=ss(n,e.object,a),[r]=o([0].map(()=>ve()));return{origin:e.object,group:a,clone:r}},width:180,color:"#dc143c",textColor:"#fff",label:"Group Clone Object"},GS=Object.freeze(Object.defineProperty({__proto__:null,struct:US},Symbol.toStringTag,{value:"Module"})),KS={create(e={}){return{...se({inputs:{object:{value:""},rotate:{value:0},count:{value:4},radius:{value:100},fix_rotate:{value:!1}},...e}),type:"circle_clone_object"}},data:{},inputs:{object:{type:S.OBJECT,default:""},rotate:{type:S.SCALER,default:0},count:{type:S.SCALER,default:4},radius:{type:S.SCALER,default:100},fix_rotate:{type:S.BOOLEAN,default:!1}},outputs:{origin:S.OBJECT,group:S.OBJECT},computation(e,t,n){if(!e.object)return{origin:"",group:""};const a=Math.floor(e.count);if(a<=0)return{origin:e.object,group:""};const o=n.createCloneGroupObject(e.object,{id:t.id}),r=j0(a,e.radius,e.rotate);return ss(n,e.object,o,e.fix_rotate)([...Array(a)].map((l,u)=>r(u))),{origin:e.object,group:o}},width:180,color:"#dc143c",textColor:"#fff",label:"Circle Clone Object"},zS=Object.freeze(Object.defineProperty({__proto__:null,struct:KS},Symbol.toStringTag,{value:"Module"})),YS={create(e={}){return{...se({inputs:{object:{value:""},centered:{value:!1},rotate:{value:0},row:{value:3},column:{value:3},width:{value:50},height:{value:50}},...e}),type:"grid_clone_object"}},data:{},inputs:{object:{type:S.OBJECT,default:""},centered:{type:S.BOOLEAN,default:!1},rotate:{type:S.SCALER,default:0},row:{type:S.SCALER,default:3},column:{type:S.SCALER,default:3},width:{type:S.SCALER,default:50},height:{type:S.SCALER,default:50}},outputs:{origin:S.OBJECT,group:S.OBJECT},computation(e,t,n){if(!e.object)return{origin:"",group:""};const a=Math.floor(e.row),o=Math.floor(e.column);if(a<=0||o<=0)return{origin:e.object,group:""};const r=n.createCloneGroupObject(e.object,{id:t.id}),s=ss(n,e.object,r),l=N0(e.width,e.height,o,a,e.rotate,e.centered);return s([...Array(a*o)].map((u,i)=>l(i))),{origin:e.object,group:r}},width:180,color:"#dc143c",textColor:"#fff",label:"Grid Clone Object"},XS=Object.freeze(Object.defineProperty({__proto__:null,struct:YS},Symbol.toStringTag,{value:"Module"})),HS={create(e={}){return{...se({inputs:{object:{value:""},rotate:{value:0},max_rotate:{value:360*3},interval:{value:30},offset:{value:0},radius:{value:50},radius_grow:{value:1},scale_grow:{value:1},fix_rotate:{value:!1}},...e}),type:"tornado_clone_object"}},data:{},inputs:{object:{type:S.OBJECT,default:""},rotate:{type:S.SCALER,default:0},max_rotate:{type:S.SCALER,default:360*3},interval:{type:S.SCALER,default:60},offset:{type:S.SCALER,default:0},radius:{type:S.SCALER,default:50},radius_grow:{type:{type:W.SCALER,struct:Qe.UNIT,scale:.1},default:1},scale_grow:{type:{type:W.SCALER,struct:Qe.UNIT,scale:.1},default:1},fix_rotate:{type:S.BOOLEAN,default:!1}},outputs:{origin:S.OBJECT,group:S.OBJECT},computation(e,t,n){if(!e.object)return{origin:"",group:""};const a=Math.floor(e.max_rotate/e.interval);if(a<=0||e.interval<=0||e.radius<=0||e.radius_grow<=0||e.scale_grow<=0)return{origin:e.object,group:""};const o=n.createCloneGroupObject(e.object,{id:t.id}),r=R0(e.radius,e.rotate,e.radius_grow,e.scale_grow);return ss(n,e.object,o,e.fix_rotate)([...Array(a)].map((l,u)=>e.interval*u+e.offset).filter(l=>0<=l&&l<=e.max_rotate).map(r)),{origin:e.object,group:o}},width:200,color:"#dc143c",textColor:"#fff",label:"Tornado Clone Object"},WS=Object.freeze(Object.defineProperty({__proto__:null,struct:HS},Symbol.toStringTag,{value:"Module"})),JS={create(e={}){return{...se({data:{},inputs:{disabled:{value:!1},parent:{value:""},transform:{value:ve()}},...e}),type:"create_object_group"}},data:{},inputs:{disabled:{type:S.BOOLEAN,default:!1},parent:{type:S.OBJECT,default:""},transform:{type:S.TRANSFORM,default:ve()}},outputs:St.outputs,computation(e,t,n){return e.disabled?{object:"",parent:e.parent}:{object:n.createObject("g",{id:t.id,parent:e.parent,transform:e.transform,attributes:{}}),parent:e.parent}},width:140,color:"#dc143c",textColor:"#fff",label:"Create Group"},qS=Object.freeze(Object.defineProperty({__proto__:null,struct:JS},Symbol.toStringTag,{value:"Module"})),ZS={create(e={}){return{...se({data:{},inputs:{...St.createdInputs,centered:{value:!1},x:{value:0},y:{value:0},width:{value:100},height:{value:100}},...e}),type:"create_object_rect"}},data:{},inputs:{...St.inputs,centered:{type:S.BOOLEAN,default:!1},x:{type:S.SCALER,default:0},y:{type:S.SCALER,default:0},width:{type:S.SCALER,default:100},height:{type:S.SCALER,default:100}},outputs:St.outputs,computation(e,t,n){return St.getComputation(a=>n.createObject("rect",{...a,attributes:{x:e.centered?e.x-e.width/2:e.x,y:e.centered?e.y-e.height/2:e.y,width:e.width,height:e.height}}))(e,t)},width:140,color:"#dc143c",textColor:"#fff",label:"Create Rect"},QS=Object.freeze(Object.defineProperty({__proto__:null,struct:ZS},Symbol.toStringTag,{value:"Module"})),ex={create(e={}){return{...se({data:{},inputs:{...St.createdInputs,cx:{value:0},cy:{value:0},rx:{value:10},ry:{value:10}},...e}),type:"create_object_ellipse"}},data:{},inputs:{...St.inputs,cx:{type:S.SCALER,default:0},cy:{type:S.SCALER,default:0},rx:{type:S.SCALER,default:10},ry:{type:S.SCALER,default:10}},outputs:St.outputs,computation(e,t,n){return St.getComputation(a=>n.createObject("ellipse",{...a,attributes:{cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry}}))(e,t)},width:140,color:"#dc143c",textColor:"#fff",label:"Create Ellipse"},tx=Object.freeze(Object.defineProperty({__proto__:null,struct:ex},Symbol.toStringTag,{value:"Module"})),nx={create(e={}){return{...se({data:{},inputs:{...St.createdInputs,centered:{value:!1},x:{value:0},y:{value:0},dx:{value:0},dy:{value:0},text:{value:"TEXT"},"font-size":{value:10}},...e}),type:"create_object_text"}},data:{},inputs:{...St.inputs,centered:{type:S.BOOLEAN,default:!1},x:{type:S.SCALER,default:0},y:{type:S.SCALER,default:0},dx:{type:S.SCALER,default:0},dy:{type:S.SCALER,default:0},text:{type:S.TEXT,default:"TEXT"},"font-size":{type:S.SCALER,default:100}},outputs:St.outputs,computation(e,t,n){return St.getComputation(a=>n.createObject("text",{...a,attributes:{x:e.x,y:e.y,dx:e.dx,dy:e.dy,"font-size":e["font-size"],...e.centered?{"text-anchor":"middle","dominant-baseline":"middle"}:{}},text:e.text}))(e,t)},width:140,color:"#dc143c",textColor:"#fff",label:"Create Text"},ax=Object.freeze(Object.defineProperty({__proto__:null,struct:nx},Symbol.toStringTag,{value:"Module"})),ox={create(e={}){return{...se({data:{},inputs:{...St.createdInputs,d:{value:[]}},...e}),type:"create_object_path"}},data:{},inputs:{...St.inputs,d:{type:S.D,default:[]}},outputs:St.outputs,computation(e,t,n){return St.getComputation(a=>n.createObject("path",{...a,attributes:{d:e.d}}))(e,t)},width:140,color:"#dc143c",textColor:"#fff",label:"Create Path"},rx=Object.freeze(Object.defineProperty({__proto__:null,struct:ox},Symbol.toStringTag,{value:"Module"})),sx={create(e={}){return{...se({inputs:{disabled:{value:!1},parent:{value:""},relative:{value:!0},spread:{value:0},stop:{value:[]},from:{value:{x:0,y:0}},to:{value:{x:1,y:1}}},...e}),type:"create_linear_gradient"}},data:{},inputs:{disabled:{type:S.BOOLEAN,default:!1},parent:{type:S.OBJECT,default:""},relative:{type:S.BOOLEAN,default:!0},spread:{type:{type:W.SCALER,struct:Qe.UNIT,enumKey:"SPREAD_METHOD"},default:0},stop:{type:S.STOP,default:[]},from:{type:{type:W.VECTOR2,struct:Qe.UNIT,scale:.05},default:{x:0,y:0}},to:{type:{type:W.VECTOR2,struct:Qe.UNIT,scale:.05},default:{x:1,y:1}}},outputs:{gradient:S.OBJECT},computation(e,t,n){if(e.disabled)return{gradient:""};const a=n.createObject("linearGradient",{id:t.id,parent:e.parent,attributes:{id:t.id,x1:e.from.x,y1:e.from.y,x2:e.to.x,y2:e.to.y,gradientUnits:e.relative?"objectBoundingBox":"userSpaceOnUse",spreadMethod:To("SPREAD_METHOD",e.spread)}});return lp(a,e.stop).forEach(o=>{n.createObject("stop",o)}),{gradient:a}},width:180,color:"#dc143c",textColor:"#fff",label:"Linear Gradient"},lx=Object.freeze(Object.defineProperty({__proto__:null,struct:sx},Symbol.toStringTag,{value:"Module"})),ux={create(e={}){return{...se({inputs:{disabled:{value:!1},parent:{value:""},relative:{value:!0},spread:{value:0},stop:{value:[]},center:{value:{x:0,y:0}},radius:{value:1},focus:{value:{x:0,y:0}}},...e}),type:"create_radial_gradient"}},data:{},inputs:{disabled:{type:S.BOOLEAN,default:!1},parent:{type:S.OBJECT,default:""},relative:{type:S.BOOLEAN,default:!0},spread:{type:{type:W.SCALER,struct:Qe.UNIT,enumKey:"SPREAD_METHOD"},default:0},stop:{type:S.STOP,default:[]},center:{type:{type:W.VECTOR2,struct:Qe.UNIT,scale:.05},default:{x:0,y:0}},radius:{type:{type:W.SCALER,struct:Qe.UNIT,scale:.05},default:1},focus:{type:{type:W.VECTOR2,struct:Qe.UNIT,scale:.05},default:{x:0,y:0}}},outputs:{gradient:S.OBJECT},computation(e,t,n){if(e.disabled)return{gradient:""};const a=n.createObject("radialGradient",{id:t.id,parent:e.parent,attributes:{id:t.id,cx:e.center.x,cy:e.center.y,r:Math.max(e.radius,0),fx:e.focus.x,fy:e.focus.y,gradientUnits:To("SPACE_UNITS",e.relative?1:0),spreadMethod:To("SPREAD_METHOD",e.spread)}});return lp(a,e.stop).forEach(o=>{n.createObject("stop",o)}),{gradient:a}},width:180,color:"#dc143c",textColor:"#fff",label:"Radial Gradient"},ix=Object.freeze(Object.defineProperty({__proto__:null,struct:ux},Symbol.toStringTag,{value:"Module"})),cx={create(e={}){return{...se({inputs:{stop:{value:[]},relative:{value:!0},offset:{value:0},color:{value:ve()}},...e}),type:"make_stop"}},data:{},inputs:{stop:{type:S.STOP,default:[]},relative:{type:S.BOOLEAN,default:!0},offset:{type:{type:W.SCALER,struct:Qe.UNIT,scale:.1},default:0},color:{type:S.COLOR,default:ve()}},outputs:{stop:S.STOP},computation(e,t,n){return{stop:[...e.stop,{offset:e.offset,color:e.color,relative:e.relative}]}},width:140,color:"#8b008b",textColor:"#fff",label:"Make Stop"},dx=Object.freeze(Object.defineProperty({__proto__:null,struct:cx},Symbol.toStringTag,{value:"Module"})),fx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},p:{value:{x:0,y:0}}},...e}),type:"make_path_m"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"m":"M"}${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path M"},px=Object.freeze(Object.defineProperty({__proto__:null,struct:fx},Symbol.toStringTag,{value:"Module"})),mx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},p:{value:{x:0,y:0}}},...e}),type:"make_path_l"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"l":"L"}${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path L"},hx=Object.freeze(Object.defineProperty({__proto__:null,struct:mx},Symbol.toStringTag,{value:"Module"})),yx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},x:{value:0}},...e}),type:"make_path_h"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},x:{type:S.SCALER,default:0}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"h":"H"}${e.x}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path H"},vx=Object.freeze(Object.defineProperty({__proto__:null,struct:yx},Symbol.toStringTag,{value:"Module"})),gx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},y:{value:0}},...e}),type:"make_path_v"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},y:{type:S.SCALER,default:0}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"v":"V"}${e.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path V"},bx=Object.freeze(Object.defineProperty({__proto__:null,struct:gx},Symbol.toStringTag,{value:"Module"})),_x={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},c1:{value:{x:0,y:0}},p:{value:{x:0,y:0}}},...e}),type:"make_path_q"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},c1:{type:S.VECTOR2,default:{x:0,y:0}},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"q":"Q"}${e.c1.x},${e.c1.y} ${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path Q"},Sx=Object.freeze(Object.defineProperty({__proto__:null,struct:_x},Symbol.toStringTag,{value:"Module"})),xx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},p:{value:{x:0,y:0}}},...e}),type:"make_path_t"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"t":"T"}${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path T"},wx=Object.freeze(Object.defineProperty({__proto__:null,struct:xx},Symbol.toStringTag,{value:"Module"})),kx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},c1:{value:{x:0,y:0}},c2:{value:{x:0,y:0}},p:{value:{x:0,y:0}}},...e}),type:"make_path_c"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},c1:{type:S.VECTOR2,default:{x:0,y:0}},c2:{type:S.VECTOR2,default:{x:0,y:0}},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"c":"C"}${e.c1.x},${e.c1.y} ${e.c2.x},${e.c2.y} ${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path Q"},Ex=Object.freeze(Object.defineProperty({__proto__:null,struct:kx},Symbol.toStringTag,{value:"Module"})),Cx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},c1:{value:{x:0,y:0}},p:{value:{x:0,y:0}}},...e}),type:"make_path_s"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},c1:{type:S.VECTOR2,default:{x:0,y:0}},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"s":"S"}${e.c1.x},${e.c1.y} ${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path S"},Mx=Object.freeze(Object.defineProperty({__proto__:null,struct:Cx},Symbol.toStringTag,{value:"Module"})),Ox={create(e={}){return{...se({data:{},inputs:{d:{value:[]},relative:{value:!1},rx:{value:10},ry:{value:10},rotate:{value:0},"large-arc":{value:!1},sweep:{value:!1},p:{value:{x:0,y:0}}},...e}),type:"make_path_a"}},data:{},inputs:{d:{type:S.D,default:[]},relative:{type:S.BOOLEAN,default:!1},rx:{type:S.SCALER,default:1},ry:{type:S.SCALER,default:1},rotate:{type:S.SCALER,default:0},"large-arc":{type:S.BOOLEAN,default:!1},sweep:{type:S.BOOLEAN,default:!1},p:{type:S.VECTOR2,default:{x:0,y:0}}},outputs:{d:S.D},computation(e){return{d:[...e.d,`${e.relative?"a":"A"}${e.rx} ${e.ry} ${e.rotate} ${e["large-arc"]?1:0} ${e.sweep?1:0} ${e.p.x},${e.p.y}`]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path A"},Tx=Object.freeze(Object.defineProperty({__proto__:null,struct:Ox},Symbol.toStringTag,{value:"Module"})),$x={create(e={}){return{...se({data:{},inputs:{d:{value:[]}},...e}),type:"make_path_z"}},data:{},inputs:{d:{type:S.D,default:[]}},outputs:{d:S.D},computation(e){return{d:[...e.d,"Z"]}},width:140,color:"#fff5ee",textColor:"#000",label:"Make Path Z"},Ax=Object.freeze(Object.defineProperty({__proto__:null,struct:$x},Symbol.toStringTag,{value:"Module"})),Ix={create(e={}){return{...se({data:{},inputs:{d:{value:[]}},...e}),type:"get_path_length"}},data:{},inputs:{...St.inputs,d:{type:S.D,default:[]}},outputs:{length:S.SCALER},computation(e,t,n){return{length:n.getPathLength(e.d.join(" "))}},width:140,color:"#dc143c",textColor:"#fff",label:"Get Path Length"},Px=Object.freeze(Object.defineProperty({__proto__:null,struct:Ix},Symbol.toStringTag,{value:"Module"})),Bx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},distance:{value:0}},...e}),type:"get_path_point_at"}},data:{},inputs:{d:{type:S.D,default:[]},distance:{type:S.SCALER,default:0}},outputs:{vector2:S.VECTOR2},computation(e,t,n){return{vector2:n.getPathPointAt(e.d.join(" "),e.distance)}},width:140,color:"#dc143c",textColor:"#fff",label:"Get Path Point At"},Lx=Object.freeze(Object.defineProperty({__proto__:null,struct:Bx},Symbol.toStringTag,{value:"Module"})),Rx={create(e={}){return{...se({data:{},inputs:{d:{value:[]},transform:{value:ve()}},...e}),type:"transform_path"}},data:{},inputs:{d:{type:S.D,default:[]},transform:{type:S.TRANSFORM,default:ve()}},outputs:{d:S.D},computation(e){return{d:Ri(hb(pb(Ri(Xl(e.d.join(" ")),Ne(e.transform.origin,-1)),e.transform.scale),e.transform.rotate*Math.PI/180),ee(e.transform.origin,e.transform.translate)).map(bf)}},width:140,color:"#fff5ee",textColor:"#000",label:"Transform Path"},jx=Object.freeze(Object.defineProperty({__proto__:null,struct:Rx},Symbol.toStringTag,{value:"Module"})),Nx={create(e={}){return se({inputs:{d:{value:[]}},...e,type:"reverse_path"})},data:{},inputs:{d:{type:S.D,default:[]}},outputs:{d:S.D},computation(e){return{d:fb(Xl(e.d.join(" "))).map(bf)}},width:120,color:"#fff5ee",textColor:"#000",label:"Reverse Path"},Vx=Object.freeze(Object.defineProperty({__proto__:null,struct:Nx},Symbol.toStringTag,{value:"Module"})),Dx={create(e={}){return{...se({data:{},inputs:{a:{value:[]},b:{value:[]}},...e}),type:"join_path"}},data:{},inputs:{a:{type:S.D,default:[]},b:{type:S.D,default:[]}},outputs:{d:S.D},computation(e){return{d:e.a.concat(e.b)}},width:120,color:"#fff5ee",textColor:"#000",label:"Join Path"},Fx=Object.freeze(Object.defineProperty({__proto__:null,struct:Dx},Symbol.toStringTag,{value:"Module"})),Ux={create(e={}){return{...se({data:{},inputs:{disabled:{value:!1},parent:{value:""},relative:{value:!1}},...e}),type:"create_object_clip_path"}},data:{},inputs:{disabled:{type:S.BOOLEAN,default:!1},parent:{type:S.OBJECT,default:""},relative:{type:S.BOOLEAN,default:!1}},outputs:St.outputs,computation(e,t,n){return e.disabled?{object:"",parent:e.parent}:{object:n.createObject("clipPath",{id:t.id,parent:e.parent,attributes:{clipPathUnits:To("SPACE_UNITS",e.relative?1:0)}}),parent:e.parent}},width:160,color:"#dc143c",textColor:"#fff",label:"Create Clip Path"},Gx=Object.freeze(Object.defineProperty({__proto__:null,struct:Ux},Symbol.toStringTag,{value:"Module"})),Kx={create(e={}){return{...se({inputs:{object:{value:""},clip_path:{value:""}},...e}),type:"set_clip_path"}},data:{},inputs:{object:{type:S.OBJECT,default:""},clip_path:{type:S.OBJECT,default:""}},outputs:{object:S.OBJECT},computation(e,t,n){return n.setAttributes(e.object,{"clip-path":`url(#${e.clip_path})`}),n.setAttributes(e.clip_path,{id:e.clip_path}),{object:e.object}},width:140,color:"#dc143c",textColor:"#fff",label:"Set Clip Path"},zx=Object.freeze(Object.defineProperty({__proto__:null,struct:Kx},Symbol.toStringTag,{value:"Module"})),Yx={create(e={}){return{...se({inputs:{a:{value:0},b:{value:0}},...e}),type:"greater_than"}},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.OBJECT,default:0}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.a>e.b}},width:100,color:"#b0c4de",textColor:"#000",label:"a > b"},Xx=Object.freeze(Object.defineProperty({__proto__:null,struct:Yx},Symbol.toStringTag,{value:"Module"})),Hx={create(e={}){return{...se({inputs:{a:{value:0},b:{value:0}},...e}),type:"greater_than_or_equal"}},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.SCALER,default:0}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.a>=e.b}},width:100,color:"#b0c4de",textColor:"#000",label:"a >= b"},Wx=Object.freeze(Object.defineProperty({__proto__:null,struct:Hx},Symbol.toStringTag,{value:"Module"})),Jx={create(e={}){return{...se({inputs:{a:{value:0},b:{value:0}},...e}),type:"less_than"}},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.SCALER,default:0}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.a<e.b}},width:100,color:"#b0c4de",textColor:"#000",label:"a < b"},qx=Object.freeze(Object.defineProperty({__proto__:null,struct:Jx},Symbol.toStringTag,{value:"Module"})),Zx={create(e={}){return{...se({inputs:{a:{value:0},b:{value:0}},...e}),type:"less_than_or_equal"}},data:{},inputs:{a:{type:S.SCALER,default:0},b:{type:S.SCALER,default:0}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.a<=e.b}},width:100,color:"#b0c4de",textColor:"#000",label:"a <= b"},Qx=Object.freeze(Object.defineProperty({__proto__:null,struct:Zx},Symbol.toStringTag,{value:"Module"})),ew={create(e={}){return{...se({inputs:{number:{value:0},from:{value:0},to:{value:1}},...e}),type:"between"}},data:{},inputs:{number:{type:S.SCALER,default:0},from:{type:S.SCALER,default:0},to:{type:S.SCALER,default:1}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.from<=e.number&&e.number<=e.to}},width:120,color:"#b0c4de",textColor:"#000",label:"Between"},tw=Object.freeze(Object.defineProperty({__proto__:null,struct:ew},Symbol.toStringTag,{value:"Module"})),nw={create(e={}){return{...se({inputs:{condition:{value:!0}},...e}),type:"not"}},data:{},inputs:{condition:{type:S.BOOLEAN,default:!0}},outputs:{value:S.BOOLEAN},computation(e){return{value:!e.condition}},width:130,color:"#b0c4de",textColor:"#000",label:"Not"},aw=Object.freeze(Object.defineProperty({__proto__:null,struct:nw},Symbol.toStringTag,{value:"Module"})),ow={create(e={}){return{...se({inputs:{a:{value:!1},b:{value:!1}},...e}),type:"and"}},data:{},inputs:{a:{type:S.BOOLEAN,default:!0},b:{type:S.BOOLEAN,default:!0}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.a&&e.b}},width:100,color:"#b0c4de",textColor:"#000",label:"And"},rw=Object.freeze(Object.defineProperty({__proto__:null,struct:ow},Symbol.toStringTag,{value:"Module"})),sw={create(e={}){return{...se({inputs:{a:{value:!1},b:{value:!1}},...e}),type:"or"}},data:{},inputs:{a:{type:S.BOOLEAN,default:!0},b:{type:S.BOOLEAN,default:!0}},outputs:{value:S.BOOLEAN},computation(e){return{value:e.a||e.b}},width:100,color:"#b0c4de",textColor:"#000",label:"Or"},lw=Object.freeze(Object.defineProperty({__proto__:null,struct:sw},Symbol.toStringTag,{value:"Module"})),uw={create(e={}){return{...se({inputs:{a:{value:void 0},b:{value:void 0},threshold:{value:0}},...e}),type:"equal_generics"}},data:{},inputs:{a:{type:S.GENERICS,default:void 0},b:{type:S.GENERICS,default:void 0},threshold:{type:{type:W.SCALER,struct:Qe.UNIT,scale:.1},default:0}},outputs:{value:S.BOOLEAN},computation(e,t){const n=ln([t.inputs.a.genericsType,t.inputs.b.genericsType])??S.GENERICS;return{value:iw(n)(e.a,e.b,e.threshold)}},width:120,color:"#b0c4de",textColor:"#000",label:"a = b",genericsChains:[[{key:"a"},{key:"b"},{key:"value",output:!0}]],getErrors(e){const t=ln([e.inputs.a.genericsType,e.inputs.b.genericsType]);if(t)switch(t.type){case W.SCALER:case W.VECTOR2:case W.TEXT:case W.OBJECT:case W.BOOLEAN:return;default:return["invalid type to operate"]}}};function iw(e){if(!e||e.struct===Qe.ARRAY)return Ps;switch(e.type){case W.SCALER:return cw;case W.VECTOR2:return dw;case W.TEXT:case W.OBJECT:return fw;case W.BOOLEAN:return pw;default:return Ps}}function Ps(){return!1}function cw(e=0,t=0,n){return Math.abs(e-t)<=n}const ac={x:0,y:0};function dw(e=ac,t=ac,n){return It(e,t)<=n}function fw(e="",t=""){return e===t}function pw(e=!1,t=!1){return e===t}const mw=Object.freeze(Object.defineProperty({__proto__:null,struct:uw},Symbol.toStringTag,{value:"Module"})),hw={create(e={}){return{...se({inputs:{condition:{value:!0},if_true:{value:void 0},if_false:{value:void 0}},...e}),type:"switch_generics"}},data:{},inputs:{condition:{type:S.BOOLEAN,default:!0},if_true:{type:S.GENERICS,default:void 0},if_false:{type:S.GENERICS,default:void 0}},outputs:{value:S.GENERICS},computation(e){return{value:e.condition?e.if_true:e.if_false}},width:130,color:"#afeeee",textColor:"#000",label:"Switch",getOutputType(e,t){switch(t){case"value":return ln([e.inputs.if_true.genericsType,e.inputs.if_false.genericsType])??S.GENERICS;default:return S.GENERICS}},genericsChains:[[{key:"if_true"},{key:"if_false"},{key:"value",output:!0}]]},yw=Object.freeze(Object.defineProperty({__proto__:null,struct:hw},Symbol.toStringTag,{value:"Module"})),vw={create(e={}){return{...se({inputs:{value:{value:void 0}},...e}),type:"reroute"}},data:{},inputs:{value:{type:S.GENERICS,default:void 0}},outputs:{value:S.GENERICS},computation(e){return{value:e.value}},width:18,label:"",getOutputType(e){return ln([e.inputs.value.genericsType])??S.GENERICS},genericsChains:[[{key:"value"},{key:"value",output:!0}]]},gw=Object.freeze(Object.defineProperty({__proto__:null,struct:vw},Symbol.toStringTag,{value:"Module"})),bw={create(e={}){return se({...e,type:"custom_begin_input"})},data:{},inputs:{},outputs:{input:S.INPUT},computation(e,t){return{input:t.id}},width:130,color:"#ff7f50",textColor:"#fff",label:"Begin Input"},_w=Object.freeze(Object.defineProperty({__proto__:null,struct:bw},Symbol.toStringTag,{value:"Module"})),Sw={create(e={}){return{...se({data:{name:"input",default:{value:void 0}},inputs:{input:{value:void 0},output:{value:void 0}},...e}),type:"custom_input"}},data:{name:{type:S.TEXT,default:"input"},default:{type:S.GENERICS,default:void 0}},inputs:{input:{type:S.INPUT,default:""},output:{type:S.OUTPUT,default:""}},outputs:{value:S.GENERICS,input:S.INPUT},computation(e,t){return{value:t.data.default.value,input:e.input}},width:110,color:"#ff7f50",textColor:"#fff",label:"Input",getOutputType(e,t){switch(t){case"value":return ln([e.data.default.genericsType])??S.GENERICS;case"input":return S.INPUT;default:return S.GENERICS}},genericsChains:[[{key:"default",data:!0},{key:"value",output:!0}]],getErrors(e){const t=e.data.default.genericsType;if(t)switch(t.type){case W.INPUT:case W.OUTPUT:return["invalid type to operate"];default:return}}},xw=Object.freeze(Object.defineProperty({__proto__:null,struct:Sw},Symbol.toStringTag,{value:"Module"})),ww={create(e={}){return se({data:{max_loop:10},inputs:{loop:{value:!1}},...e,type:"custom_begin_output"})},data:{max_loop:{type:S.SCALER,default:10}},inputs:{loop:{type:S.BOOLEAN,default:!1}},outputs:{output:S.OUTPUT},computation(e,t){return{output:t.id}},width:130,color:"#df7698",textColor:"#fff",label:"Begin Output"},kw=Object.freeze(Object.defineProperty({__proto__:null,struct:ww},Symbol.toStringTag,{value:"Module"})),Ew={create(e={}){return{...se({data:{name:"output"},inputs:{output:{value:""},value:{value:void 0}},...e}),type:"custom_output"}},data:{name:{type:S.TEXT,default:"output"}},inputs:{output:{type:S.OUTPUT,default:""},value:{type:S.GENERICS,default:void 0}},outputs:{output:S.OUTPUT},computation(e){return{output:e.output}},width:110,color:"#df7698",textColor:"#fff",label:"Output",genericsChains:[[{key:"value"}]],getErrors(e){const t=e.inputs.value.genericsType;if(t)switch(t.type){case W.INPUT:case W.OUTPUT:return["invalid type to operate"];default:return}}},Cw=Object.freeze(Object.defineProperty({__proto__:null,struct:Ew},Symbol.toStringTag,{value:"Module"})),ru={get_frame:a1,scaler:r1,make_vector2:l1,break_vector2:i1,make_transform:d1,break_transform:p1,apply_transform:h1,color:v1,make_color:b1,break_color:S1,add_generics:A1,sub_generics:j1,multi_scaler:V1,divide_scaler:F1,remainder:G1,sin:z1,cos:X1,polar_coord:W1,invert_polar_coord:q1,pow:Q1,scale_vector2:tS,distance:aS,rotate_vector2:rS,lerp_generics:dS,clamp:pS,round_trip:hS,get_bone:vS,get_object:bS,get_child:SS,get_transform:wS,set_transform:ES,add_transform:MS,set_fill:TS,set_stroke:AS,set_stroke_length:PS,set_gradient:LS,set_clip_path:zx,set_viewbox:jS,hide_object:VS,clone_object:FS,group_clone_object:GS,circle_clone_object:zS,grid_clone_object:XS,tornado_clone_object:WS,create_object_group:qS,create_object_rect:QS,create_object_ellipse:tx,create_object_text:ax,create_object_path:rx,create_linear_gradient:lx,create_radial_gradient:ix,make_stop:dx,create_object_clip_path:Gx,make_path_m:px,make_path_l:hx,make_path_h:vx,make_path_v:bx,make_path_q:Sx,make_path_t:wx,make_path_c:Ex,make_path_s:Mx,make_path_a:Tx,make_path_z:Ax,get_path_length:Px,get_path_point_at:Lx,transform_path:jx,reverse_path:Vx,join_path:Fx,not:aw,and:rw,or:lw,equal_generics:mw,greater_than:Xx,greater_than_or_equal:Wx,less_than:qx,less_than_or_equal:Qx,between:tw,switch_generics:yw,reroute:gw,custom_begin_input:_w,custom_input:xw,custom_begin_output:kw,custom_output:Cw},oc=[{label:"Primitive",children:[{label:"Get Frame",type:"get_frame"},{label:"Number",type:"scaler"},{label:"Make Vector2",type:"make_vector2"},{label:"Break Vector2",type:"break_vector2"},{label:"Make Transform",type:"make_transform"},{label:"Break Transform",type:"break_transform"},{label:"Apply Transform",type:"apply_transform"},{label:"Color",type:"color"},{label:"Make Color",type:"make_color"},{label:"Break Color",type:"break_color"}]},{label:"Math",children:[{label:"(+)",type:"add_generics"},{label:"(-)",type:"sub_generics"},{label:"(x) Number",type:"multi_scaler"},{label:"(/) Number",type:"divide_scaler"},{label:"(%) Number",type:"remainder"},{label:"Sin",type:"sin"},{label:"Cos",type:"cos"},{label:"Polar Coord",type:"polar_coord"},{label:"Invert Polar Coord",type:"invert_polar_coord"},{label:"Pow",type:"pow"},{label:"Scale Vector2",type:"scale_vector2"},{label:"Distance",type:"distance"},{label:"Rotate Vector2",type:"rotate_vector2"},{label:"Lerp",type:"lerp_generics"},{label:"Clamp",type:"clamp"},{label:"Round Trip",type:"round_trip"}]},{label:"Boolean",children:[{label:"Not",type:"not"},{label:"And",type:"and"},{label:"Or",type:"or"},{label:"(=)",type:"equal_generics"},{label:"(>) Number",type:"greater_than"},{label:"(>=) Number",type:"greater_than_or_equal"},{label:"(<) Number",type:"less_than"},{label:"(<=) Number",type:"less_than_or_equal"},{label:"Between",type:"between"},{label:"Switch",type:"switch_generics"}]},{label:"Object",children:[{label:"Get Bone",type:"get_bone"},{label:"Get Object",type:"get_object"},{label:"Get Child",type:"get_child"},{label:"Clone Object",type:"clone_object"},{label:"Group Clone Object",type:"group_clone_object"},{label:"Circle Clone Object",type:"circle_clone_object"},{label:"Grid Clone Object",type:"grid_clone_object"},{label:"Tornado Clone Object",type:"tornado_clone_object"}]},{label:"Attribute",children:[{label:"Hide Object",type:"hide_object"},{label:"Get Transform",type:"get_transform"},{label:"Set Transform",type:"set_transform"},{label:"Add Transform",type:"add_transform"},{label:"Set Fill",type:"set_fill"},{label:"Set Stroke",type:"set_stroke"},{label:"Set Stroke Length",type:"set_stroke_length"},{label:"Set Gradient",type:"set_gradient"},{label:"Set Clip Path",type:"set_clip_path"},{label:"Set Viewbox",type:"set_viewbox"}]},{label:"Create",children:[{label:"Group",type:"create_object_group"},{label:"Rect",type:"create_object_rect"},{label:"Ellipse",type:"create_object_ellipse"},{label:"Text",type:"create_object_text"},{label:"Path",type:"create_object_path"},{label:"Linear Gradient",type:"create_linear_gradient"},{label:"Radial Gradient",type:"create_radial_gradient"},{label:"Stop",type:"make_stop"},{label:"Clip Path",type:"create_object_clip_path"}]},{label:"Path",children:[{label:"M (Move)",type:"make_path_m"},{label:"L (Line)",type:"make_path_l"},{label:"H (Horizon)",type:"make_path_h"},{label:"V (Vertical)",type:"make_path_v"},{label:"Q (Bezier2)",type:"make_path_q"},{label:"T (Bezier2)",type:"make_path_t"},{label:"C (Bezier3)",type:"make_path_c"},{label:"S (Bezier3)",type:"make_path_s"},{label:"A (Arc)",type:"make_path_a"},{label:"Z (Close)",type:"make_path_z"},{label:"Transform Path",type:"transform_path"},{label:"Reverse Path",type:"reverse_path"},{label:"Join Path",type:"join_path"},{label:"Get Path Length",type:"get_path_length"},{label:"Get Path Point At",type:"get_path_point_at"}]},{label:"Etc",children:[{label:"Reroute",type:"reroute"}]}];function Mw(e,t,n,a){const o=il(e,t,n,!0);return il(e,o,a)}function il(e,t,n,a=!1){const o=Xt(n,S.GENERICS);return t.map(r=>{const s=r.children.map(l=>{var i;const u=(i=e(l.type))==null?void 0:i.struct;if(u)if(a){const c=sc(u,n)??sc(u,S.GENERICS)??(o?Object.keys(u.inputs)[0]:void 0);return c?{...l,inputKey:c}:void 0}else{const c=rc(u,n)??rc(u,S.GENERICS)??(o?Object.keys(u.outputs)[0]:void 0);return c?{...l,outputKey:c}:void 0}}).filter(al);return s.length>0?{label:r.label,children:s}:void 0}).filter(al)}function rc(e,t){const n=Object.entries(e.outputs).find(([,a])=>Xt(a,t));return n?n[0]:void 0}function sc(e,t){const n=Object.entries(e.inputs).find(([,a])=>Xt(a.type,t));return n?n[0]:void 0}function Ar(e){return ru[e]}function su(e,t,n){return Object.keys(n).reduce((a,o)=>a[o]?a:{...a,...up(e,t,n,a,o,{})},{})}function up(e,t,n,a,o,r={}){if(a[o]||r[o])return a;const s=n[o];if(!s)return a;const l={...r,[o]:!0},u=cp(s.inputs??{}).reduce((i,c)=>up(e,t,n,i,c,l),a);return{...u,[o]:Tw(e,t,u,s)}}function Ow(e){const t={},n=a=>{a.forEach(o=>{t[o]=!0})};return Object.keys(e).reduce((a,o)=>a[o]?a:{...a,...ip(e,a,o,{},n)},{}),t}function ip(e,t,n,a={},o){if(t[n])return t;if(a[n])return o==null||o(Object.keys(a)),t;const r=e[n];if(!r)return t;const s={...a,[n]:!0};return{...cp(Pw(r)).reduce((u,i)=>ip(e,u,i,s,o),t),[n]:!0}}function Tw(e,t,n,a){var s;const o=(s=e(a.type))==null?void 0:s.struct;if(!o)return n;const r=$w(n,a.inputs);return o.computation(Q(r,(l,u)=>{var i;return l!==void 0?l:(i=o.inputs[u])==null?void 0:i.default}),a,t,e)}function $w(e,t){return Object.keys(t).reduce((n,a)=>(n[a]=Aw(e,t,a),n),{})}function Aw(e,t,n){const a=t[n].from;return a&&e[a.id]&&e[a.id][a.key]!==void 0?Iw(e,a.id,a.key):t[n].value}function Iw(e,t,n){return e[t][n]}function cp(e){return Object.values(e).map(t=>{var n;return(n=t.from)==null?void 0:n.id}).filter(t=>!!t)}function Pw(e){if(e.type!=="custom_input")return e.inputs;const t={...e.inputs};return delete t.output,t}function dp(e,t,n){var r;const a=t[n];if(!a)return{};const o=(r=e(a.type))==null?void 0:r.struct;return Object.keys(a.inputs).reduce((s,l)=>{var i;const u=a.inputs[l];if(!u.from)s[l]=!0;else if(!t[u.from.id])s[l]=!1;else{const c=(i=e(t[u.from.id].type))==null?void 0:i.struct;o&&c?s[l]=Xt(un(o,a,l),Qa(c,t[u.from.id],u.from.key)):s[l]=!1}return s},{})}function fp(e,t,n={},a=!1){return pp(e[t]?e[t]:ru[t],n,a)}function Tt(e,t={},n=!1){return pp(ru[e],t,n)}function pp(e,t={},n=!1){const{inputs:a,data:o,...r}=t,s=e.struct.create(r);return a&&(s.inputs={...s.inputs,...t.inputs}),o&&(s.data={...s.data,...t.data}),n&&(s.id=We()),s}function Bw(e,t,n){const a=e(n.node.type),o=e(t.node.type);return!o||!a?!1:Lw(un(a.struct,n.node,n.key),Qa(o.struct,t.node,t.key))}function Lw(e,t){return e.type==="GENERICS"||t.type==="GENERICS"?!0:Xt(e,t)}function hr(e,t,n){const a=t.inputs[n],o=mp(e==null?void 0:e.inputs[n],a);if(!o){const s={...t.inputs};return delete s[n],{...t,inputs:s}}return{...t,inputs:{...t.inputs,[n]:o}}}function mp(e,t){return e?e.type.type===W.GENERICS&&(t!=null&&t.genericsType)?{genericsType:t.genericsType,value:yo(t.genericsType)}:{value:e.default}:void 0}function hp(e,t,n={},a=o=>o.id){const o=Rw(Q(t,a),t),r=Uo(e,{...n,...o});return{...o,...r}}function Rw(e,t){return Object.entries(t).reduce((n,[a,o])=>(n[e[a]]={...o,id:e[a],inputs:jw(e,o.inputs)},n),{})}function jw(e,t){return Q(t,n=>!n.from||!e[n.from.id]?n:{...n,from:{id:e[n.from.id],key:n.from.key}})}function lu(e){return e==="custom_begin_input"||e==="custom_begin_output"}function Nw(e){return lu(e)||e==="custom_input"||e==="custom_output"}function Vw(e,t,n){const a={};return{nodes:t.filter(r=>!n[r.id]||lu(r.type)).map(r=>({...r,inputs:Q(r.inputs,(s,l)=>{var u;return!s.from||!n[s.from.id]?s:(a[r.id]=!0,{value:((u=e(r.type))==null?void 0:u.struct.inputs[l].default)??void 0})})})),updatedIds:a}}function Dw(e,t){const n=new Set(t.map(s=>s.id)),a={},o=t.map(s=>{const l=Object.entries(s.inputs).reduce((u,[i,c])=>{var d;if(!c.from||n.has(c.from.id))return u[i]=c,u;a[s.id]=!0;const p=mp((d=e(s.type))==null?void 0:d.struct.inputs[i],c);return p&&(u[i]=p),u},{});return{...s,inputs:l}}),r=Uo(e,ie(o));return{nodes:o.map(s=>r[s.id]??s),updatedIds:{...a,...Q(r,()=>!0)}}}function yp(e,t){const n=e(t.type);return{inputs:iu(n==null?void 0:n.struct,t),outputs:Kw(n==null?void 0:n.struct,t)}}function Fw(e,t){var r,s;if(e.node.id===t.node.id)return;const n=t.node.inputs[t.key];if(((r=n.from)==null?void 0:r.id)===e.node.id&&((s=n.from)==null?void 0:s.key)===e.key)return;const a={from:{id:e.node.id,key:e.key}};return{...t.node,inputs:{...t.node.inputs,[t.key]:a}}}function uu(e){const t={};return Object.entries(e).forEach(([n,a])=>{t[n]??(t[n]={inputs:{},outputs:{}}),Object.entries(a.inputs).forEach(([o,r])=>{var s,l,u;r.from&&(t[n].inputs[o]=r.from,t[s=r.from.id]??(t[s]={inputs:{},outputs:{}}),(l=t[r.from.id].outputs)[u=r.from.key]??(l[u]=[]),t[r.from.id].outputs[r.from.key].push({id:n,key:o}))})}),t}function cl(e){return!!e&&e.type!==W.GENERICS}function vp(e,t){return!!e&&e.data[t].type.type===W.GENERICS}function Uw(e,t,n,a,o){var r;return vp((r=e(t))==null?void 0:r.struct,n)?{...a,value:o}:o}function gp(e,t,n){var r,s,l;const a=t.data[n],o=(r=e(t.type))==null?void 0:r.struct;return vp(o,n)?{type:a.genericsType??((s=o==null?void 0:o.data[n])==null?void 0:s.type)??S.UNKNOWN,value:a.value}:{type:((l=o==null?void 0:o.data[n])==null?void 0:l.type)??S.UNKNOWN,value:a}}function un(e,t,n){var a;return t.inputs[n].genericsType??((a=e==null?void 0:e.inputs[n])==null?void 0:a.type)??S.UNKNOWN}function iu(e,t){return Q(t.inputs,(n,a)=>un(e,t,a))}function Gw(e,t,n){var o;const a=e(t);return((o=a==null?void 0:a.struct.inputs[n])==null?void 0:o.type)??S.UNKNOWN}function Qa(e,t,n){var a;return((a=e==null?void 0:e.getOutputType)==null?void 0:a.call(e,t,n))??(e==null?void 0:e.outputs[n])??S.UNKNOWN}function Kw(e,t){return e?Q(e.outputs,(n,a)=>{var o;return((o=e.getOutputType)==null?void 0:o.call(e,t,a))??e.outputs[a]}):{}}function cu(e,t,n,a){const o={};return bp(e,t,n,a,{saveDoneItem:l=>{var u;o[u=l.id]??(o[u]={inputs:{},outputs:{}}),l.output?o[l.id].outputs[l.key]=!0:o[l.id].inputs[l.key]=!0},isDoneItem:l=>{var u,i;return l.output?!!((u=o[l.id])!=null&&u.outputs[l.key]):!!((i=o[l.id])!=null&&i.inputs[l.key])}})}function bp(e,t,n,a,o){const r=t[a.id];if(!r)return[];if(o.isDoneItem(a))return[];const s=e(r.type);if(!s)return[];const l=t1(r.id,s.struct.genericsChains??[])(a.key,a.output)??[{...a,type:a.output?Qa(s.struct,r,a.key):un(s.struct,r,a.key)}];l.forEach(o.saveDoneItem);const u=n[r.id].inputs,i=n[r.id].outputs;return[...l,...l.flatMap(c=>{const p=[];if(c.output){const d=i[c.key];d&&d.forEach(f=>{p.push({id:f.id,key:f.key})})}else{const d=u[c.key];d&&p.push({id:d.id,key:d.key,output:!0})}return p.filter(d=>!o.isDoneItem(d)).flatMap(d=>bp(e,t,n,d,o))})]}function _p(e){var t;return(t=e.find(n=>cl(n.type)))==null?void 0:t.type}function dl(e,t,n){const a=uu(t),o=cu(e,t,a,n),r=_p(o);return Sp(e,t,o,r)}function Sp(e,t,n,a){const o={};return n.forEach(r=>{var l,u,i;if(r.output)return;const s=o[r.id]??t[r.id];if(s)if(r.data){if(((u=(l=e(s.type))==null?void 0:l.struct.data[r.key])==null?void 0:u.type.type)!==W.GENERICS)return;const c=s.data[r.key];if(Xt(c==null?void 0:c.genericsType,a))return;o[r.id]={...s,data:{...s.data,[r.key]:{genericsType:a,value:yo(a)}}}}else{const c=s.inputs[r.key];if(!c)return;if(Gw(e,s.type,r.key).type===W.GENERICS){if(Xt(c.genericsType,a))return;o[r.id]={...s,inputs:{...s.inputs,[r.key]:{...c,genericsType:a,value:yo(a)}}}}else{const d=un((i=e(s.type))==null?void 0:i.struct,s,r.key);if(Xt(d,a))return;o[r.id]={...s,inputs:{...s.inputs,[r.key]:{value:yo(a)}}}}}}),o}function yo(e){if(e)switch(e.struct){case Qe.UNIT:case Qe.UNIT_OR_ARRAY:return lc(e.type);case Qe.ARRAY:return[lc(e.type)]}}function lc(e){switch(e){case W.SCALER:return 0;case W.VECTOR2:return{x:0,y:0};case W.BOOLEAN:return!1;case W.TRANSFORM:case W.COLOR:return ve();case W.STOP:return zw();case W.TEXT:case W.BONE:case W.OBJECT:case W.INPUT:case W.OUTPUT:return"";case W.D:return[];case W.GENERICS:case W.UNKNOWN:return;default:{const t=e;throw new Error(`Unexpected value type: ${t}`)}}}function zw(){return{offset:0,color:ve(),relative:!1}}function Uo(e,t){const n=uu(t),a={},o={},r=ke(t).reduce((s,l)=>{var c;const u=(c=e(l.type))==null?void 0:c.struct;return u!=null&&u.genericsChains?u.genericsChains.filter(p=>p.length>0).reduce((p,d)=>{var E,g;const f={...d[0],id:l.id};if(f.output&&((E=a[l.id])!=null&&E.outputs[f.key])||(g=a[l.id])!=null&&g.inputs[f.key])return p;const h=cu(e,p,n,f);h.forEach(v=>{var A;a[A=v.id]??(a[A]={inputs:{},outputs:{}}),v.output?a[v.id].outputs[v.key]=!0:a[v.id].inputs[v.key]=!0});const y=_p(h),k=Sp(e,p,h,y);return ke(k).forEach(v=>o[v.id]=!0),{...p,...k}},s):s},t);return tt(r,o)}function Yw(e,t){const n=Ow(t);return ke(t).reduce((a,o)=>{var l,u;const r=(l=e(o.type))==null?void 0:l.struct,s=r?[...((u=r.getErrors)==null?void 0:u.call(r,o))??[],...Object.entries(dp(e,t,o.id)).filter(([i,c])=>!c).map(([i])=>{var c;return`Invalid input: ${((c=r.inputs[i])==null?void 0:c.label)??i}`}),...n[o.id]?["Circular connection is found"]:[]]:["Unknown node"];return s.length>0&&(a[o.id]=s),a},{})}function xp(e,t,n){const a=t,o=new Set;return Object.entries(n).forEach(([r,s])=>{Object.keys(s).forEach(l=>{const u=du(e,a,r,l);Object.entries(u).forEach(([i,c])=>{a[i]=c,o.add(i)})})}),Array.from(o).reduce((r,s)=>(r[s]=a[s],r),{})}function du(e,t,n,a){var i;const o=t[n],r=hr((i=e(o.type))==null?void 0:i.struct,o,a),s=o.inputs[a],l=dl(e,{...t,[r.id]:r},{id:r.id,key:a}),u=s!=null&&s.from?dl(e,{...t,[r.id]:r,...l},{id:s.from.id,key:s.from.key,output:!0}):{};return{[o.id]:r,...l,...u}}function uc(e,t,n,a){var c;const o=(c=e(n))==null?void 0:c.struct;if(!o)return{};const r=Je(t,p=>p.type===n),s=new Set,l=Q(r,p=>{const d=Object.keys(p.inputs).reduce((f,h)=>{var E;const y=f.inputs[h],k=(E=a.inputs[h])==null?void 0:E.type;return a.inputs[h]&&Xt(k,un(o,f,h))?k.type!==W.GENERICS&&y.genericsType?(s.add(p.id),{...f,inputs:{...f.inputs,[h]:y.from?{from:y.from}:{value:yo(k)}}}):f:(s.add(p.id),hr(a,f,h))},p);return Object.keys(a.inputs).reduce((f,h)=>f.inputs[h]?f:(s.add(p.id),hr(a,f,h)),d)}),u=Q({...t,...l},p=>{var f;const d=(f=e(p.type))==null?void 0:f.struct;return d?Object.entries(p.inputs).reduce((h,[y,k])=>!k.from||!r[k.from.id]||Xt(a.outputs[k.from.key],un(d,h,y))?h:(s.add(h.id),hr(d,h,y)),p):p}),i=p=>{const d=e(p);return p!==n?d:{...d,struct:{...d==null?void 0:d.struct,...a}}};return{...Je(u,(p,d)=>s.has(d)),...Uo(i,u)}}function ic(e,t){const n=Object.keys(e.inputs),a=Object.keys(t.inputs);if(n.length!==a.length||n.some((s,l)=>s!==a[l]))return!0;const o=Object.keys(e.outputs),r=Object.keys(t.outputs);return o.length!==r.length||o.some((s,l)=>s!==r[l])?!0:Object.entries(e.inputs).some(([s,l])=>{const u=t.inputs[s];return!u||!Xt(l.type,u.type)})||Object.entries(e.outputs).some(([s,l])=>{const u=t.outputs[s];return!u||!Xt(l,u)})}function Xw(e,t,n){return Q(t,a=>{var s;if(!n[a.id])return a;const o=(s=e(a.type))==null?void 0:s.struct;if(!o)return a;const r=dp(e,t,a.id);return{...a,inputs:Q(a.inputs,(l,u)=>{var i;return r[u]?l:{value:(i=o.inputs[u])==null?void 0:i.default}})}})}function Hw(e,t){switch(e){case"scaler":return{data:{value:t}};case"make_vector2":{const n=t;return{inputs:{x:{value:n.x},y:{value:n.y}}}}case"make_transform":{const n=t;return{inputs:{translate:{value:n.translate},rotate:{value:n.rotate},scale:{value:n.scale},origin:{value:n.origin}}}}case"color":return{data:{color:t}};case"make_color":{const n=t;return{inputs:{h:{value:n.rotate},s:{value:n.translate.x},v:{value:n.translate.y},a:{value:n.scale.x}}}}case"get_object":return{data:{object:t}};default:return{}}}function wp(e,t,n){const a={};return Object.values(e).forEach(o=>{var r;for(const s in o.inputs){const l=o.inputs[s];l.from&&l.from.id===t&&l.from.key===n&&(a[r=o.id]??(a[r]={}),a[o.id][s]=!0)}}),a}function Jn(e,t,n,a,o,r){if(!t[o]||!t[n])return{};const s=Fw({node:t[o],key:r},{node:t[n],key:a});return s?{[s.id]:s,...dl(e,{...t,[s.id]:s},{id:s.id,key:a})}:{}}function kp(e,t,n,a,o){if(o.length===0)return{};const r=new Set,s={...t};return o.forEach(l=>{const u=Jn(e,s,l.nodeId,l.key,n,a);for(const i in u)s[i]=u[i],r.add(i)}),Je(s,(l,u)=>r.has(u))}function Ww(){return as({id:"svg",tag:"svg",attributes:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 400 400","font-family":"sans-serif"}})}function Jw(e){const a=new DOMParser().parseFromString(e,"image/svg+xml").getElementsByTagName("svg");if(!a||a.length===0)throw new Error("Not found SVG tag.");const o=a[0],r=Qw(o),s=Cp(o),l=ls(s);return{actor:Jl({svgTree:s,viewBox:r,elements:l.map(u=>u.id)},!0),elements:l}}function qw(e,t){const n=ie(t);return ls(e).map(o=>({...n[o.id]??{},...o}))}function ls(e,t,n=0){return mt(e)?[]:[Ep(e,t,n),...e.children.flatMap((a,o)=>ls(a,e.id,o))]}function Ep(e,t,n=0){return x0({id:e.id,tag:e.tag,parentId:t,index:n})}function Cp(e){const t=e.id;return as({id:t,tag:e.tagName,attributes:Array.from(e.attributes).reduce((n,a)=>({...n,[a.name]:a.value}),{}),children:Zw(e.childNodes)},!t)}function Zw(e){return Array.from(e).map(t=>{var n;return t.nodeName==="#text"?((n=t.nodeValue)==null?void 0:n.trim())||"":Cp(t)}).filter(t=>!!t)}function Qw(e){const t=e.getAttribute("viewBox");return us(t||void 0)}function us(e){if(!e)return;const t=e.split(/ +/).map(n=>parseFloat(n));if(!(t.length<4))return{x:t[0],y:t[1],width:t[2],height:t[3]}}function ek(e,t,n,a){const o=ie(t),r=ie(n),s=ie(a),l=Q(r,c=>ie(c.bones.map(p=>s[p]))),u=e.map(c=>r[c.armatureId]?c:{...c,armatureId:""}),i=u.flatMap(c=>{const p=c.armatureId?l[c.armatureId]:{};return c.elements.map(d=>{const f=o[d];return f.boneId?p[f.boneId]?f:{...f,boneId:""}:f})});return{actors:u,elements:i}}function tk(e,t){const n=ie(e.elements),a=ie(t.elements),o=ke({...ie(t.elements),...tt(n,a)});return{actor:{...t.actor,armatureId:e.actor.armatureId},elements:o}}function Go(e){const t=e.filter(n=>!mt(n));return t.concat(t.flatMap(n=>Go(n.children)))}function Mp(e){return!/defs|metadata|namedview|script|style|tspan/.test(e.toLowerCase())}function Op(e){return`${e.tag} #${e.id}`}function Tp(e){return{id:e.id,name:Op(e),children:e.children.filter(t=>!mt(t)).filter(t=>Mp(t.tag)).map(Tp)}}function nk(e){return pr({id:e.id,elementId:e.id,tag:e.tag,parent:e.parentId,index:e.index})}function ak(e){if(!e)return;const t=wa(e,[e.transform]);return{id:t.id,transform:ve({translate:t.head,rotate:qa(t)*180/Math.PI,scale:e.transform.scale}),height:It(e.head,e.tail)}}function $p(e,t,n){const a=Q(e,nk),o=qb(t,ak),r=Jb(()=>Sa(ke(a),"parent"));function s(g){const v=r.getValue()[g];return v?v.length:0}function l(g,v){var x;if(v<0)return;const A=r.getValue()[g];if(A)return(x=A[v])==null?void 0:x.id}function u(g){a[g.id]=g,r.update()}function i(g,v){const A=r.getValue()[g];A&&A.forEach(x=>{v(x),i(x.id,v)})}function c(g){const v=r.getValue()[g];return v?[...v,...v.flatMap(A=>c(A.id))]:[]}function p(g,v={}){const A=a[g];if(!A)return;const x=v.id?h(v.id):void 0;return pr(A.create?{...A,...v,id:x}:{...A,...v,id:x,clone:!0},!x)}function d(g,v){const A=g.reduce((x,I,O)=>{const T=p(I.id,v?{id:`${v}_clone_${O}`}:void 0);return T&&(x[I.id]=T),x},{});return ke(A).map(x=>!x.parent||!A[x.parent]?x:{...x,parent:A[x.parent].id})}const f=[];function h(g=""){return f.length>0?`${f.join("-")}-${g}`:g}const y=Cf(g=>g,g=>ib(g,100));function k(g){return g?cb(y.getValue(g)):0}function E(g,v){return g?db(y.getValue(g),v):{x:0,y:0}}return{beginNamespace(g,v){f.push(g);const A=v();return f.pop(),A},setTransform(g,v,A=!1){const x=a[g];x&&(A&&x.transform&&v?x.transform=eu(x.transform,v):x.transform=v)},getTransform(g){if(a[g])return a[g].transform},setFill(g,v){a[g]&&(a[g].fill=v,i(g,A=>{A.fill=v}))},setStroke(g,v){a[g]&&(a[g].stroke=v,i(g,A=>{A.stroke=v}))},setAttributes(g,v,A=!1){a[g]&&(a[g].attributes=A?v:{...a[g].attributes,...v})},getFrameInfo(){return n},getBoneSummary(g){return o.getValue(g)},getObjectMap(){return a},getChildId:l,getChildrenSize:s,cloneObject(g,v={},A){const x=a[g];if(!x)return"";const I=d([x,...c(g)],A),O=I[0];return Object.entries(v).forEach(([T,L])=>{O[T]=L}),O.index=x.parent?s(x.parent):0,I.forEach(u),O.id},createCloneGroupObject(g,v={}){const A=a[g];if(!A)return"";const x=v.id?h(v.id):void 0,I=A.parent,O=I?s(I):0,T=pr({...v,id:x,tag:"g",elementId:A.elementId,clone:!1,create:!0,index:O,parent:I},!x);return u(T),T.id},createObject(g,v={}){const A=v.id?h(v.id):void 0,x=v.parent,I=x?s(x):0,O=pr({...v,id:A,tag:g,create:!0,index:I},!A);return u(O),O.id},getPathLength:k,getPathPointAt:E}}function cc(e,t,n,a,o){const r=$p(t,n,a);return su(e,r,o),r.getObjectMap()}function mt(e){return typeof e=="string"}function ok(e,t,n){const a={};if(t.viewBoxBoneId){const o=e[t.viewBoxBoneId];if(o){const r=sk(n,o);r&&(a.viewBox=r)}}if(t.fillBoneId){const o=e[t.fillBoneId];if(o){const r=vo(o.transform);r&&(a.fill=r.color,a["fill-opacity"]=r.opacity)}}if(t.strokeBoneId){const o=e[t.strokeBoneId];if(o){const r=vo(o.transform);r&&(a.stroke=r.color,a["stroke-opacity"]=r.opacity)}}return Ap(a)}const rk=["fill","stroke","fill-opacity","stroke-opacity"];function Ap(e){if(!e.style)return e;const t=Ip(e.style);rk.filter(o=>t[o]&&e[o]).forEach(o=>delete t[o]);const n=Pp(t),a={...e};return n?a.style=n:delete a.style,a}function sk(e,t){const n=us(e.attributes.viewBox);if(n)return fu($0(n,{...t.transform,origin:t.head}))}function vo(e){const t=eo(e);return{color:F0(t),opacity:t.a.toString()}}function lk(e){const t=eo(e);return Fo(Za({...t,h:va(0,360,t.h)}))}function eo(e){return{h:e.rotate,s:lt(0,1,e.translate.x/100),v:lt(0,1,e.translate.y/100),a:lt(0,1,e.scale.x)}}function uk(e,t){return e.x===1&&e.y===1?"":[Da(t)?"":`translate(${t.x},${t.y})`,`scale(${e.x},${e.y})`,Da(t)?"":`translate(${-t.x},${-t.y})`].filter(n=>!!n).join(" ")}function ik(e){return[Da(e.translate)?"":`translate(${e.translate.x},${e.translate.y})`,uk(e.scale,e.origin),e.rotate===0?"":`rotate(${e.rotate} ${e.origin.x} ${e.origin.y})`].filter(t=>!!t).join(" ")}function dc(e,t=!1){if(e.length===0)return"";const[n,...a]=e;return`M${n.x},${n.y}`+a.map(o=>`L${o.x},${o.y}`).join("")+(t?"z":"")}function ck(e,t,n){const a=Math.max(n.width,n.height)*2,o=Ne(t,a);return{from:Ce(e,o),to:ee(e,o)}}function fu(e){return[zt(-1,e.x),zt(-1,e.y),zt(-1,e.width),zt(-1,e.height)].join(" ")}function Ip(e=""){return e.split(";").map(t=>t.split(":")).reduce((t,n)=>(n.length===2&&(t[n[0].trim()]=n[1].trim()),t),{})}function Pp(e){return Object.entries(e).filter(t=>t[1]).map(t=>`${t[0]}:${t[1]};`).join("")}function Bp(e){return dk(Ap(e))}function dk(e){if(e.transform!=="matrix(1,0,0,1,0,0)")return e;const t={...e};return delete t.transform,t}function Lp(e,t,n){return Object.keys(n).reduce((a,o)=>(a[o]=t+e*(n[o]+1),a),{})}const fk=["translateX","translateY","rotate","scaleX","scaleY"];function Rp(e,t){return t.filter(n=>e[n]).reduce((n,a,o)=>(n[a]=o,n),{})}function pk(e,t={}){return{id:e.id,name:e.name,children:Rp(t,fk)}}const mk=["influence"];function hk(e,t,n={}){return{id:t.id,name:`${e.name}:${t.name}`,children:Rp(n,mk)}}function yk(e,t,n,a=0){let o=a*n;return e.reduce((r,s)=>(r[s.id]=o,o=o+n*(t[s.id]?Object.keys(s.children).length+1:1),r),{})}const On=30,qn=20;function pu(e,t){return{x:t.position.x,y:t.position.y,...mu(e,t)}}function mu(e,t){const n=vk(Object.keys(t.inputs).length),a=e(t.type);if(!a)return{width:100,height:On+n};const o=jp(a.struct),r=hu(Object.keys(a.struct.outputs).length);return{width:a.struct.width,height:On+Math.max(r+o+n,20)}}function jp(e){const t=Object.values(e.data);return t.length===0?0:t.reduce((n,a)=>n+Vp(a.type),0)}function vk(e){return e===0?0:qn*(.3+e)}function hu(e){return e===0?0:qn*(.5+e)}function gk(e,t){const n=e(t.type);if(!n)return{};const a=hu(Object.keys(n.struct.outputs).length);let o=On+a;return Object.entries(n.struct.data).reduce((r,[s,l])=>(r[s]={x:8,y:o},o=o+Vp(l.type),r),{})}function bk(e,t){const n=e(t.type),a=n?jp(n.struct):0,o=n?hu(Object.keys(n.struct.outputs).length):0,r={x:0,y:t.type==="reroute"?qn/2:On+o+a+qn/2};return Np(n==null?void 0:n.struct,Object.entries(yp(e,t).inputs).map(([s,l])=>({key:s,type:l})),r)}function _k(e,t){const n=e(t.type);if(!n)return{};const a={x:mu(e,t).width,y:t.type==="reroute"?qn/2:On+qn*2/3};return Np(n.struct,Object.entries(yp(e,t).outputs).map(([o,r])=>({key:o,type:r})),a,!0)}function Sk(e,t){const n=bk(e,t),a=_k(e,t);return{inputs:n,outputs:a}}function Np(e,t,n={x:0,y:0},a=!1){return t.reduce((o,{key:r,type:s},l)=>(o[r]={p:ee(n,{x:0,y:qn*l}),type:s,label:xk(e,r,a)??r},o),{})}function xk(e,t,n=!1){return n?e!=null&&e.outputs[t]?e.outputs[t].label:"UNKNOWN":e!=null&&e.inputs[t]?e.inputs[t].label:"UNKNOWN"}function Vp(e){switch(e){case"SCALER":return 48;default:return 48}}const Dp={BOOLEAN:"#b22222",SCALER:"#aaa",VECTOR2:"#daa520",TRANSFORM:"#a0522d",BONE:"#4b0082",OBJECT:"#ee82ee",COLOR:"#32cd32",TEXT:"#808000",D:"#00bfff",STOP:"#8b008b",GENERICS:"#b0c4de",INPUT:"#ff7f50",OUTPUT:"#df7698",UNKNOWN:"#fff"};function wk(e,t){switch(e.type){case W.OBJECT:return Mn(t,6);case W.SCALER:{const n=e.enumKey;return n?To(n,t):Mn(t,6)}case W.VECTOR2:return`${Mn(t.x,4)}, ${Mn(t.y,4)}`;case W.BOOLEAN:return t?"true":"false";case W.COLOR:return Fo(Za(eo(t)));case W.D:return Mn(t.join(" "),6);default:return""}}function Mn(e,t){const n=e.toString();return n.length<=t?n:n.slice(0,t)+".."}function Fp(e,t){const n=Math.sqrt(Math.abs(e.x-t.x))*8;return`M${e.x+5},${e.y} C${e.x+n},${e.y} ${t.x-n},${t.y} ${t.x-5},${t.y}`}function fc(e,t,n=a=>a){const a=t.width/e.width,o=t.height/e.height,r=a<o?n(1/a):n(1/o);return{viewOrigin:{x:e.x+(e.width/r-t.width)/2*r,y:e.y+(e.height/r-t.height)/2*r},scale:r}}function yu(e){Wa("getScale",e)}function wn(){return ba("getScale",()=>1)}function kk(){const e=b(wn());return t=>{if(t.getBBox)return t.getBBox();const n=t.getBoundingClientRect();return{width:n.width*e.value,height:n.height*e.value}}}function go(e={}){const t=e.scaleMin??.1,n=e.scaleMax??10,a=e.scale??H(1),o=e.viewOrigin??H({x:0,y:0}),r=e.viewSize??H({width:600,height:100});function s(B){r.value=B}const l=H(),u=b(()=>l.value==="drag"),i=H(),c=H();function p(){l.value=void 0}function d(){l.value="move",i.value=h.value,c.value=o.value}function f(){l.value="drag",i.value=h.value,c.value=o.value}const h=H({x:0,y:0});function y(B){h.value=B}const k=b(()=>({x:o.value.x,y:o.value.y,width:r.value.width*a.value,height:r.value.height*a.value})),E=b(()=>Gg({x:0,y:0,...r.value})),g=b(()=>fu(k.value)),v=H(!1);function A(B=!1){v.value=B}const x=b(()=>{if(!v.value||!h.value||!i.value)return;const B=Ce(h.value,i.value);return M0({...i.value,width:B.x,height:B.y})}),I=b(()=>{if(x.value)return{...O(x.value),width:x.value.width*a.value,height:x.value.height*a.value}});function O(B){return ee(o.value,Ne(B,a.value))}function T(B){return Ne(Ce(B,o.value),1/a.value)}function L(B){return e.ignoreNegativeY?{x:B.x,y:Math.max(B.y,0)}:B}function R(){const B=r.value,N=fc({x:-B.width/2,y:-B.height/2,...B},B);o.value=L(N.viewOrigin),a.value=N.scale}return{viewSize:r,setViewSize:s,editStartPoint:i,mousePoint:h,setMousePoint:y,scale:a,viewOrigin:o,dragged:u,endMoving:p,startMoving:d,startDragging:f,viewCenter:E,viewBox:g,viewCanvasRect:k,viewToCanvas:O,canvasToView:T,wheel(B,N=!1){const j=!N&&h.value?h.value:E.value,K=O(j);a.value=Math.min(Math.max(a.value*Math.pow(ql,B.deltaY>0?1:-1),t),n),e.scaleAtFixY?o.value=L(ee(o.value,Ce(K,{...O(j),y:K.y}))):o.value=L(ee(o.value,Ce(K,O(j))))},viewMove(B){c.value&&(o.value=L(ee(c.value,Ce(B.start,B.current))))},adjustToCenter:R,setViewport(B){if(!B){R();return}const N=fc(P0(B,10/a.value),r.value,j=>lt(1,n,j));a.value=N.scale,o.value=L(N.viewOrigin)},setRectangleDragging:A,draggedRectangle:I}}const Ek={class:"fill-text stroke-text"},Ck=["transform"],Mk=C("circle",{r:"2"},null,-1),Ok=[Mk],Tk=["x1","y1","x2","y2","stroke-width","stroke-dasharray"],$k=J({__name:"CursorLine",props:{origin:null,current:null},setup(e){const t=e,n=wn(),a=b(n),o=b(()=>ht(t.current,t.origin)/Math.PI*180);return(r,s)=>(_(),M("g",Ek,[C("g",{transform:`translate(${e.origin.x}, ${e.origin.y}) rotate(${m(o)}) scale(${m(a)})`},Ok,8,Ck),C("line",{x1:e.origin.x,y1:e.origin.y,x2:e.current.x,y2:e.current.y,"stroke-width":m(a),"stroke-dasharray":`${2*m(a)} ${2*m(a)}`},null,8,Tk)]))}}),Ak=["x","y","width","height"],vu=J({__name:"SelectRectangle",props:{x:{default:0},y:{default:0},width:{default:100},height:{default:100}},setup(e){return(t,n)=>(_(),M("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:"#1e90ff","fill-opacity":"0.2",stroke:"none"},null,8,Ak))}}),Ik=J({__name:"FocusableBlock",emits:["copy","paste","keydown","keyup"],setup(e,{emit:t}){const n=H();function a(){document.addEventListener("copy",r),document.addEventListener("paste",s)}function o(){document.removeEventListener("copy",r),document.removeEventListener("paste",s)}_a(o);function r(f){t("copy",f)}function s(f){t("paste",f)}function l(){var f;(f=n.value)==null||f.focus()}function u(){var f,h;(f=document.activeElement)!=null&&f.getAttribute("data-keep-focus")||(h=n.value)==null||h.focus()}function i(f){Ni(Oo(f))||f.preventDefault(),t("keydown",f)}function c(f){Ni(Oo(f))||f.preventDefault(),t("keyup",f)}function p(){a()}function d(){o()}return(f,h)=>(_(),M("div",{ref_key:"root",ref:n,tabindex:"-1",onMousedown:l,onMouseenter:u,onKeydown:i,onKeyup:c,onFocus:p,onBlur:d},[at(f.$slots,"default",{},void 0,!0)],544))}});const gu=Me(Ik,[["__scopeId","data-v-4134718f"]]);function Pk(){return{selectedColor:"orange",historyMax:64,showBoneName:!1,boneOpacity:1,showViewbox:!0,showAxis:!0,graphValueWidth:5,animationExportingSettings:{fps:30,interpolation:"discrete",range:"auto",customRange:{from:0,to:60},size:"auto",customSize:{width:200,height:200},duration:"auto",customDuration:1e3},colorTheme:"auto"}}const Up="blendic-app-settings";function Bk(){const e=Pk();try{const t=localStorage.getItem(Up),n=t?JSON.parse(t):{};return{...e,...n,animationExportingSettings:{...e.animationExportingSettings,...n.animationExportingSettings??{}}}}catch{return e}}const bu=ha(Bk());function Ct(){return{settings:bu}}rn(()=>{const e=bu.colorTheme;e==="light"?document.documentElement.classList.add("theme-light"):document.documentElement.classList.remove("theme-light"),e==="dark"?document.documentElement.classList.add("theme-dark"):document.documentElement.classList.remove("theme-dark")});rn(()=>{localStorage.setItem(Up,JSON.stringify(bu))});/*! okahistory v0.1.0, License MIT, undefined */var Lk=Object.defineProperty,Rk=Object.defineProperties,jk=Object.getOwnPropertyDescriptors,pc=Object.getOwnPropertySymbols,Nk=Object.prototype.hasOwnProperty,Vk=Object.prototype.propertyIsEnumerable,mc=(e,t,n)=>t in e?Lk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,hc=(e,t)=>{for(var n in t||(t={}))Nk.call(t,n)&&mc(e,n,t[n]);if(pc)for(var n of pc(t))Vk.call(t,n)&&mc(e,n,t[n]);return e},yc=(e,t)=>Rk(e,jk(t));function Dk(e={}){var t,n,a;const o=(t=e.max)!=null?t:64,r=(n=e==null?void 0:e.onUpdated)!=null?n:()=>{},s=(a=e==null?void 0:e.avoidOverriding)!=null?a:!1,l={};let u=[],i=-1;function c(L){u=L,r()}function p(L,R){if(s&&l[L])throw new Error(`The name of this reducer has been defined already. name: ${L}Rename it or see \`avoidOverriding\` option.`);l[L]=R}function d(L,R){p(L,R)}function f(L){for(const R in L)p(R,L[R]);return{dispatch:h,createAction:(R,B)=>({name:R,args:B})}}function h(L,R){var B;if(!L)return;const N=Bs(l,L.name);if(N.ignoreDuplication&&i!==-1){const j=u[i];if(j.name===L.name&&((B=N.checkDuplicationFn)!=null?B:Gk)(L.args,j.redoArgs))return}y({name:L.name,redoArgs:L.args,undoArgs:N.redo(L.args),seriesKey:L.seriesKey,children:R==null?void 0:R.filter(j=>!!j).map(j=>{const K=Bs(l,j.name);return{name:j.name,redoArgs:j.args,undoArgs:K.redo(j.args)}})})}function y(L){var R;if(i<u.length-1&&u.splice(i+1,u.length-i),L.seriesKey){const B=Uk(u,N=>Fk(N,L));if(B.isTrue.length>0){const N=B.isTrue[0];if(Kk(N,L)){const j=yc(hc({},L),{undoArgs:N.undoArgs,children:(R=L.children)==null?void 0:R.map((K,D)=>yc(hc({},K),{undoArgs:N.children[D].undoArgs}))});c(B.isFalse.concat(j))}else u.push(L)}else u.push(L)}else u.push(L);u.length>o&&u.shift(),i=u.length-1,r()}function k(){i<u.length-1&&(E(),r())}function E(){var L;const R=u[i+1];l[R.name].redo(R.redoArgs),(L=R.children)==null||L.forEach(B=>l[B.name].redo(B.redoArgs)),i=i+1}function g(){-1<i&&(v(),r())}function v(){var L;const R=u[i];(L=R.children)==null||L.concat().reverse().forEach(B=>l[B.name].undo(B.undoArgs)),l[R.name].undo(R.undoArgs),i=i-1}function A(L){const R=Math.min(u.length-1,Math.max(-1,L));R<i?([...Array(i-R)].forEach(()=>v()),r()):R>i&&([...Array(R-i)].forEach(()=>E()),r())}function x(){return u.map((L,R)=>{var B,N;const j=Bs(l,L.name);return{name:L.name,label:(N=(B=j.getLabel)==null?void 0:B.call(j,{name:L.name,args:L.redoArgs}))!=null?N:L.name,done:R<=i}})}function I(){return{version:"0",stack:u,currentStackIndex:i}}function O(L){c(L.stack.concat()),i=L.currentStackIndex}function T(){c([]),i=-1}return{defineReducer:d,defineReducers:f,dispatch:h,redo:k,undo:g,jump:A,getCurrentIndex:()=>i,getActionSummaries:x,serialize:I,deserialize:O,clear:T}}function Bs(e,t){const n=e[t];if(!n)throw new Error(`not found a reducer for the action: ${t}`);return n}function Fk(e,t){return!!e.seriesKey&&!!t.seriesKey&&e.seriesKey===t.seriesKey}function Uk(e,t){const n={isTrue:[],isFalse:[]};return e.forEach(a=>t(a)?n.isTrue.push(a):n.isFalse.push(a)),n}function Gk(e,t){return e===t}function Kk(e,t){return e.name===t.name&&(e.children===t.children||!!e.children&&!!t.children&&e.children.length===t.children.length&&e.children.every((n,a)=>n.name===t.children[a].name))}function zk(e=()=>64){const t=Dk({max:e(),onUpdated:o}),n=H(-1),a=H([]);function o(){n.value=t.getCurrentIndex(),a.value=t.getActionSummaries()}return{historySummaries:b(()=>a.value),currentItemIndex:b(()=>n.value),clear:t.clear,dispatch:t.dispatch,undo:t.undo,redo:t.redo,defineReducers:t.defineReducers}}const{settings:Yk}=Ct(),Xk=zk(()=>Yk.historyMax);function ea(){return Xk}function Hk(e,t,n){const a=Array.isArray(n)?$n(n,()=>!0):n,o=ie(t),r={created:[],updated:[],deleted:[]};e.allIds.forEach((i,c)=>{a[i]&&(o[i]?(r.updated.push(e.byId[i]),e.byId[i]=o[i]):(r.deleted.push({entity:e.byId[i],index:c}),delete e.byId[i]))});const s=ie(r.deleted.map(i=>i.entity));e.allIds=e.allIds.filter(i=>!s[i]);const l=t.filter(i=>!e.byId[i.id]),u=l.map(i=>i.id);return Object.assign(e.byId,ie(l)),e.allIds.push(...u),r.created.push(...u),r}function Wk(e,t){t.created.forEach(a=>{delete e.byId[a]});const n=$n(t.created,()=>!0);e.allIds=e.allIds.filter(a=>!n[a]),t.deleted.concat().sort((a,o)=>a.index-o.index).forEach(a=>{e.byId[a.entity.id]=a.entity,e.allIds.splice(a.index,0,a.entity.id)}),t.updated.forEach(a=>{e.byId[a.id]=a})}function nn(e){return e.allIds.map(t=>e.byId[t])}function Ft(e){return{byId:ie(e),allIds:e.map(t=>t.id)}}/*! okaselect v0.1.0, License MIT, undefined */var Jk=Object.defineProperty,vc=Object.getOwnPropertySymbols,qk=Object.prototype.hasOwnProperty,Zk=Object.prototype.propertyIsEnumerable,gc=(e,t,n)=>t in e?Jk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bc=(e,t)=>{for(var n in t||(t={}))qk.call(t,n)&&gc(e,n,t[n]);if(vc)for(var n of vc(t))Zk.call(t,n)&&gc(e,n,t[n]);return e};function Gp(e){return e instanceof Map?Array.from(e.entries()):Object.entries(e)}function Kp(e){const t=Array.from(e.keys());return t.length===0?void 0:t[t.length-1]}function fl(e,t){return e.every(n=>t[n])}function Qk(e,t){return e?Object.keys(e).reduce((n,a)=>(t[a]||(n[a]=!0),n),{}):{}}function eE(e,t){return e?bc(bc({},e),t):t}function tE(e){return e.reduce((t,n)=>(t[n]=!0,t),{})}function nE(e,t={}){var n;const a=(n=t.onUpdated)!=null?n:()=>{};let o=new Map;function r(){return Array.from(o.keys())}function s(){return r().reduce((v,A)=>(v[A]=!0,v),{})}function l(){const v=e();return r().map(A=>v[A])}function u(){const v=e();return r().reduce((A,x)=>(A[x]=v[x],A),{})}function i(){return Kp(o)}function c(){const v=Object.keys(e());return v.length>0&&v.every(A=>o.has(A))}function p(){return!!i()}function d(v,A=!1){aE(o,v,A),a()}function f(v,A=!1){const x=v.filter(I=>o.has(I));A?(x.length===v.length?x.forEach(I=>o.delete(I)):v.forEach(I=>o.set(I,!0)),a()):(o=new Map(v.map(I=>[I,!0])),a())}function h(v=!1){v&&c()?o.clear():o=new Map(Object.keys(e()).map(A=>[A,!0])),a()}function y(v){o.delete(v),a()}function k(){o.clear(),a()}function E(){return Array.from(o.entries())}function g(v){o=new Map(v),a()}return{getSelected:s,getSelectedList:r,getSelectedItemList:l,getSelectedItems:u,getLastSelected:i,isAllSelected:c,isAnySelected:p,select:d,multiSelect:f,selectAll:h,clear:y,clearAll:k,createSnapshot:E,restore:g}}function aE(e,t,n=!1){n?e.has(t)?e.delete(t):e.set(t,!0):(e.clear(),e.set(t,!0))}var oE=Object.defineProperty,rE=Object.defineProperties,sE=Object.getOwnPropertyDescriptors,_c=Object.getOwnPropertySymbols,lE=Object.prototype.hasOwnProperty,uE=Object.prototype.propertyIsEnumerable,Sc=(e,t,n)=>t in e?oE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Io=(e,t)=>{for(var n in t||(t={}))lE.call(t,n)&&Sc(e,n,t[n]);if(_c)for(var n of _c(t))uE.call(t,n)&&Sc(e,n,t[n]);return e},iE=(e,t)=>rE(e,sE(t));function cE(e,t,n={}){var a;const o=(a=n.onUpdated)!=null?a:()=>{};let r=new Map;function s(){return Array.from(r.entries()).reduce((g,[v,A])=>(g[v]=A,g),{})}function l(){return Kp(r)}function u(){return Array.from(r.entries()).filter(([,g])=>fl(t,g)).map(([g])=>g)}function i(){const g=Object.keys(e());return g.length>0&&g.every(v=>{const A=r.get(v);return A&&fl(t,A)})}function c(){return!!l()}function p(g,v,A=!1){dE(r,g,v,A),o()}function d(g,v=!1){fE(r,g,v),o()}function f(g=!1){g&&i()?r.clear():r=new Map(Object.keys(e()).map(v=>[v,tE(t)])),o()}function h(g,v){pE(r,g,v),o()}function y(){r.clear(),o()}function k(){return Array.from(r.entries())}function E(g){r=new Map(g),o()}return{getSelected:s,getLastSelected:l,getAllAttrsSelected:u,isAllSelected:i,isAnySelected:c,isAttrsSelected:g=>Yp(r,g),select:p,multiSelect:d,selectAll:f,clear:h,clearAll:y,createSnapshot:k,restore:E}}function dE(e,t,n,a=!1){if(!a)e.clear(),e.set(t,{[n]:!0});else{const o=e.get(t);if(o)if(o[n]){const r=Io({},o);delete r[n],zp(e,t,r)}else e.delete(t),e.set(t,iE(Io({},o),{[n]:!0}));else e.set(t,{[n]:!0})}}function fE(e,t,n=!1){const a=Gp(t);n?Yp(e,t)?a.forEach(([o,r])=>{zp(e,o,Qk(e.get(o),r))}):a.forEach(([o,r])=>{e.set(o,eE(e.get(o),r))}):(e.clear(),a.forEach(([o,r])=>{var s;e.set(o,Io(Io({},(s=e.get(o))!=null?s:{}),r))}))}function zp(e,t,n){Object.keys(n).length>0?e.set(t,n):e.delete(t)}function Yp(e,t){return Gp(t).every(([n,a])=>{const o=e.get(n);return o&&fl(Object.keys(a),o)})}function pE(e,t,n){const a=e.get(t);if(a)if(Object.keys(a).length===1)e.delete(t);else{const o=Io({},a);delete o[n],e.set(t,o)}}function ma(e,t){const n=H({}),a=H(),o=nE(t,{onUpdated:r});function r(){n.value=o.getSelected(),a.value=o.getLastSelected()}const s={select:`${e}_SELECT`,multiSelect:`${e}_MULTI_SELECT`,selectAll:`${e}_SELECT_ALL`,clearAll:`${e}_CLEAR_ALL`},l={getLabel:()=>`Select ${e}`,redo(E){const g=o.createSnapshot();return E.id?o.select(E.id,E.shift):o.clearAll(),g.map(([v])=>v)},undo(E){o.restore(E.map(g=>[g,!0]))}};function u(E,g=!1){return{name:s.select,args:{id:E,shift:g}}}function i(E,g=!1){const v=Object.keys(n.value).length;return!E&&v===0?!1:g?!0:!(a.value===E&&v===1)}const c={getLabel:()=>`Select ${e}`,redo(E){const g=o.createSnapshot();return o.multiSelect(E.ids,E.shift),g.map(([v])=>v)},undo(E){o.restore(E.map(g=>[g,!0]))}};function p(E,g=!1){return{name:s.multiSelect,args:{ids:E,shift:g}}}function d(E,g=!1){const v=Object.keys(n.value).sort(),A=v.length;return!(E.length===0&&A===0||!g&&E.length===A&&E.concat().sort().join(",")===v.join(","))}const f={getLabel:()=>`Select ${e}`,redo(E){const g=o.createSnapshot();return o.selectAll(E),g.map(([v])=>v)},undo(E){o.restore(E.map(g=>[g,!0]))}};function h(E=!1){return{name:s.selectAll,args:E}}const y={getLabel:()=>`Select ${e}`,redo(){const E=o.createSnapshot();return o.clearAll(),E.map(([g])=>g)},undo(E){o.restore(E.map(g=>[g,!0]))}};function k(){return{name:s.clearAll,args:void 0}}return{selectedMap:b(()=>n.value),lastSelectedId:b(()=>a.value),restore:o.restore,createSnapshot:o.createSnapshot,getSelectHistoryDryRun:i,getMultiSelectHistoryDryRun:d,reducers:{[s.select]:l,[s.multiSelect]:c,[s.selectAll]:f,[s.clearAll]:y},createSelectAction:u,createMultiSelectAction:p,createSelectAllAction:h,createClearAllAction:k}}function mE(e,t,n){const a=H({}),o=H(),r=H([]),s=cE(t,n,{onUpdated:l});function l(){a.value=s.getSelected(),o.value=s.getLastSelected(),r.value=s.getAllAttrsSelected()}const u={select:`${e}_SELECT`,multiSelect:`${e}_MULTI_SELECT`,selectAll:`${e}_SELECT_ALL`,clearAll:`${e}_CLEAR_ALL`},i={getLabel:()=>`Select ${e}`,redo(g){const v=s.createSnapshot();return g.id?s.select(g.id,g.attrKey,g.shift):s.clearAll(),v},undo(g){s.restore(g)}};function c(g,v,A=!1){return{name:u.select,args:{id:g,attrKey:v,shift:A}}}function p(g,v,A=!1){const x=Object.keys(a.value).length;if(!g&&x===0)return!1;if(A)return!0;if(o.value===g&&x===1){const I=a.value[g];if(Object.keys(I).length===1&&I[v])return!1}return!0}const d={getLabel:()=>`Select ${e}`,redo(g){const v=s.createSnapshot();return s.multiSelect(new Map(g.val),g.shift),v},undo(g){s.restore(g)}};function f(g,v=!1){return g=Array.isArray(g)?g:Object.entries(g),{name:u.multiSelect,args:{val:g,shift:v}}}const h={getLabel:()=>`Select ${e}`,redo(g){const v=s.createSnapshot();return s.selectAll(g),v},undo(g){s.restore(g)}};function y(g=!1){return{name:u.selectAll,args:g}}const k={getLabel:()=>`Select ${e}`,redo(){const g=s.createSnapshot();return s.clearAll(),g},undo(g){s.restore(g)}};function E(){return{name:u.clearAll,args:void 0}}return{selectedMap:b(()=>a.value),lastSelectedId:b(()=>o.value),allAttrsSelectedIds:b(()=>r.value),restore:s.restore,createSnapshot:s.createSnapshot,isAttrsSelected:s.isAttrsSelected,getSelectHistoryDryRun:p,reducers:{[u.select]:i,[u.multiSelect]:d,[u.selectAll]:h,[u.clearAll]:k},createSelectAction:c,createMultiSelectAction:f,createSelectAllAction:y,createClearAllAction:E}}function _n(e){const t=ha({byId:{},allIds:[]});function n(d){t.byId={...d.byId},t.allIds=d.allIds.concat()}const a={add:`${e}_ADD`,delete:`${e}_DELETE`,update:`${e}_UPDATE`,replace:`${e}_REPLACE`},o={getLabel:()=>`Add ${e}`,redo(d){return d.forEach(f=>{t.byId[f.id]=f,t.allIds.push(f.id)}),d.map(f=>f.id)},undo(d){d.forEach(h=>delete t.byId[h]);const f=$n(d,()=>!0);t.allIds=t.allIds.filter(h=>!f[h])}};function r(d){return{name:a.add,args:d}}const s={getLabel:()=>`Delete ${e}`,redo(d){const f=d.map(y=>({entity:t.byId[y],index:t.allIds.indexOf(y)})).sort((y,k)=>y.index-k.index);d.forEach(y=>delete t.byId[y]);const h=$n(d,()=>!0);return t.allIds=t.allIds.filter(y=>!h[y]),f},undo(d){d.forEach(f=>{t.byId[f.entity.id]=f.entity,t.allIds.splice(f.index,0,f.entity.id)})}};function l(d){return{name:a.delete,args:d}}const u={getLabel:()=>`Update ${e}`,redo:d=>{const f=tt(t.byId,d);return Object.entries(f).forEach(([h,y])=>t.byId[h]={...y,...d[h]}),f},undo:d=>{Object.entries(d).forEach(([f,h])=>t.byId[f]=h)}};function i(d,f){return{name:a.update,args:d,seriesKey:f}}const c={getLabel:()=>`Replace ${e}`,redo:d=>Hk(t,d.val,d.targets),undo:d=>{Wk(t,d)}};function p(d,f,h){return{name:a.replace,args:{val:d,targets:f},seriesKey:h}}return{init:n,entities:b(()=>t),reducers:{[a.add]:o,[a.delete]:s,[a.update]:u,[a.replace]:c},createAddAction:r,createDeleteAction:l,createUpdateAction:i,createReplaceAction:p}}function hE(e){const t=_n("Armature"),n=_n("Bone"),a=_n("Constraint"),o=ma("Armature",()=>t.entities.value.byId),r=mE("Bone",()=>i.value,["head","tail"]);e.defineReducers(t.reducers),e.defineReducers(n.reducers),e.defineReducers(a.reducers),e.defineReducers(o.reducers),e.defineReducers(r.reducers);const s=b(()=>nn(t.entities.value)),l=o.lastSelectedId,u=b(()=>l.value?t.entities.value.byId[l.value]:void 0),i=b(()=>{if(!u.value)return{};const Y=n.entities.value.byId;return ie(u.value.bones.map(pe=>Y[pe]))}),c=r.selectedMap,p=r.lastSelectedId,d=b(()=>p.value?n.entities.value.byId[p.value]:void 0),f=b(()=>{const Y=n.entities.value.byId;return ie(r.allAttrsSelectedIds.value.map(pe=>Y[pe]))}),h=b(()=>Yn(i.value,c.value)),y=b(()=>{const Y=a.entities.value.byId;return ie((ke(i.value)??[]).flatMap(pe=>pe.constraints.map(Ee=>Y[Ee])))}),k=b(()=>{const Y=n.entities.value.byId;return Q(ie(s.value),pe=>pe.bones.map(Ee=>Y[Ee]))});function E(Y,pe,Ee,me,ne){t.init(Ft(Y)),n.init(Ft(pe)),a.init(Ft(Ee)),o.restore(me),r.restore(ne),t.entities.value.allIds.length===0&&v(),l.value||o.restore([[t.entities.value.allIds[0],!0]])}function g(){return{armatures:s.value,bones:nn(n.entities.value),constraints:nn(a.entities.value),armatureSelected:o.createSnapshot(),boneSelected:r.createSnapshot()}}function v(){const Y=zn({id:"initial-bone",name:"bone",tail:{x:0,y:100}}),pe=ol({id:"initial-armature",name:"armature",bones:[Y.id]});t.init(Ft([pe])),n.init(Ft([Y])),o.restore([[pe.id,!0]]),r.restore([])}function A(Y=""){l.value!==Y&&e.dispatch(o.createSelectAction(Y),[r.createClearAllAction()])}function x(){if(l.value)A();else{const Y=t.entities.value.allIds[0];Y&&A(Y)}}function I(Y,pe){const Ee=zn({id:pe,name:"bone",tail:{x:0,y:100}},!pe),me=ol({id:Y,name:qt("armature",ke(t.entities.value.byId).map(ne=>ne.name)),bones:[Ee.id]},!Y);e.dispatch(t.createAddAction([me]),[o.createSelectAction(me.id),n.createAddAction([Ee]),r.createMultiSelectAction([[Ee.id,{head:!0,tail:!0}]])])}function O(){const Y=u.value;if(!Y)return;const pe=n.entities.value.byId;e.dispatch(t.createDeleteAction([Y.id]),[n.createDeleteAction(Y.bones),a.createDeleteAction(Y.bones.flatMap(Ee=>pe[Ee].constraints)),r.createClearAllAction()])}function T(Y){!Y||!u.value||u.value.name===Y||e.dispatch(t.createUpdateAction({[u.value.id]:{name:qt(Y,ke(t.entities.value.byId).map(pe=>pe.name))}}))}function L(Y){const pe=n.entities.value.byId;return t.entities.value.byId[Y].bones.map(Ee=>pe[Ee])}function R(){Object.keys(i.value).length!==0&&e.dispatch(r.createSelectAllAction(!0))}function B(Y="",pe={head:!0,tail:!0},Ee=!1,me=!1){if(u.value&&!(!d.value&&!Y)&&!(r.lastSelectedId.value===Y&&Object.keys(c.value).length===1&&!Ee&&Bf(c.value[Y],pe)))if(!Y)e.dispatch(r.createClearAllAction());else{let ne={};if(Ee){const we=c.value[Y]??{};Ki(we.head,pe.head)&&(ne.head=!0),Ki(we.tail,pe.tail)&&(ne.tail=!0)}else ne=pe;e.dispatch(r.createMultiSelectAction(g0(Mr({...Ee?_t(r.selectedMap.value,{[Y]:!0}):{},...Object.keys(ne).length>0?{[Y]:ne}:{}},Jf(ke(i.value),Y,ne,me)),Y)))}}function N(Y,pe=!1){Object.keys(Y).length===0&&!r.lastSelectedId.value||e.dispatch(r.createMultiSelectAction(Y,pe))}function j(Y,pe={head:!0,tail:!0},Ee,me=!1){Y&&(Ee!=null&&Ee.ctrl)&&d.value?N($n(c0(i.value,d.value.id,Y),()=>({head:!0,tail:!0})),!0):B(Y,pe,Ee==null?void 0:Ee.shift,me)}function K(Y){u.value&&D([zn({id:Y,name:qt("bone",ke(i.value).map(pe=>pe.name)),tail:{x:0,y:100}},!Y)],{head:!0,tail:!0})}function D(Y,pe,Ee){const me=u.value;me&&e.dispatch(n.createAddAction(Y),[t.createUpdateAction({[me.id]:{bones:me.bones.concat(Y.map(ne=>ne.id))}}),r.createMultiSelectAction(pe?Q(ie(Y),()=>pe):{}),...Ee?[a.createAddAction(Ee)]:[]])}function fe(){const Y=u.value;if(!Y)return;const pe=f.value,Ee=Object.keys(pe);e.dispatch(n.createDeleteAction(Ee),[n.createUpdateAction(mr(ke(i.value).filter(me=>!pe[me.id]))),t.createUpdateAction({[Y.id]:{bones:Y.bones.filter(me=>!pe[me])}}),a.createDeleteAction(Ee.flatMap(me=>pe[me].constraints)),r.createClearAllAction()])}function Le(){const Y=u.value;if(!Y)return;const pe=f.value,Ee=Object.keys(pe),me=q_(i.value,y.value,Object.keys(pe));e.dispatch(n.createDeleteAction(Ee),[n.createUpdateAction(me.bones),t.createUpdateAction({[Y.id]:{bones:Y.bones.filter(ne=>!pe[ne])}}),a.createDeleteAction(Ee.flatMap(ne=>pe[ne].constraints)),a.createUpdateAction(me.constraints),r.createClearAllAction()])}function Ge(Y,pe){u.value&&e.dispatch(n.createUpdateAction(Mr(Y,mr(ke(i.value).map(Ee=>({...Ee,...Y[Ee.id]})))),pe))}function vt(Y,pe){!u.value||!d.value||e.dispatch(n.createUpdateAction({[d.value.id]:V_(ke(i.value),{...d.value,...Y})},pe))}function $e(Y){!Y||!d.value||d.value.name===Y||e.dispatch(n.createUpdateAction({[d.value.id]:{name:qt(Y,ke(i.value).map(pe=>pe.name))}}))}function oe(Y,pe){if(!u.value||!d.value)return;const Ee=y.value,me=$n(d.value.constraints,V=>Ee[V]),ne=ie(Y),we=Y.filter(V=>!me[V.id]),$=d.value.constraints.filter(V=>!ne[V]),P=Y.filter(V=>me[V.id]),G=d.value.constraints,z=Y.map(V=>V.id);e.dispatch(a.createUpdateAction(ie(P),pe),[G.join(":")!==z.join(":")?n.createUpdateAction({[d.value.id]:{constraints:Y.map(V=>V.id)}}):void 0,we.length>0?a.createAddAction(we):void 0,$.length>0?a.createDeleteAction($):void 0].filter(V=>!!V))}function _e(Y,pe={},Ee){const me=u.value;if(!me)return;const[ne,we]=v0(Y,V=>!!i.value[V.id]),$=mr(ke({...i.value,...ie(Y)})),P=we.map(V=>$[V.id]?{...V,...$[V.id]}:V),G=ne.map(V=>$[V.id]?{...V,...$[V.id]}:V),z=y.value;e.dispatch(n.createAddAction(P),[t.createUpdateAction({[me.id]:{bones:me.bones.concat(P.map(V=>V.id))}}),n.createUpdateAction(ie(G)),r.createMultiSelectAction(pe),Ee?a.createAddAction(Ee.filter(V=>!z[V.id])):void 0,Ee?a.createUpdateAction(ie(Ee.filter(V=>z[V.id]))):void 0].filter(V=>!!V))}const De=H();function dt(Y){var pe,Ee,me;Y?((pe=Y.onstart)==null||pe.call(Y),De.value=Y):((me=(Ee=De.value)==null?void 0:Ee.oncancel)==null||me.call(Ee),De.value=void 0)}function Mt(Y){var pe,Ee,me;Y?(pe=De.value)==null||pe.callback(Y):(me=(Ee=De.value)==null?void 0:Ee.oncancel)==null||me.call(Ee),De.value=void 0}return{armatures:s,lastSelectedArmatureId:l,lastSelectedArmature:u,boneMap:i,selectedBones:c,lastSelectedBoneId:p,lastSelectedBone:d,allSelectedBones:f,selectedBonesOrigin:h,constraintMap:y,bonesByArmatureId:k,initState:E,exportState:g,createDefaultEntities:v,selectArmature:A,selectAllArmature:x,addArmature:I,deleteArmature:O,updateArmatureName:T,getBonesByArmatureId:L,selectAllBones:R,selectBone:j,selectBones:N,addBone:K,addBones:D,deleteBone:fe,dissolveBone:Le,updateBones:Ge,updateBone:vt,updateBoneName:$e,updateBoneConstraints:oe,upsertBones:_e,bonePicker:b(()=>De.value),setBonePicker:dt,pickBone:Mt}}const yE=hE(ea());function jt(){return yE}function Xp(e={},t=!1){const n=t?We():e.id??"";return{frame:0,targetId:"",name:"bone",points:{},...e,id:n}}function vE(e){return e.name==="bone"}function Hp(e={},t=!1){const n=t?We():e.id??"";return{frame:0,targetId:"",name:"constraint",points:{},...e,id:n}}function Ma(e={}){return{value:0,curve:Wp("linear"),...e}}function Wp(e){return gE(e)}function gE(e){return{name:e,controlIn:{x:-10,y:0},controlOut:{x:10,y:0}}}const Jp=[{label:"Constant",name:"constant"},{label:"Linear",name:"linear"},{label:"Bezier",name:"bezier3"}];function bE(e,t){if(e.length===0)return[];const n=e.findIndex(r=>t<=r.frame);if(n===-1)return[e[e.length-1]];const a=e[n];if(a.frame===t||n===0)return[a];const o=e[n-1];return o.frame===t?[o]:[o,a]}function _E(e,t,n){return SE(e,t)(n)}function xc(e){return{x:e.frame,y:e.keyframePoint.value}}function SE(e,t){const n=xc(e),a=xc(t);switch(e.keyframePoint.curve.name){case"constant":return xE(n);case"linear":return wE(n,a);case"bezier3":return kE(n,e.keyframePoint.curve.controlOut,t.keyframePoint.curve.controlIn,a)}}function xE(e){return()=>e.y}function wE(e,t){const n=t.x-e.x;return n===0?a=>a:a=>(a-e.x)/n*(t.y-e.y)+e.y}function kE(e,t,n,a){if(a.x-e.x===0)return s=>s;const r=Zp(e,t,n,a);return s=>eb(r,s)}function qp(e,t,n,a){const o=ee(t,e),r=ee(n,a);return[e,o,r,a]}function Zp(e,t,n,a){const o=qp(e,t,n,a);return[o[0],{x:Math.min(o[1].x,o[3].x),y:o[1].y},{x:Math.max(o[2].x,o[0].x),y:o[2].y},o[3]]}function Oa(e,t,n){const a=e.filter(r=>n(r)),o=bE(a,t);if(o.length!==0)return o.length===1?n(o[0]).value:_E({frame:o[0].frame,keyframePoint:n(o[0])},{frame:o[1].frame,keyframePoint:n(o[1])},t)}function _u(e,t){return Q(e,n=>Qp(n,t))}function Qp(e,t){const n=Oa(e,t,EE)??0,a=Oa(e,t,CE)??0,o=Oa(e,t,ME)??0,r=Oa(e,t,OE)??1,s=Oa(e,t,TE)??1;return{translate:{x:n,y:a},rotate:o,scale:{x:r,y:s},origin:{x:0,y:0}}}function EE(e){return e.points.translateX}function CE(e){return e.points.translateY}function ME(e){return e.points.rotate}function OE(e){return e.points.scaleX}function TE(e){return e.points.scaleY}function $E(e){return{props:{translateX:e(),translateY:e(),rotate:e(),scaleX:e(),scaleY:e()}}}function em(e,t,n,a={},o=!1){return Xp({frame:e,targetId:t,points:{...a.translateX?{translateX:Ma({value:n.translate.x})}:{},...a.translateY?{translateY:Ma({value:n.translate.y})}:{},...a.rotate?{rotate:Ma({value:n.rotate})}:{},...a.scaleX?{scaleX:Ma({value:n.scale.x})}:{},...a.scaleY?{scaleY:Ma({value:n.scale.y})}:{}}},o)}const AE=Object.freeze(Object.defineProperty({__proto__:null,getInterpolatedTransformMapByTargetId:_u,getKeyframeDefaultPropsMap:$E,interpolateKeyframe:Qp,makeKeyframe:em},Symbol.toStringTag,{value:"Module"}));function pl(e,t,n){const a=Su(t,n);return Q(e,o=>a[o.id]?{...o,option:{...o.option,...a[o.id]}}:o)}function Su(e,t){return Q(e,n=>tm(n,t))}function tm(e,t){return{influence:lt(0,1,Oa(e,t,IE)??1)}}function IE(e){return e.points.influence}function PE(e){return{props:{influence:e()}}}function nm(e,t,n,a={},o=!1){return Hp({frame:e,targetId:t,points:{...a.influence?{influence:Ma({value:n.option.influence})}:{}}},o)}const BE=Object.freeze(Object.defineProperty({__proto__:null,getInterpolatedConstraintMap:pl,getInterpolatedOptionMapByTargetId:Su,getKeyframeDefaultPropsMap:PE,interpolateKeyframe:tm,makeKeyframe:nm},Symbol.toStringTag,{value:"Module"}));function LE(e){switch(e){case"bone":return AE;case"constraint":return BE}}function Ir(e){return{props:Q(e.points,()=>!0)}}function am(e){return e?Object.values(e.props).some(t=>t):!1}function xu(e,t){return t?Object.keys(e.points).every(n=>t.props[n]):!1}function RE(e,t){if(xu(e,t))return{selected:e};if(!am(t))return{notSelected:e};const n={...e,points:{...e.points}},a={...e,points:{...e.points}};return Object.keys(e.points).forEach(o=>{t.props[o]?delete a.points[o]:delete n.points[o]}),{selected:n,notSelected:a}}function jE(e,t,n=!1){const a={...t,points:{...t.points},id:n?e.id:t.id};return Object.keys(e.points).forEach(o=>{e.points[o]&&!t.points[o]&&(a.points[o]=e.points[o])}),a}function wc(e,t){if(!t)return e;if(xu(e,t))return;const n={...e,points:{...e.points}};return Object.keys(e.points).forEach(a=>{t.props[a]&&delete n.points[a]}),n}function om(e,t="bone"){const n=rm(()=>[],t);return e.forEach(a=>{Object.keys(a.points).forEach(o=>{a.points[o]&&n.props[o]&&n.props[o].push(a)})}),n}function Po(e){const t={props:{}};return e.forEach(n=>{Object.keys(n.points).forEach(a=>{var o;n.points[a]&&((o=t.props)[a]??(o[a]=[])).push(n)})}),t}function rm(e,t="bone"){return LE(t).getKeyframeDefaultPropsMap(e)}function NE(e){return Object.keys(e).reduce((t,n)=>(t[n]=e[n].reduce((a,o,r)=>(a[o.frame]={props:VE(e[n],r)},a),{}),t),{})}function VE(e,t){const n=e.slice(t);if(n.length<1)return{};const a=n[0],o=om(n,a.name),r={};return Object.keys(a.points).forEach(s=>{r[s]=DE(o.props[s],l=>l.points[s])}),r}function DE(e,t){if(e.length<2)return 0;const n=e[0],a=e[1],o=t(n),r=t(a);return o&&r&&FE(o,r)?a.frame-n.frame:0}function FE(e,t){return e.value===t.value}function UE(e,t,n){return Q(e,(a,o)=>{const r=t[o];return r?sm(a,r,n):a})}function sm(e,t,n){return{...e,points:Q(e.points,(a,o)=>t.props[o]?n(a):a)}}function lm(e={name:"bone"},t=!1){switch(e.name){case"bone":return Xp({...e,name:"bone"},t);case"constraint":return Hp({...e,name:"constraint"},t)}}function um(e,t){const n={},a={};return Object.keys(t).forEach(o=>{const r=t[o],s=e[o];if(!s)return;const l=RE(s,r);l.selected&&(n[o]=l.selected),l.notSelected&&(a[o]=l.notSelected)}),{selected:n,notSelected:a}}function GE(e,t){return{...e,frame:e.frame+t.x,points:{...Q(e.points,n=>({...n,value:n.value+t.y}))}}}function KE(e,t){const n={},a={};return Object.keys(e).forEach(o=>{const r=e[o],s={},l={};Object.keys(r.props).forEach(u=>{(t(o,u)?s:l)[u]=r.props[u]}),Object.keys(s).length>0&&(n[o]={...r,props:s}),Object.keys(l).length>0&&(a[o]={...r,props:l})}),{trueMap:n,falseMap:a}}function im(e){const t={},n={};return Object.keys(e).forEach(a=>{const o=e[a][0];if(o)switch(o.name){case"bone":t[a]=e[a];return;case"constraint":n[a]=e[a];return}}),{bone:t,constraint:n}}function zE(e,t,n){const a={};return Object.entries(e).forEach(([o,r])=>{if(t[0]<=r.frame&&r.frame<=t[1]){const s={};Object.entries(r.points).forEach(([l,u])=>{n[0]<=u.value&&u.value<=n[1]&&(s[l]=!0)}),Object.keys(s).length>0&&(a[o]={props:s})}}),a}function cm(e){return Math.round(Math.log(e)/Math.log(ql))}function YE(e){const t=Math.round(cm(e)/2)+1;return Math.round(t/5)*5+5}function XE(e,t){const n=Math.round(cm(t)/2)+1;return(Math.round(n/3)+1)*HE(e)}function HE(e){return e>7?5:e>5?10:e>3?15:e>2?20:e>1.5?25:e>1?50:100}function ml(e){return Math.round(wu(e))}function wu(e){return e/yn}function dm(e){return e*yn}function WE(e,t){return e/t}function fm(e,t,n=!1){return{x:n?wu(e.x):ml(e.x),y:WE(e.y,t)}}function JE(e,t){const n=Math.floor(Math.max(t,0)/yn);return n-n%(e*2)}function qE(e,t,n){const a=Math.floor(n/e);return a-a%t-(a>0?0:t)}function Zn(e){return Sa(e,"frame")}function Ka(e){return ZE(Sa(e,"targetId"))}function pm(e){return e.concat().sort((t,n)=>t.frame-n.frame)}function ZE(e){return Q(e,pm)}function QE(e,t){if(e.length===0)return e;const n=pm(e)[0].frame;return e.map(a=>({...a,frame:a.frame+(t-n)}))}function eC(e){const t=Zn(e);return Object.values(t).map(n=>{const a=Sa(n,"targetId");return Object.values(a).map(o=>{const[r,...s]=o;return s.reduce((l,u)=>(Object.assign(l.points,u.points),l),{...r,points:{...r.points}})})}).flat()}function mm(e,t,n=!1){const a=eC(t),o=ie(e),r=ie(a),s=Zn(ke(_t(o,r))),l=Zn(a),u=_t(l,s),i=tt(o,r),c=ke(i);return{merged:ke({...Q(s,(d,f)=>{c.push(...i0(d,l[f]??[],"targetId",!0));const h=xn(d,"targetId"),y=xn(l[f]??[],"targetId");return n?Object.keys({...h,...y}).reduce((k,E)=>{if(!y[E])k.push(h[E]);else if(!h[E])k.push(y[E]);else{const g=jE(h[E],y[E]);k.push(g)}return k},[]):l[f]?u0(d,l[f]??[],"targetId"):d}),...u}).flat(),dropped:c}}function tC(e,t,n,a){const o=ie(t),r=Q(ie(e),f=>f.keyframes.map(h=>o[h])),s=ie(n),l=ie(a),u=Q(s,f=>f.bones.map(h=>l[h])),i=e.filter(f=>!!s[f.armatureId]),c=i.flatMap(f=>nC(r[f.id],[...u[f.armatureId],...u[f.armatureId].flatMap(h=>h.constraints.map(y=>({id:y})))])),p=ie(c);return{actions:i.map(f=>({...f,keyframes:f.keyframes.filter(h=>p[h])})),keyframes:c}}function nC(e,t){return ke(tt(Ka(e),ie(t))).flat()}function aC(e,t){const n=Object.keys(Zn(e)).map(a=>parseInt(a)).filter(a=>t<a);return n.length>0?n[0]:t}function oC(e,t){const n=Object.keys(Zn(e)).map(a=>parseInt(a)).filter(a=>a<t);return n.length>0?n[n.length-1]:t}function rC(e){return e.reduce((t,n)=>Math.max(t,n.frame),0)}function sC(e,t,n,a=!1){return t===0?0:va(0,t,e+(a?-1:1)*n)}function lC(e,t){return Object.keys(e).reduce((n,a)=>{const o=t(a);return o&&(n[a]=Wf(e[a],o)),n},{})}function uC(e,t){return t?{...e,option:{...e.option,influence:t.influence??e.option.influence}}:e}function iC(e,t){return t?{...e,points:Q(e.points,(n,a)=>{if(n)return{...n,value:t[a]??n.value}})}:e}function cC(e,t){return Object.keys(e).reduce((n,a)=>{const o=dC(e[a],t[a]);return E0(o)||(n[a]=o),n},{})}function dC(e,t){if(!t||!vE(t))return e;const n=t.points.translateX?0:e.translate.x,a=t.points.translateY?0:e.translate.y,o=t.points.scaleX?0:e.scale.x,r=t.points.scaleY?0:e.scale.y,s=t.points.rotate?0:e.rotate;return ve({translate:{x:n,y:a},scale:{x:o,y:r},rotate:s,origin:e.origin})}function Pr(e,t,n=(a,o)=>a===o){const a=H(t());function o(i){a.value=i}function r(){return a.value}const s={update:`${e}_UPDATE`},l={getLabel:()=>`Update ${e}`,redo(i){const c=a.value;return a.value=i,c},undo(i){a.value=i}};function u(i,c){if(!n(a.value,i))return{name:s.update,args:i,seriesKey:c}}return{state:b(()=>a.value),restore:o,createSnapshot:r,reducers:{[s.update]:l},createUpdateAction:u}}function fC(e=0,t=60){const n=Pr("Frame",()=>e),a=Pr("End Frame",()=>t),o=H("pause");function r(f=0,h=60){n.restore(f),a.restore(h)}function s(f){o.value=f}function l(){o.value=o.value==="pause"?"play":"pause"}function u(){return n.createUpdateAction(0)}function i(){return n.createUpdateAction(a.state.value)}function c(f,h=!1,y){return n.createUpdateAction(sC(n.state.value,a.state.value,f,h),y)}function p(f){return n.createUpdateAction(aC(f,n.state.value))}function d(f){return n.createUpdateAction(oC(f,n.state.value))}return{currentFrame:n.state,endFrame:a.state,restore:r,createUpdateCurrentFrameAction:n.createUpdateAction,createUpdateEndFrameAction:a.createUpdateAction,playing:b(()=>o.value),setPlaying:s,togglePlaying:l,createJumpStartFrameAction:u,createJumpEndFrameAction:i,createStepFrameAction:c,createJumpNextKeyAction:p,createJumpPrevKeyAction:d,reducers:{...n.reducers,...a.reducers}}}function pC(e,t){const a=H({}),o=H("");function r(O){o.value=O.length>0?O[O.length-1][0]:"",l(O.reduce((T,[L,R])=>(T[L]=R,T),{}))}function s(){const O=o.value,T=Object.entries(a.value);return O?T.filter(([L])=>L!==O).concat([[O,a.value[O]]]):T}function l(O){a.value=O}function u(O){a.value=_t({...a.value,...O.toUpsert},$n(O.toDelete,()=>!0)),o.value=O.lastSelectedId}function i(O={}){l(O);const T=Object.keys(O);o.value=T.length>0?T[0]:""}const c={select:`${e}_SELECT`,multiSelect:`${e}_MULTI_SELECT`,selectAll:`${e}_SELECT_ALL`,filter:`${e}_FILTER`,drop:`${e}_DROP`,clearAll:`${e}_CLEAR_ALL`},p={getLabel:()=>`Select ${e}`,redo(O){var R;const T=a.value,L={lastSelectedId:o.value,...T[O.id]?{toUpsert:{[O.id]:T[O.id]},toDelete:[]}:{toUpsert:{},toDelete:[O.id]}};if(O.shift){const B=If((R=T[O.id])==null?void 0:R.props,O.propsState.props);l(Pf(T,O.id,B?{props:B}:void 0)),o.value=B?O.id:""}else l(Cr(T,t(),()=>O.id?{[O.id]:O.propsState}:{})),o.value=O.id;return L},undo(O){u(O)}};function d(O,T,L=!1){return{name:c.select,args:{id:O,propsState:T,shift:L}}}const f={getLabel:()=>`Select ${e}`,redo(O){var L,R;const T={map:{...a.value},lastSelectedId:o.value};return O.shift?yC(a.value,O.selectedTargetMap)?(l(_t(a.value,O.selectedTargetMap)),o.value=""):(l({...a.value,...Q(O.selectedTargetMap,(B,N)=>{var j;return{props:{...((j=a.value[N])==null?void 0:j.props)??{},...Ls(B).props}}})}),o.value=((L=Gi(O.selectedTargetMap))==null?void 0:L.id)??""):(l({..._t(a.value,t()),...Q(O.selectedTargetMap,Ls)}),o.value=((R=Gi(O.selectedTargetMap))==null?void 0:R.id)??""),T},undo(O){l(O.map),o.value=O.lastSelectedId}};function h(O,T=!1){return{name:c.multiSelect,args:{selectedTargetMap:O,shift:T}}}const y={getLabel:()=>`Select ${e}`,redo(O){const T={map:{...a.value},lastSelectedId:o.value},L=_t(a.value,t());return l(Q({...O,...L},(R,B)=>O[B]?mC(Ls(O[B]),a.value[B]):a.value[B])),o.value=Object.keys(O)[0]??"",T},undo(O){l(O.map),o.value=O.lastSelectedId}};function k(O){return{name:c.selectAll,args:O}}const E={getLabel:()=>`Filter ${e}`,redo(O){const T={map:{...a.value},lastSelectedId:o.value};return l(Cr(a.value,t(),L=>tt(L,O))),T},undo(O){l(O.map),o.value=O.lastSelectedId}};function g(O={}){return{name:c.filter,args:O}}const v={getLabel:()=>`Drop ${e}`,redo(O){const T=o.value,L=tt(a.value,O);return l(_t(a.value,O)),O[o.value]&&(o.value=""),{toUpsert:L,toDelete:[],lastSelectedId:T}},undo(O){u(O)}};function A(O={}){return{name:c.drop,args:O}}const x={getLabel:()=>`Select ${e}`,redo(){const O={map:{...a.value},lastSelectedId:o.value};return l({}),o.value="",O},undo(O){l(O.map),o.value=O.lastSelectedId}};function I(){return{name:c.clearAll,args:void 0}}return{init:i,selectedStateMap:b(()=>a.value),lastSelectedId:b(()=>o.value),restore:r,createSnapshot:s,reducers:{[c.select]:p,[c.multiSelect]:f,[c.selectAll]:y,[c.filter]:E,[c.drop]:v,[c.clearAll]:x},createSelectAction:d,createMultiSelectAction:h,createSelectAllAction:k,createFilterAction:g,createDropAction:A,createClearAllAction:I}}function Ls(e){return{props:Q(e.points,()=>!0)}}function mC(e,t){return t?{props:{...e.props,...t.props}}:e}function hC(e,t){return t?p0(Q(e.points,()=>!0),t.props):!1}function yC(e,t={}){return Object.keys(e).length===0?!1:Object.keys(t).every(n=>hC(t[n],e[n]))}function kc(e){const t=H({});function n(u={}){t.value=u}const a={upsert:`${e}_UPSERT`,set:`${e}_SET`},o={getLabel:()=>`Upsert ${e}`,redo(u){const i=Object.keys(_t(u,t.value)),c=tt(t.value,u);return t.value={...t.value,...u},{created:i,updated:c}},undo(u){t.value=_t({...t.value,...u.updated},$n(u.created,()=>!0))}};function r(u,i){return{name:a.upsert,args:u,seriesKey:i}}const s={getLabel:()=>`Set ${e}`,redo(u){const i=t.value;return t.value=u,i},undo(u){t.value=u}};function l(u,i){return{name:a.set,args:u,seriesKey:i}}return{state:b(()=>t.value),init:n,reducers:{[a.upsert]:o,[a.set]:s},createUpsertAction:r,createSetAction:l}}function vC(e,t){const a=H({});function o(x){a.value=x}function r(x){o(x.reduce((I,[O,T])=>(I[O]=T,I),{}))}function s(){return Object.entries(a.value)}function l(x){a.value=_t({...a.value,...x.toUpsert},$n(x.toDelete,()=>!0))}function u(x={}){o(x)}const i={select:`${e}_SELECT`,selectAll:`${e}_SELECT_ALL`,filter:`${e}_FILTER`,drop:`${e}_DROP`,clearAll:`${e}_CLEAR_ALL`};function c(x,I,O=!1,T=!1){const L=Object.keys(a.value).length;return L===0?!!x:L===1&&x&&a.value[x]&&Bf(a.value[x].props,I.props)?O&&!T:!0}const p={getLabel:()=>`Select ${e}`,redo(x){var T,L;const I=a.value,O=I[x.id]?{toUpsert:{[x.id]:I[x.id]},toDelete:[]}:{toUpsert:{},toDelete:[x.id]};if(x.shift){const R=x.notToggle?{...((T=I[x.id])==null?void 0:T.props)??{},...x.propsState.props}:If((L=I[x.id])==null?void 0:L.props,x.propsState.props);o(Pf(I,x.id,R?{props:R}:void 0))}else o(Cr(I,t(),()=>x.id?{[x.id]:x.propsState}:{}));return O},undo(x){l(x)}};function d(x,I,O=!1,T=!1){return{name:i.select,args:{id:x,propsState:I,shift:O,notToggle:T}}}const f={getLabel:()=>`Select ${e}`,redo(x){const I={...a.value};return o(Q({...a.value,...x},(O,T)=>x[T]?bC(gC(x[T]),a.value[T]):a.value[T])),I},undo(x){o(x)}};function h(x){return{name:i.selectAll,args:x}}const y={getLabel:()=>`Filter ${e}`,redo(x){const I={...a.value};return o(Cr(a.value,t(),O=>tt(O,x))),I},undo(x){o(x)}};function k(x={}){return{name:i.filter,args:x}}const E={getLabel:()=>`Drop ${e}`,redo(x){const I=tt(a.value,x);return o(_t(a.value,x)),{toUpsert:I,toDelete:[]}},undo(x){l(x)}};function g(x={}){return{name:i.drop,args:x}}const v={getLabel:()=>`Select ${e}`,redo(){const x={...a.value};return o({}),x},undo(x){o(x)}};function A(){return{name:i.clearAll,args:void 0}}return{init:u,restore:r,createSnapshot:s,selectedStateMap:b(()=>a.value),selectDryRun:c,reducers:{[i.select]:p,[i.selectAll]:f,[i.filter]:y,[i.drop]:E,[i.clearAll]:v},createSelectAction:d,createSelectAllAction:h,createFilterAction:k,createDropAction:g,createClearAllAction:A}}function gC(e){return{props:Q(e.props,()=>"selected")}}function bC(e,t){return t?{props:{...e.props,...t.props}}:e}function _C(e,t,n){const a=_n("Action"),o=_n("Keyframe"),r=ma("Action",()=>a.entities.value.byId),s=fC(),l=kc("BonePose"),u=kc("ConstraintPose"),i=vC("PoseTarget",()=>v.value),c=pC("Keyframe",()=>O.value);e.defineReducers(a.reducers),e.defineReducers(o.reducers),e.defineReducers(r.reducers),e.defineReducers(s.reducers),e.defineReducers(l.reducers),e.defineReducers(u.reducers),e.defineReducers(i.reducers),e.defineReducers(c.reducers);const p=b(()=>nn(a.entities.value)),d=r.lastSelectedId,f=b(()=>d.value?a.entities.value.byId[d.value]:void 0),h=l.state,y=u.state,k=b(()=>{var be;const X=o.entities.value.byId;return((be=f.value)==null?void 0:be.keyframes.map(Ie=>X[Ie]))??[]}),E=b(()=>Zn(k.value)),g=b(()=>Ka(k.value)),v=b(()=>({...t.boneMap.value,...t.constraintMap.value})),A=b(()=>tt(g.value,v.value)),x=b(()=>tt(g.value,{...oe.value,...Y.value})),I=b(()=>({...Q(oe.value,()=>({type:"bone"})),...Q(Y.value,()=>({type:"constraint"}))})),O=b(()=>ie(Of(x.value)));function T(X,be,Ie,je,Ye,bt,Nt){s.setPlaying("pause"),s.restore(X,be),a.init(Ft(Ie)),o.init(Ft(je)),r.restore(Ye),l.init(),u.init(),c.restore(bt),i.restore(Nt)}function L(){return{currentFrame:s.currentFrame.value,endFrame:s.endFrame.value,actions:p.value,keyframes:nn(o.entities.value),actionSelected:r.createSnapshot(),keyframeState:c.createSnapshot(),targetPropsState:i.createSnapshot()}}const R=b(()=>tt(O.value,c.selectedStateMap.value)),B=b(()=>Object.keys(R.value).length>0),N=b(()=>R.value[c.lastSelectedId.value]),j=b(()=>tt(i.selectedStateMap.value,I.value)),K=b(()=>im(g.value)),D=b(()=>pl(t.constraintMap.value,K.value.constraint,s.currentFrame.value)),fe=b(()=>Object.keys(y.value).length===0?D.value:pl(t.constraintMap.value,Q(K.value.constraint,X=>X.map(be=>iC(be,y.value[be.targetId]))),s.currentFrame.value)),Le=b(()=>_u(A.value,s.currentFrame.value)),Ge=b(()=>m0(Object.keys(h.value).concat(Object.keys(g.value)))),vt=b(()=>Ge.value.reduce((X,be)=>(X[be]=Ga($(be),P(be)),X),{})),$e=b(()=>t.lastSelectedArmature.value?au(Q(t.boneMap.value,X=>({...X,transform:G(X.id)})),fe.value):{}),oe=b(()=>Q(Je(t.selectedBones.value,X=>Nf(X)),()=>!0)),_e=b(()=>Q(oe.value,(X,be)=>t.boneMap.value[be])),De=b(()=>F_($e.value,t.selectedBones.value)),dt=b(()=>t.lastSelectedArmature.value?tu(De.value):{x:0,y:0}),Mt=b(()=>{const X=t.constraintMap.value;return Q(_e.value,be=>be.constraints.map(Ie=>({...X[Ie],boneId:be.id})))}),Y=b(()=>ie(ke(Mt.value).flat().filter(X=>g.value[X.id])));function pe(X){e.dispatch(l.createSetAction(X))}function Ee(X){pe(Q({...h.value,...X},(be,Ie)=>X[Ie]?Ga(P(Ie),X[Ie]):P(Ie)))}function me(X,be){e.dispatch(u.createSetAction(X,be))}function ne(X,be){me(Mr(y.value,X),be)}function we(X,be){e.dispatch(l.createSetAction({...h.value,...lC(X,Ie=>{if(I.value[Ie])return $(Ie)})},be))}function $(X){return Le.value[X]??ve()}function P(X){return h.value[X]??ve({scale:{x:0,y:0}})}function G(X){return vt.value[X]??ve()}function z(X){X&&e.dispatch(X,[l.createSetAction({}),u.createSetAction({})])}function V(X,be){z(s.createUpdateCurrentFrameAction(X,be))}function te(){z(s.createJumpStartFrameAction())}function ge(){z(s.createJumpEndFrameAction())}function ae(X,be=!1,Ie){z(s.createStepFrameAction(X,be,Ie))}function re(){z(s.createJumpNextKeyAction(k.value))}function Z(){z(s.createJumpPrevKeyAction(k.value))}function Oe(X,be){e.dispatch(s.createUpdateEndFrameAction(X,be))}function xe(X){d.value!==X&&e.dispatch(r.createSelectAction(X),[c.createClearAllAction()])}function Te(X){if(!t.lastSelectedArmature.value)return;const be=jf({id:X,name:qt("action",p.value.map(Ie=>Ie.name)),armatureId:t.lastSelectedArmature.value.id},!X);e.dispatch(a.createAddAction([be]),[c.createClearAllAction(),r.createSelectAction(be.id)])}function U(X){d.value&&e.dispatch(a.createUpdateAction({[d.value]:X}))}function q(){const X=f.value;X&&e.dispatch(a.createDeleteAction([X.id]),[o.createDeleteAction(X.keyframes),c.createClearAllAction()])}function le(X,be,Ie=!1){if(!(!X&&!B.value))if(X){const[je,...Ye]=Ph(X,be,Ie);e.dispatch(je,Ye)}else{const[je,...Ye]=Vu();e.dispatch(je,Ye)}}function de(X={},be=!1){const Ie=Object.keys(X).length>0;if(!(!Ie&&!B.value))if(Ie)e.dispatch(c.createMultiSelectAction(Q(X,(je,Ye)=>({id:Ye,points:Q(je.props,()=>!0)})),be),[i.createClearAllAction()]);else{const[je,...Ye]=Vu();e.dispatch(je,Ye)}}function Re(){Object.keys(R.value).length===Object.keys(O.value).length&&Object.keys(R.value).every(X=>xu(O.value[X],c.selectedStateMap.value[X]))?B.value&&le(""):e.dispatch(Ih())}function Xe(X={}){f.value||Te();const be=Object.keys(oe.value).map(Ye=>em(s.currentFrame.value,Ye,G(Ye),X,!0)),[Ie,...je]=vs(be);e.dispatch(Ie,je)}function gt(){if(!B.value)return;const[X,...be]=Du(c.selectedStateMap.value);e.dispatch(X,be)}function Ot(X,be){const[Ie,...je]=Bh(X,s.currentFrame.value,be);e.dispatch(Ie,je)}function qe(X){const be=fe.value[X];if(be)return uC(be,y.value[be.id])}function rt(X,be={}){if(Object.keys(oe.value).length===0)return;f.value||Te();const Ie=qe(X);if(!Ie)return;const je=nm(s.currentFrame.value,X,Ie,be,!0),[Ye,...bt]=vs([je]);e.dispatch(Ye,bt)}function ft(X,be={}){if(!B.value)return;const[Ie,...je]=Du({[X]:{props:be}});e.dispatch(Ie,je)}function Kt(X,be){const[Ie,...je]=gs(ke(X),!0,be);e.dispatch(Ie,je)}function zo(X){const[be,...Ie]=vs(QE(X.filter(je=>t.boneMap.value[je.targetId]).map(je=>h0(je)),s.currentFrame.value));e.dispatch(be,Ie)}function ju(X,be=[]){if(X.length===0){Kt(ie(be));return}const[Ie,...je]=gs([...X,...be],!0),Ye=Sa(X,"frame"),bt={};be.forEach(Nt=>{const ao=xn(Ye[Nt.frame]??[],"targetId")[Nt.targetId];bt[(ao==null?void 0:ao.id)??Nt.id]=Nt}),e.dispatch(Ie,[...je,c.createMultiSelectAction(bt)])}function Mh(X,be,Ie=!1){i.selectDryRun(X,be,Ie)&&e.dispatch(i.createSelectAction(X,be,Ie))}const to=H(),no=H(),Nu=b(()=>{const X=um(O.value,tt(c.selectedStateMap.value,O.value));return{selected:X.selected,notSelected:f0(X.notSelected)}}),Yo=b(()=>{if(to.value){const X=fm(Ce(to.value.current,to.value.start),(n==null?void 0:n.graphValueWidth())??1);return{selected:Q(Nu.value.selected,be=>GE(be,X)),notSelected:{...Nu.value.notSelected,...no.value??{}}}}else return no.value?{selected:no.value,notSelected:{}}:void 0});function Oh(){return to.value}function Th(X){to.value=X}function $h(){Yo.value&&ju(ke(Yo.value.notSelected),ke(Yo.value.selected)),no.value=void 0}function Ah(X){no.value=X}return{initState:T,exportState:L,actions:p,actionMap:b(()=>ie(p.value)),keyframes:k,selectedKeyframeMap:c.selectedStateMap,lastSelectedKeyframe:N,keyframeMapByFrame:E,keyframeMapByTargetId:g,visibledKeyframeMap:O,visibledSelectedKeyframeMap:R,selectedConstraintMap:Y,selectedTargetIdMap:I,visibledTargetPropsStateMap:j,posedTargetIds:Ge,currentPosedBones:$e,selectedBoneIdMap:oe,selectedBoneMap:_e,selectedBones:De,selectedPosedBoneOrigin:dt,getBoneEditedTransforms:P,getCurrentSelfTransforms:G,currentInterpolatedConstraintMap:fe,originalInterpolatedConstraintMap:D,applyEditedTransforms:Ee,applyEditedConstraint:ne,pastePoses:we,playing:s.playing,setPlaying:s.setPlaying,togglePlaying:s.togglePlaying,currentFrame:s.currentFrame,setCurrentFrame:V,jumpStartFrame:te,jumpEndFrame:ge,jumpNextKey:re,jumpPrevKey:Z,stepFrame:ae,endFrame:s.endFrame,setEndFrame:Oe,selectedAction:f,selectAction:xe,addAction:Te,updateAction:U,deleteAction:q,selectKeyframe:le,selectKeyframes:de,selectAllKeyframes:Re,execInsertKeyframe:Xe,execDeleteKeyframes:gt,execDeleteTargetKeyframe:Ot,execInsertKeyframeConstraint:rt,execDeleteKeyframeConstraint:ft,execUpdateKeyframes:Kt,pasteKeyframes:zo,upsertKeyframes:ju,selectTargetProp:Mh,editedKeyframeMap:Yo,getEditMovement:Oh,setEditMovement:Th,completeEdit:$h,setTmpKeyframes:Ah};function Ih(){return c.createSelectAllAction(O.value)}function Vu(){return[c.createFilterAction(),i.createDropAction(Os(ke(O.value)))]}function Ph(X,be,Ie=!1){const je=O.value[X],Ye=be??Ir(je);return[c.createSelectAction(X,Ye,Ie),i.createSelectAction(je.targetId,{props:Q(Ye.props,()=>"selected")},Ie,!0)]}function vs(X,be=!1){return[...gs(X,!be),l.createSetAction(cC(h.value,Os(X))),c.createSelectAllAction(ie(X)),i.createDropAction(Os(ke(O.value)))]}function gs(X,be=!1,Ie){const je=O.value,{merged:Ye,dropped:bt}=mm(ke(je),X,be),Nt=ie(Ye),Fu=_t(Nt,je),ao=tt(Nt,je),bs=_t(ie(bt),Nt),Uu=ke(Fu);return[{...o.createAddAction(Uu),seriesKey:Ie},o.createDeleteAction(ke(bs).map(oo=>oo.id)),o.createUpdateAction(ao),a.createUpdateAction({[f.value.id]:{keyframes:f.value.keyframes.filter(oo=>!bs[oo]).concat(Uu.map(oo=>oo.id))}}),c.createDropAction(bs)]}function Du(X){const be=O.value,Ie=tt(be,X),je={},Ye={};return ke(Ie).forEach(bt=>{const Nt=wc(bt,X[bt.id]);Nt?je[Nt.id]=Nt:Ye[bt.id]=!0}),[o.createUpdateAction(je),o.createDeleteAction(Object.keys(Ye)),a.createUpdateAction({[f.value.id]:{keyframes:f.value.keyframes.filter(bt=>!Ye[bt])}}),c.createClearAllAction()]}function Bh(X,be,Ie){const je=ke(O.value).find(bt=>bt.targetId===X&&bt.frame===be);if(!je)return[];const Ye=wc(je,{props:{[Ie]:!0}});return Ye?[o.createUpdateAction({[Ye.id]:Ye}),c.createClearAllAction()]:[o.createDeleteAction([je.id]),a.createUpdateAction({[f.value.id]:{keyframes:f.value.keyframes.filter(bt=>bt!==je.id)}}),c.createClearAllAction()]}}const{settings:SC}=Ct(),xC=_C(ea(),jt(),{graphValueWidth:()=>SC.graphValueWidth});function cn(){return xC}function wC(e){const t=_n("Actor"),n=_n("Element"),a=ma("Element",()=>n.entities.value.byId),o=ma("Actor",()=>t.entities.value.byId);e.defineReducers(t.reducers),e.defineReducers(n.reducers),e.defineReducers(o.reducers),e.defineReducers(a.reducers);const r=b(()=>nn(t.entities.value)),s=o.lastSelectedId,l=b(()=>s.value?t.entities.value.byId[s.value]:void 0),u=a.selectedMap,i=a.lastSelectedId,c=b(()=>{var I;const x=n.entities.value.byId;return ie(((I=l.value)==null?void 0:I.elements.map(O=>x[O]))??[])}),p=b(()=>{if(i.value)return c.value[i.value]});function d(x,I,O,T){t.init(Ft(x)),n.init(Ft(I)),o.restore(O),a.restore(T)}function f(){return{actors:r.value,elements:nn(n.entities.value),actorSelected:o.createSnapshot(),elementSelected:a.createSnapshot()}}function h(){const x=Ww(),I=Ep(x),O=Jl({id:"initial-actor",armatureId:"initial-armature",svgTree:x,elements:[I.id]});t.init(Ft([O])),n.init(Ft([I])),o.restore([[O.id,!0]]),a.restore([])}function y(x,I){e.dispatch(t.createDeleteAction(r.value.map(O=>O.id)),[t.createAddAction([x]),n.createAddAction(I),o.createSelectAction(x.id)])}function k(x=""){o.getSelectHistoryDryRun(x)&&e.dispatch(o.createSelectAction(x),[a.createClearAllAction()])}function E(x){const I=l.value;I&&e.dispatch(t.createUpdateAction({[I.id]:{armatureId:x}}))}function g(x="",I){!l.value||!a.getSelectHistoryDryRun(x,I==null?void 0:I.shift)||e.dispatch(a.createSelectAction(x,I==null?void 0:I.shift))}function v(){l.value&&e.dispatch(a.createSelectAllAction(!0))}function A(x){const I=p.value;I&&e.dispatch(n.createUpdateAction({[I.id]:x}))}return{actors:r,lastSelectedActor:l,elementMap:c,selectedElements:u,lastSelectedElement:p,lastSelectedElementId:i,initState:d,exportState:f,createDefaultEntities:h,importActor:y,selectActor:k,updateArmatureId:E,selectElement:g,selectAllElement:v,updateElement:A}}const kC=wC(ea());function In(){return kC}const EC=ve(),Ec=ve({scale:{x:0,y:0}});function CC(e,t,n,a){const o=Pr("Canvas Mode",()=>"edit");e.defineReducers(o.reducers);const r=H("pose"),s=H(),l=H(),u=H(),i=H({}),c=H(""),p=o.state;pt(p,(oe,_e)=>{r.value=_e});function d(oe){o.restore(oe),r.value=oe!=="edit"?"edit":"pose",s.value=void 0,l.value=void 0}function f(){return{canvasMode:o.createSnapshot()}}const h=b(()=>p.value==="edit"?t.selectedBonesOrigin.value:a.selectedPosedBoneOrigin.value),y=H();function k(oe=[]){y.value=oe}const E=H();function g(oe){E.value=oe}const v=H([]);function A(oe=[]){v.value=oe}const x=b(()=>{if(!t.lastSelectedArmature.value)return{};if(Object.keys(i.value).length>0){const oe=a.currentInterpolatedConstraintMap.value;return au(ie(ke(t.boneMap.value).map(_e=>({..._e,transform:Ga(a.getCurrentSelfTransforms(_e.id),N(_e.id))}))),oe)}else return a.currentPosedBones.value}),I=b(()=>t.lastSelectedArmature.value?p.value==="edit"?ie(ke(t.boneMap.value).map(oe=>sl(oe,B(oe.id),t.selectedBones.value[oe.id]||{}))):Object.keys(x.value).reduce((oe,_e)=>{const De=x.value[_e];return oe[_e]=wa(De,[De.transform]),oe},{}):{}),O=b(()=>s.value);function T(oe=!1){return p.value==="edit"?j(r.value):j("edit")}function L(oe){e.dispatch(o.createUpdateAction(oe))}function R(oe){s.value=oe}function B(oe){const _e=u.value;return _e&&t.selectedBones.value[oe]?_e:EC}function N(oe){return p.value!=="pose"?Ec:i.value[oe]??Ec}function j(oe){return oe==="weight"?n.lastSelectedActor.value&&L(oe):L(oe),oe===o.state.value}function K(){const oe=u.value;oe&&(t.updateBones(Object.keys(t.selectedBones.value).reduce((_e,De)=>(_e[De]=sl(t.boneMap.value[De],oe,t.selectedBones.value[De]),_e),{})),D())}function D(oe,_e=""){u.value=oe,c.value=_e}function fe(){a.applyEditedTransforms(i.value),Le()}function Le(oe,_e=""){i.value=oe??{},c.value=_e}const Ge=H();function vt(oe){Ge.value=oe}function $e(oe){var _e;(_e=Ge.value)==null||_e.call(Ge,oe)}return{initState:d,exportState:f,canvasMode:p,editTransformType:b(()=>c.value),selectedBonesOrigin:h,changeCanvasMode:j,toggleCanvasMode:T,axisGridLine:O,setAxisGridInfo:R,getEditTransforms:B,getEditPoseTransforms:N,commandExamList:b(()=>y.value),setCommandExams:k,popupMenuList:b(()=>{var oe;return((oe=E.value)==null?void 0:oe.items)??[]}),popupMenuInfo:b(()=>E.value),setPopupMenuList:g,toolMenuGroupList:b(()=>v.value),setToolMenuGroups:A,posedBoneMap:x,visibledBoneMap:I,lastSelectedBoneSpace:b(()=>l.value),setEditTransform:D,completeEditTransform:K,completePoseTransforms:fe,setPoseTransforms:Le,setEventDispatcher:vt,dispatchCanvasEvent:$e}}const MC=CC(ea(),jt(),In(),cn());function dn(){return MC}function ta(e,t,n=!1){let a=!1,o;function r(...s){o=s,!a&&(a=!0,n&&e(...o),setTimeout(()=>{n||e(...o),a=!1},t))}return r}function ku(e){const t=H(),n=H(),a=Hl();Ut(o),pt(()=>a.state.size,o);function o(){if(!n.value)return;const l=n.value.getBoundingClientRect();e().setViewSize({width:l.width,height:l.height})}function r(l){if(!t.value)return;const u=t.value.getBoundingClientRect();return Ce(l,{x:u.left,y:u.top})}function s(l){if(!t.value)return;const u=t.value.getBoundingClientRect();return ee(l,{x:u.left,y:u.top})}return{wrapper:n,svg:t,addRootPosition:s,removeRootPosition:r}}function Ra(e,t){var c,p;const n=[{state:t()}];function a(){return n[n.length-1]}const o=((p=(c=a().state).onStart)==null?void 0:p.call(c,e))??Promise.resolve();function r(){return{label:a().state.getLabel()}}async function s(d){const f=await a().state.handleEvent(e,d);f&&(typeof f=="function"?await u(e,f()):f.type!=="break"?await u(e,f.getState(),f.type):await l(e))}async function l(d){var y,k,E,g;const f=a();await((k=(y=f.state).onEnd)==null?void 0:k.call(y,d)),n.pop(),n.length===0&&n.push({state:t()});const h=a();f.type!=="stack-resume"&&await((g=(E=h.state).onStart)==null?void 0:g.call(E,d))}async function u(d,f,h){var E,g,v,A,x;const y=a();y.state.shouldRequestPointerLock&&!f.shouldRequestPointerLock?d.exitPointerLock():!y.state.shouldRequestPointerLock&&f.shouldRequestPointerLock&&d.requestPointerLock();const k={state:f,type:h};switch(h){case"stack-restart":await((g=(E=y.state).onEnd)==null?void 0:g.call(E,d)),n.push(k);break;case"stack-resume":n.push(k);break;default:await((A=(v=y.state).onEnd)==null?void 0:A.call(v,d)),n[n.length-1]={...k,type:y.type};break}await((x=f.onStart)==null?void 0:x.call(f,d))}async function i(){var f,h;await((h=(f=a().state).onEnd)==null?void 0:h.call(f,e)),n.length=0}return{getStateSummary:r,handleEvent:s,dispose:i,ready:o}}function Eu(e,t,n){let a;const o=e();return{getLabel:()=>o.getLabel()+(a?`:${a.getStateSummary().label}`:""),onStart:async r=>{var s;await((s=o.onStart)==null?void 0:s.call(o,r)),a=Ra({...r,...n(r)},t),await a.ready},onEnd:async r=>{var s;await a.dispose(),await((s=o.onEnd)==null?void 0:s.call(o,r))},handleEvent:async(r,s)=>(await a.handleEvent(s),await o.handleEvent(r,s))}}function is(e,t){function n(o){o.clipboardData&&(Object.entries(e()).forEach(([r,s])=>o.clipboardData.setData(r,s)),o.preventDefault())}async function a(o){if(!o.clipboardData)return;o.preventDefault();const r=Array.from(o.clipboardData.items).map(OC);r.length>0&&await t(r)}return{onCopy:n,onPaste:a}}function OC(e){return e.kind==="string"?{kind:"string",type:e.type,getAsString:()=>TC(e)}:{kind:"file",type:e.type,getAsFile:()=>$C(e)}}function TC(e){return e.kind==="string"?new Promise(t=>{e.getAsString(t)}):Promise.reject(`Can not read "${e.kind}" as string`)}function $C(e){if(e.kind==="file"){const t=e.getAsFile();return t?Promise.resolve(t):Promise.reject("Failed to read read the file")}else return Promise.reject(`Can not read "${e.kind}" as file`)}const Cc="blendic-svg";function cs(e){return{serialize(t){return JSON.stringify({app:Cc,appVersion:"0.18.1",type:e,data:t})},deserialize(t){const n=JSON.parse(t);if(n.app!==Cc||n.type!==e)throw new Error("Invalid data");return n.data}}}const Mc=cs("bones");function Oc(e){return is(()=>{const t=e.getDuplicateBones();return{"text/plain":Mc.serialize(t)}},async t=>{const n=t.find(r=>r.kind==="string");if(!n)return;const a=await n.getAsString(),o=Mc.deserialize(a);if(o.bones.length>0){const r=e.getBones(),s=ke(r).map(d=>d.name),l=op(ie(o.bones),ie(o.createdConstraints),s),u=Tc(ke(Q(Je(e.getSelectedBones(),d=>!!(d.head&&d.tail)),(d,f)=>r[f]))),i=Tc(l.bones),c={x:u[0]-i[0]+20,y:u[1]-i[1]+20},p=l.bones.map(d=>({...d,head:ee(d.head,c),tail:ee(d.tail,c)}));e.addBones(p,{head:!0,tail:!0},l.createdConstraints)}})}function Tc(e){if(e.length===0)return[0,0];const[t,...n]=e;return n.reduce((a,o)=>(a[0]=Math.min(a[0],Math.min(o.head.x,o.tail.x)),a[1]=Math.min(a[1],Math.min(o.head.y,o.tail.y)),a),[Math.min(t.head.x,t.tail.x),Math.min(t.head.y,t.tail.y)])}function Gt(){return AC}const AC={getLabel:()=>"Panning",shouldRequestPointerLock:!0,handleEvent:async(e,t)=>{switch(t.type){case"pointermove":e.panView(t.data);return;case"pointerup":return{type:"break"}}}};function Rs(){return IC}const IC={getLabel:()=>"Grabbing",shouldRequestPointerLock:!0,onStart:async e=>{e.setEditTransform(ve(),"grab")},onEnd:async e=>{e.setAxisGridInfo(),e.setEditTransform()},handleEvent:async(e,t)=>{var n,a;switch(t.type){case"pointermove":{const o=PC(e,t.data.ctrl?Df(t.data.scale):0,Ce(t.data.current,t.data.start));e.setEditTransform(ve({translate:o}),"grab");return}case"pointerup":return t.data.options.button===0&&e.completeEditTransform(),Yt;case"keydown":switch(t.data.key){case"Escape":return Yt;case"x":((n=e.getAxisGridInfo())==null?void 0:n.axis)==="x"?e.setAxisGridInfo():e.setAxisGridInfo({axis:"x",local:!1,vec:{x:1,y:0},origin:Yn(e.getBones(),e.getSelectedBones())});return;case"y":((a=e.getAxisGridInfo())==null?void 0:a.axis)==="y"?e.setAxisGridInfo():e.setAxisGridInfo({axis:"y",local:!1,vec:{x:0,y:1},origin:Yn(e.getBones(),e.getSelectedBones())});return;default:return}default:return}}};function PC(e,t,n){const a=e.getAxisGridInfo();return a?Kf(t,a.vec,n):zf(t,0,n)}function BC(){return LC}const LC={getLabel:()=>"Rotating",shouldRequestPointerLock:!0,onStart:async e=>{e.setEditTransform(ve(),"rotate")},onEnd:async e=>{e.setAxisGridInfo(),e.setEditTransform()},handleEvent:async(e,t)=>{switch(t.type){case"pointermove":{const n=Yn(e.getBones(),e.getSelectedBones()),a=(ht(t.data.current,n)-ht(t.data.start,n))/Math.PI*180,o=t.data.ctrl?Ff(a):a;e.setEditTransform(ve({rotate:o,origin:n}),"rotate");return}case"pointerup":return t.data.options.button===0&&e.completeEditTransform(),Yt;case"keydown":switch(t.data.key){case"Escape":return Yt;default:return}default:return}}};function RC(){return jC}const jC={getLabel:()=>"Scaling",shouldRequestPointerLock:!0,onStart:async e=>{e.setEditTransform(ve(),"scale")},onEnd:async e=>{e.setAxisGridInfo(),e.setEditTransform()},handleEvent:async(e,t)=>{var n,a;switch(t.type){case"pointermove":{const o=Yn(e.getBones(),e.getSelectedBones()),r=V0(o,t.data.start,t.data.current),s=Ne(Ne({x:1,y:1},r?-1:1),It(t.data.current,o)/It(t.data.start,o)),l=t.data.ctrl?Uf(s):s,u=NC(e,l);e.setEditTransform(ve({scale:u,origin:o}),"scale");return}case"pointerup":return t.data.options.button===0&&e.completeEditTransform(),Yt;case"keydown":switch(t.data.key){case"Escape":return Yt;case"x":((n=e.getAxisGridInfo())==null?void 0:n.axis)==="x"?e.setAxisGridInfo():e.setAxisGridInfo({axis:"x",local:!1,vec:{x:1,y:0},origin:Yn(e.getBones(),e.getSelectedBones())});return;case"y":((a=e.getAxisGridInfo())==null?void 0:a.axis)==="y"?e.setAxisGridInfo():e.setAxisGridInfo({axis:"y",local:!1,vec:{x:0,y:1},origin:Yn(e.getBones(),e.getSelectedBones())});return;default:return}default:return}}};function NC(e,t){const n=e.getAxisGridInfo();return n?{x:n.axis==="y"?1:t.x,y:n.axis==="x"?1:t.y}:t}function VC(e){return{getLabel:()=>"Deleting",onStart:async t=>{DC(t,e)},onEnd:async t=>{t.setPopupMenuList()},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 1:return Gt;default:return Yt}case"keydown":switch(n.data.key){case"Escape":return Yt;default:return}case"popupmenu":switch(n.data.key){case"delete":return t.deleteBones(),Yt;case"dissolve":return t.dissolveBones(),Yt;default:return}}}}}function DC(e,t){e.setPopupMenuList({items:[{label:"Dissolve",key:"dissolve"},{label:"Delete",key:"delete"}],point:t.point})}function FC(){return UC}const UC={getLabel:()=>"RectangleSelecting",onStart:async e=>{e.startDragging(),e.setRectangleDragging(!0)},onEnd:async e=>{e.setRectangleDragging()},handleEvent:async(e,t)=>{switch(t.type){case"pointerup":{const n=e.getDraggedRectangle();return n&&e.selectBones(qf(n,e.getBones()),t.data.options.shift),Yt}case"keydown":switch(t.data.key){case"Escape":return Yt}return}}};function Cu(e){return{getLabel:()=>"PickingBone",onStart:async t=>{t.setCommandExams([{title:"Pick a bone"}]),t.startPickBone(e)},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 0:switch(n.target.type){case"bone-body":case"bone-head":case"bone-tail":return t.pickBone(n.target.id),{type:"break"};default:return t.pickBone(),{type:"break"}}case 1:return{getState:Gt,type:"stack-resume"};default:return}case"keydown":switch(n.data.key){case"Escape":return t.pickBone(),{type:"break"};default:return}case"state":return t.pickBone(),{type:"break"};default:return}}}}function Yt(){return GC}const GC={getLabel:()=>"Default",onStart:async e=>{$c(e)},handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 0:switch(t.target.type){case"bone-body":case"bone-head":case"bone-tail":e.selectBone(t.target.id,KC(t.target.type),t.data.options);return;default:return t.data.options.shift||e.selectBones({}),FC}case 1:return Gt;default:return}case"keydown":switch(t.data.key){case"a":e.selectAllBones();return;case"A":e.addBone();return;case"x":{if(e.getLastSelectedBoneId()){const n=t.point;return n?()=>VC({point:n}):void 0}return}case"e":return e.getLastSelectedBoneId()?(e.extrudeBones(),Rs):void 0;case"g":return e.getLastSelectedBoneId()?Rs:void 0;case"r":return e.getLastSelectedBoneId()?BC:void 0;case"s":return e.getLastSelectedBoneId()?RC:void 0;case"D":return e.getLastSelectedBoneId()?(e.duplicateBones(),Rs):void 0;case"!":case"Home":{const n=Object.values(e.getBones());e.setViewport(n.length>0?os(n.map(a=>Zf(a))):void 0);return}default:return}case"popupmenu":switch(t.data.key){case"delete":e.deleteBones();return;case"dissolve":e.dissolveBones();return;case"subdivide":e.subdivideBones();return;case"symmetrize":e.symmetrizeBones();return;default:return}case"copy":{Oc(e).onCopy(t.nativeEvent);return}case"paste":{await Oc(e).onPaste(t.nativeEvent);return}case"selection":$c(e);return;case"state":switch(t.data.name){case"pick-bone":return()=>Cu(t.data.options);default:return}default:return}}};function $c(e){e.getLastSelectedBoneId()?(e.setCommandExams([{command:"e",title:"Extrude"},{command:"g",title:"Grab"},{command:"r",title:"Rotate"},{command:"s",title:"Scale"},{command:"a",title:"All Select"},{command:"A",title:"Add Bone"},{command:"x",title:"Delete"},{command:"D",title:"Duplicate"},{command:`${tn()} + c`,title:"Clip"},{command:`${tn()} + v`,title:"Paste"}]),e.setToolMenuGroups([{label:"Armature",items:[{label:"Subdivide",key:"subdivide"},{label:"Symmetrize",key:"symmetrize",underline:!0},{label:"Dissolve",key:"dissolve"},{label:"Delete",key:"delete"}]}])):(e.setCommandExams([{command:"a",title:"All Select"},{command:"A",title:"Add Bone"},{command:`${tn()} + v`,title:"Paste"}]),e.setToolMenuGroups([]))}function KC(e){switch(e){case"bone-head":return{head:!0};case"bone-tail":return{tail:!0};default:return{head:!0,tail:!0}}}const Ac=cs("bone-poses");function Ic(e){return is(()=>({"text/plain":Ac.serialize(e.getPosesToClip())}),async t=>{const n=t.find(r=>r.kind==="string");if(!n)return;const a=await n.getAsString(),o=Ac.deserialize(a);Object.keys(o).length>0&&e.pastePoses(o)})}function hm(e){const t=e.getLastSelectedBoneId();if(!t)return{origin:{x:0,y:0},radian:0};const n=e.getBones(),a=n[t],o=a.parentId?n[a.parentId]:void 0,r=(o==null?void 0:o.transform.rotate)??0;return{origin:wa(a,[a.transform]).head,radian:qa(a)+r*Math.PI/180}}function Pc(e,t){var a,o;const n=t==="x"?{x:1,y:0}:{x:0,y:1};if(((a=e.getAxisGridInfo())==null?void 0:a.axis)===t)if((o=e.getAxisGridInfo())!=null&&o.local)e.setAxisGridInfo();else{const r=hm(e);e.setAxisGridInfo({axis:t,local:!0,vec:wt(n,r.radian),origin:r.origin})}else e.setAxisGridInfo({axis:t,local:!1,vec:n,origin:Yn(e.getBones(),Q(e.getSelectedBones(),()=>({head:!0})))})}function Bc(e,t){var n;if(((n=e.getAxisGridInfo())==null?void 0:n.axis)===t)e.setAxisGridInfo();else{const a=t==="x"?{x:1,y:0}:{x:0,y:1},o=hm(e);e.setAxisGridInfo({axis:t,local:!0,vec:wt(a,o.radian),origin:o.origin})}}function Mu(e={}){return ve({scale:{x:0,y:0},...e})}function zC(e,t,n){const a=t[n],o=t[a.parentId];return Q_(a,o==null?void 0:o.transform)(e)}function YC(){return XC}const XC={getLabel:()=>"Grabbing",shouldRequestPointerLock:!0,onStart:async e=>{e.setEditTransforms({},"grab"),e.setCommandExams([{command:"x",title:"On Axis X"},{command:"y",title:"On Axis Y"}])},onEnd:async e=>{e.setAxisGridInfo(),e.setEditTransforms(),e.setCommandExams()},handleEvent:async(e,t)=>{switch(t.type){case"pointermove":{const n=HC(e,t.data.ctrl?Df(t.data.scale):0,Ce(t.data.current,t.data.start)),a=e.getBones(),o=e.getSelectedBones(),r=Je(o,(s,l)=>a[l]&&!a[l].connected);e.setEditTransforms(Q(r,(s,l)=>Mu({translate:zC(n,a,l)})),"grab");return}case"pointerup":return t.data.options.button===0&&e.completeEditTransforms(),kt;case"keydown":switch(t.data.key){case"Escape":return kt;case"x":{Pc(e,"x");return}case"y":{Pc(e,"y");return}default:return}default:return}}};function HC(e,t,n){const a=e.getAxisGridInfo();return a?Kf(t,a.vec,n):zf(t,0,n)}function WC(e){return{getLabel:()=>"Inserting",onStart:async t=>{JC(t,e)},onEnd:async t=>{t.setPopupMenuList()},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 1:return{getState:Gt,type:"stack-resume"};default:return kt}case"keydown":switch(n.data.key){case"Escape":return kt;default:return}case"popupmenu":switch(n.data.key){case"location":return t.insertKeyframe({translateX:!0,translateY:!0}),kt;case"rotation":return t.insertKeyframe({rotate:!0}),kt;case"scale":return t.insertKeyframe({scaleX:!0,scaleY:!0}),kt;case"location-rotation":return t.insertKeyframe({translateX:!0,translateY:!0,rotate:!0}),kt;case"location-scale":t.insertKeyframe({translateX:!0,translateY:!0,scaleX:!0,scaleY:!0});break;case"rotation-scale":return t.insertKeyframe({rotate:!0,scaleX:!0,scaleY:!0}),kt;case"all":return t.insertKeyframe({translateX:!0,translateY:!0,rotate:!0,scaleX:!0,scaleY:!0}),kt;default:return}}}}}function JC(e,t){e.setPopupMenuList({items:[{label:"Location",key:"location"},{label:"Rotation",key:"rotation"},{label:"Scale",key:"scale"},{label:"Location & Rotation",key:"location-rotation"},{label:"Location & Scale",key:"location-scale"},{label:"Rotation & Scale",key:"rotation-scale"},{label:"All Transforms",key:"all"}],point:t.point})}function qC(){return ZC}const ZC={getLabel:()=>"RectangleSelecting",onStart:async e=>{e.startDragging(),e.setRectangleDragging(!0)},onEnd:async e=>{e.setRectangleDragging()},handleEvent:async(e,t)=>{switch(t.type){case"pointerup":{const n=e.getDraggedRectangle();return n&&e.selectBones(qf(n,e.getBones()),t.data.options.shift),kt}case"keydown":switch(t.data.key){case"Escape":return kt}return}}};function QC(){let e=0,t=0;return{getLabel:()=>"Rotating",shouldRequestPointerLock:!0,onStart:async n=>{n.setEditTransforms({},"rotate")},onEnd:async n=>{n.setAxisGridInfo(),n.setEditTransforms()},handleEvent:async(n,a)=>{switch(a.type){case"pointermove":{const o=n.getSelectedBones(),r=tu(o),s=ht(a.data.current,r)-ht(a.data.start,r),l=t+Vf(e,s),u=l/Math.PI*180;e=s,t=l;const i=a.data.ctrl?Ff(u):u;n.setEditTransforms(Q(o,c=>Mu({rotate:i*eM(c)})),"rotate");return}case"pointerup":return a.data.options.button===0&&n.completeEditTransforms(),kt;case"keydown":switch(a.data.key){case"Escape":return kt;default:return}default:return}}}}function eM(e){const t=e.transform.scale;return Math.sign(t.x*t.y)}function tM(){return nM}const nM={getLabel:()=>"Scaling",shouldRequestPointerLock:!0,onStart:async e=>{e.setEditTransforms({},"scale"),e.setCommandExams([{command:"x",title:"On Axis X"},{command:"y",title:"On Axis Y"}])},onEnd:async e=>{e.setAxisGridInfo(),e.setEditTransforms(),e.setCommandExams()},handleEvent:async(e,t)=>{switch(t.type){case"pointermove":{const n=e.getSelectedBones(),a=tu(n),o=Ne({x:1,y:1},It(t.data.current,a)/It(t.data.start,a)-1),r=t.data.ctrl?Uf(o):o,s=aM(e,r),l=Mu({scale:s});e.setEditTransforms(Q(n,()=>l),"scale");return}case"pointerup":return t.data.options.button===0&&e.completeEditTransforms(),kt;case"keydown":switch(t.data.key){case"Escape":return kt;case"x":{Bc(e,"x");return}case"y":{Bc(e,"y");return}default:return}default:return}}};function aM(e,t){const n=e.getAxisGridInfo();return n?{x:n.axis==="y"?0:t.x,y:n.axis==="x"?0:t.y}:t}function kt(){return oM}const oM={getLabel:()=>"Default",onStart:async e=>{Lc(e)},handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 0:switch(t.target.type){case"bone-body":case"bone-head":case"bone-tail":e.selectBone(t.target.id,{head:!0,tail:!0},t.data.options,!0);return;default:return t.data.options.shift||e.selectBones({}),qC}case 1:return Gt;default:return}case"keydown":switch(t.data.key){case"a":e.selectAllBones();return;case"g":return e.getLastSelectedBoneId()?YC:void 0;case"r":return e.getLastSelectedBoneId()?QC:void 0;case"s":return e.getLastSelectedBoneId()?tM:void 0;case"i":{const n=t.point;return e.getLastSelectedBoneId()&&n?()=>WC({point:n}):void 0}case"!":case"Home":{const n=Object.values(e.getBones());e.setViewport(n.length>0?os(n.map(a=>Zf(a))):void 0);return}default:return}case"copy":{Ic(e).onCopy(t.nativeEvent);return}case"paste":{await Ic(e).onPaste(t.nativeEvent);return}case"selection":Lc(e);return;case"state":switch(t.data.name){case"pick-bone":return()=>Cu(t.data.options);default:return}default:return}}};function Lc(e){e.getLastSelectedBoneId()?e.setCommandExams([{command:"i",title:"Insert Keyframe"},{command:"g",title:"Grab"},{command:"r",title:"Rotate"},{command:"s",title:"Scale"},{command:"a",title:"All Select"},{command:`${tn()} + c`,title:"Clip"},{command:`${tn()} + v`,title:"Paste"}]):e.setCommandExams([{command:"a",title:"All Select"},{command:`${tn()} + v`,title:"Paste"}]),e.setToolMenuGroups([])}function rM(){return sM}const sM={getLabel:()=>"Default",onStart:async e=>{e.setCommandExams()},handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 0:switch(t.target.type){case"element":e.selectElement(t.target.id,t.data.options);return;default:e.selectElement();return}case 1:return Gt;default:return}case"keydown":switch(t.data.key){case"!":case"Home":{e.setViewport();return}default:return}case"state":switch(t.data.name){case"pick-bone":return()=>Cu(t.data.options);default:return}default:return}}};function ym(){return Eu(()=>lM,rM,e=>e.getWeightContext())}const lM={getLabel:()=>"Weight",handleEvent:async(e,t)=>{switch(t.type){case"state":switch(t.data.name){case"edit":return Ou;case"pose":return vm;default:return}case"keydown":switch(t.data.key){case"Tab":e.toggleMode(t.data.shift);return;default:return}}}};function vm(){return Eu(()=>uM,kt,e=>e.getPoseContext())}const uM={getLabel:()=>"Pose",handleEvent:async(e,t)=>{switch(t.type){case"state":switch(t.data.name){case"edit":return Ou;case"weight":return ym;default:return}case"keydown":switch(t.data.key){case"Tab":e.toggleMode(t.data.shift);return;default:return}}}};function Ou(){return Eu(()=>iM,Yt,e=>e.getEditContext())}const iM={getLabel:()=>"Edit",handleEvent:async(e,t)=>{switch(t.type){case"state":switch(t.data.name){case"pose":return vm;case"weight":return ym;default:return}case"keydown":switch(t.data.key){case"Tab":e.toggleMode(t.data.shift);return;default:return}}}};function cM(e){const t=dM(e),n=fM(e),a=pM(e),o={...ds(e),getEditContext:()=>t,getPoseContext:()=>n,getWeightContext:()=>a,toggleMode:e.canvasStore.toggleCanvasMode};return{sm:Ra(o,Ou)}}function ds(e){return{requestPointerLock:e.requestPointerLock,exitPointerLock:e.exitPointerLock,getTimestamp:()=>Date.now()}}function dM(e){const{indexStore:t,canvasStore:n}=e;function a(){const o=t.allSelectedBones.value,r=ke(t.boneMap.value).map(s=>s.name);return op(o,t.constraintMap.value,r)}return{...ds(e),generateUuid:We,setViewport:e.setViewport,panView:e.panView,startDragging:e.startDragging,setRectangleDragging:e.setRectangleDragging,getDraggedRectangle:e.getDraggedRectangle,setPopupMenuList:n.setPopupMenuList,setCommandExams:n.setCommandExams,pickBone:t.pickBone,startPickBone:t.setBonePicker,getBones:()=>t.boneMap.value,getLastSelectedBoneId:()=>t.lastSelectedBoneId.value,getSelectedBones:()=>t.selectedBones.value,selectBone:t.selectBone,selectBones:t.selectBones,selectAllBones:t.selectAllBones,addBone:t.addBone,addBones:t.addBones,updateBones:t.updateBones,deleteBones:t.deleteBone,extrudeBones:()=>{const o=t.boneMap.value,r=t.selectedBones.value,s=Object.values(o).map(i=>i.name),l={},u=[];Object.keys(r).forEach(i=>{const c=r[i],p=o[i],d=[];c.tail&&d.push(Zi(p)),c.head&&d.push(Zi(p,!0)),d.forEach(f=>{l[f.parentId]||(f.name=qt(p.name,s),u.push(f),s.push(f.name),l[f.parentId]=!0)})}),t.addBones(u,{tail:!0})},dissolveBones:t.dissolveBone,subdivideBones:()=>{const o=H_(t.boneMap.value,Object.keys(t.allSelectedBones.value)),r=Object.keys(o).reduce((s,l)=>(t.boneMap.value[l]||(s[l]={head:!0,tail:!0},s[o[l].parentId]={head:!0,tail:!0}),s),{});t.upsertBones(ke(o),r)},symmetrizeBones:()=>{const o=U_(t.boneMap.value,t.constraintMap.value,Object.keys(t.allSelectedBones.value));t.upsertBones(o.bones,Q(ie(o.bones),()=>({head:!0,tail:!0})),o.createdConstraints)},duplicateBones:()=>{const o=a();t.addBones(o.bones,{head:!0,tail:!0},o.createdConstraints)},getDuplicateBones:a,setEditTransform:n.setEditTransform,completeEditTransform:n.completeEditTransform,setAxisGridInfo:n.setAxisGridInfo,getAxisGridInfo:()=>n.axisGridLine.value,setToolMenuGroups:n.setToolMenuGroups}}function fM(e){const{indexStore:t,canvasStore:n,animationStore:a}=e;return{...ds(e),generateUuid:We,setViewport:e.setViewport,panView:e.panView,startDragging:e.startDragging,setRectangleDragging:e.setRectangleDragging,getDraggedRectangle:e.getDraggedRectangle,setPopupMenuList:n.setPopupMenuList,setCommandExams:n.setCommandExams,pickBone:t.pickBone,startPickBone:t.setBonePicker,getBones:()=>a.currentPosedBones.value,getLastSelectedBoneId:()=>t.lastSelectedBoneId.value,getSelectedBones:()=>a.selectedBones.value,selectBone:t.selectBone,selectBones:t.selectBones,selectAllBones:t.selectAllBones,setEditTransforms:n.setPoseTransforms,completeEditTransforms:n.completePoseTransforms,setAxisGridInfo:n.setAxisGridInfo,getAxisGridInfo:()=>n.axisGridLine.value,insertKeyframe:a.execInsertKeyframe,getPosesToClip:()=>Q(t.selectedBones.value,(o,r)=>a.getCurrentSelfTransforms(r)),pastePoses:a.pastePoses,setToolMenuGroups:n.setToolMenuGroups}}function pM(e){const{indexStore:t,canvasStore:n,elementStore:a}=e;return{...ds(e),generateUuid:We,setViewport:e.setViewport,panView:e.panView,startDragging:e.startDragging,setRectangleDragging:e.setRectangleDragging,getDraggedRectangle:e.getDraggedRectangle,setPopupMenuList:n.setPopupMenuList,setCommandExams:n.setCommandExams,pickBone:t.pickBone,startPickBone:t.setBonePicker,selectElement:a.selectElement}}const Rc={id:"",type:"empty"};function za(e){if(!e.target)return Rc;const t=mM(e.target);if(!t)return Rc;const n=t.dataset.id??"",a=t.dataset.type??"",o=t.dataset?Object.entries(t.dataset).reduce((r,[s,l])=>(r[s]=l??"true",r),{}):void 0;return{id:n,type:a,data:o}}function mM(e){const t=e.closest("[data-type]");return t||void 0}function Tu(e){const t=H(),n=H(),a=b(()=>e().map(r=>{var s;return{...r,focus:r.label===t.value,opened:r.label===n.value,hover(){r.children&&(n.value=r.label)},exec(){r.exec?(t.value=r.label,n.value="",r.exec()):r.children&&(n.value=n.value===r.label?"":r.label)},children:(s=r.children)==null?void 0:s.map(l=>({...l,exec(){var u;(u=l.exec)==null||u.call(l),t.value=r.label}}))}}));function o(){n.value=t.value}return{list:a,clearOpened:o}}const gm=e=>(it("data-v-ba148ec0"),e=e(),ct(),e),hM=["viewBox","width","height","onMousedown","onMouseup"],yM=["stroke-width"],vM=gm(()=>C("line",{x1:"-20000",x2:"20000",stroke:"red"},null,-1)),gM=gm(()=>C("line",{y1:"-20000",y2:"20000",stroke:"green"},null,-1)),bM=[vM,gM],_M=["x1","y1","x2","y2","stroke","stroke-width"],SM={class:"left-top-space"},xM=J({__name:"AppCanvas",props:{originalViewBox:null},setup(e){const t=e,n=jt(),a=dn(),o=cn(),r=In(),{settings:s}=Ct(),l=go(),{wrapper:u,svg:i,addRootPosition:c,removeRootPosition:p}=ku(()=>l);yu(()=>l.scale.value);const d=ta(j,1e3/60,!0),f=ts({onMove:d,onGlobalMove:ne=>{if(!i.value)return;const we=p(ne.p);we&&l.setMousePoint(we)},onEscape:()=>{h.sm.handleEvent({type:"keydown",data:{key:"Escape"},point:l.viewToCanvas(l.mousePoint.value)})}}),h=cM({indexStore:n,canvasStore:a,animationStore:o,elementStore:r,requestPointerLock:()=>{i.value&&(l.startMoving(),f.requestPointerLockFromElement(i.value))},exitPointerLock:()=>{f.exitPointerLock(),l.endMoving()},setViewport:ne=>l.setViewport(ne),panView:ne=>l.viewMove(ne),startDragging:()=>l.startDragging(),setRectangleDragging:ne=>l.setRectangleDragging(ne),getDraggedRectangle:()=>l.draggedRectangle.value});a.setEventDispatcher(h.sm.handleEvent),pt(a.canvasMode,ne=>{h.sm.handleEvent({type:"state",data:{name:ne}})}),pt([n.lastSelectedArmature,n.selectedBones,r.selectedElements],()=>{h.sm.handleEvent({type:"selection"})});function y(){t.originalViewBox&&l.setViewport(t.originalViewBox)}pt(()=>t.originalViewBox,y),Ut(y);const k=b(()=>{if(l.editStartPoint.value&&a.axisGridLine.value)return{...ck(a.axisGridLine.value.origin,a.axisGridLine.value.vec,l.viewCanvasRect.value),color:a.axisGridLine.value.axis==="x"?"red":"green"}});function E(){if(!u.value)return;const ne=u.value.getBoundingClientRect();l.setViewSize({width:ne.width,height:ne.height})}const g=Hl();Ut(E),pt(()=>g.state.size,E);const v=b(()=>a.popupMenuInfo.value?c(l.canvasToView(a.popupMenuInfo.value.point)):void 0),A=Tu(()=>{var ne;return((ne=a.popupMenuInfo.value)==null?void 0:ne.items.map(({label:we,children:$,key:P,data:G})=>({label:we,exec:P?()=>fe(P,G):void 0,children:$==null?void 0:$.map(({label:z,key:V,data:te})=>({label:z,exec:V?()=>fe(V,te):void 0}))})))??[]}),x=b(()=>a.toolMenuGroupList.value.map(({label:ne,items:we})=>({label:ne,items:we.map(({label:$,key:P})=>({label:$,exec:P?()=>fe(P):void 0}))}))??[]),I=b(()=>{if(["scale","rotate"].includes(a.editTransformType.value))return{origin:a.selectedBonesOrigin.value,current:l.viewToCanvas(l.mousePoint.value)}}),O=b(()=>I.value?ht(I.value.current,I.value.origin)*180/Math.PI:0),T=b(()=>{switch(a.editTransformType.value){case"rotate":return"move-v";case"scale":return"move-h";default:return"move"}}),L=b(()=>a.editTransformType.value?c(l.mousePoint.value):void 0),R=b(()=>!!n.bonePicker.value);function B(ne){h.sm.handleEvent({type:"pointerdown",target:za(ne),data:{point:l.viewToCanvas(l.mousePoint.value),options:gn(ne)}})}function N(ne){l.endMoving(),h.sm.handleEvent({type:"pointerup",target:za(ne),data:{point:l.viewToCanvas(l.mousePoint.value),options:gn(ne)}})}function j(ne){l.editStartPoint.value&&h.sm.handleEvent({type:"pointermove",data:{start:l.viewToCanvas(l.editStartPoint.value),current:l.viewToCanvas(l.mousePoint.value),ctrl:ne.ctrl,scale:l.scale.value}})}function K(ne){l.dragged.value&&l.editStartPoint.value&&h.sm.handleEvent({type:"pointerdrag",data:{start:l.viewToCanvas(l.editStartPoint.value),current:l.viewToCanvas(l.mousePoint.value),ctrl:Kn(ne),scale:l.scale.value}})}function D(ne){h.sm.handleEvent({type:"keydown",data:Oo(ne),point:l.viewToCanvas(l.mousePoint.value)})}function fe(ne,we={}){h.sm.handleEvent({type:"popupmenu",data:{key:ne,...we}})}function Le(ne){h.sm.handleEvent({type:"copy",nativeEvent:ne})}function Ge(ne){h.sm.handleEvent({type:"paste",nativeEvent:ne})}function vt(ne){a.changeCanvasMode(ne)}const $e=b(()=>s.showAxis),oe=l.scale,_e=l.viewSize,De=l.viewBox,dt=l.draggedRectangle,Mt=a.canvasMode,Y=b(()=>A.list.value),pe=l.wheel,Ee=vt,me=a.commandExamList;return(ne,we)=>(_(),M("div",{ref_key:"wrapper",ref:u,class:"app-canvas-root"},[w(gu,{onKeydown:D,onCopy:Le,onPaste:Ge},{default:F(()=>[(_(),M("svg",{ref_key:"svg",ref:i,xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none","font-family":"sans-serif",viewBox:m(De),width:m(_e).width,height:m(_e).height,class:et({"picking-bone":m(R)}),onWheel:we[0]||(we[0]=Ke((...$)=>m(pe)&&m(pe)(...$),["prevent"])),onMousedown:Ke(B,["prevent"]),onMouseup:Ke(N,["prevent"]),onMousemove:K,onContextmenu:we[1]||(we[1]=Ke(()=>{},["prevent"]))},[m($e)?(_(),M("g",{key:0,"stroke-width":1*m(oe),"stroke-opacity":"0.3"},bM,8,yM)):ce("",!0),m(k)?(_(),M("line",{key:1,x1:m(k).from.x,y1:m(k).from.y,x2:m(k).to.x,y2:m(k).to.y,stroke:m(k).color,"stroke-width":2*m(oe)},null,8,_M)):ce("",!0),at(ne.$slots,"default",{scale:m(oe)},void 0,!0),m(dt)?(_(),Se(vu,{key:2,x:m(dt).x,y:m(dt).y,width:m(dt).width,height:m(dt).height,class:"view-only"},null,8,["x","y","width","height"])):ce("",!0),m(I)?(_(),Se($k,{key:3,origin:m(I).origin,current:m(I).current},null,8,["origin","current"])):ce("",!0)],42,hM))]),_:3}),C("div",SM,[w(lg,{class:"mode-panel","canvas-mode":m(Mt),onChangeMode:m(Ee)},null,8,["canvas-mode","onChangeMode"]),m(Mt)==="edit"?(_(),Se(hf,{key:0,class:"armature-menu",groups:m(x)},null,8,["groups"])):ce("",!0)]),w(zl,{class:"command-exam-panel","available-command-list":m(me)},null,8,["available-command-list"]),m(Y).length>0&&m(v)?(_(),Se(Yl,{key:0,class:"popup-menu-list","popup-menu-list":m(Y),style:st({left:`${m(v).x-20}px`,top:`${m(v).y-10}px`})},null,8,["popup-menu-list","style"])):ce("",!0),w(Yb,{p:m(L),rotate:m(O),cursor:m(T)},null,8,["p","rotate","cursor"])],512))}});const wM=Me(xM,[["__scopeId","data-v-ba148ec0"]]),kM={class:"tab-panel-root"},EM=["onClick"],CM={class:"panels"},MM=J({__name:"TabPanel",props:{tabs:{default:()=>[]},initialTab:{default:void 0}},setup(e){var o;const t=e,n=H(t.initialTab??((o=t.tabs[0])==null?void 0:o.key)??""),a=r=>n.value=r;return(r,s)=>(_(),M("div",kM,[C("ul",null,[(_(!0),M(ye,null,Pe(e.tabs,l=>(_(),M("li",{key:l.key,class:et({current:l.key===n.value})},[C("a",{href:"#",onClick:Ke(u=>a(l.key),["prevent"])},Ve(l.label),9,EM)],2))),128))]),C("div",CM,[(_(!0),M(ye,null,Pe(e.tabs,l=>Qn((_(),M("div",{key:l.key},[at(r.$slots,l.key,{},void 0,!0)])),[[mf,l.key===n.value]])),128))])]))}});const OM=Me(MM,[["__scopeId","data-v-9e8d880e"]]),TM=e=>(it("data-v-6bcf6e10"),e=e(),ct(),e),$M=TM(()=>C("h3",null,"history",-1)),AM=J({__name:"HistoryStack",setup(e){const n=ea().historySummaries;return(a,o)=>(_(),M("div",null,[$M,C("ul",null,[(_(!0),M(ye,null,Pe(m(n),(r,s)=>(_(),M("li",{key:s,class:et({done:r.done})},Ve(r.name),3))),128))])]))}});const IM=Me(AM,[["__scopeId","data-v-6bcf6e10"]]);const PM={},BM={class:"row-block"};function LM(e,t){return _(),M("div",BM,[at(e.$slots,"default",{},void 0,!0)])}const bm=Me(PM,[["render",LM],["__scopeId","data-v-513b7a6f"]]),RM={class:"inline-content"},jM=J({__name:"InlineField",props:{label:{default:""},labelWidth:{default:void 0},between:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),Se(bm,{class:et(["inline-field",{between:e.between}])},{default:F(()=>[e.label?(_(),M("label",{key:0,style:st({width:e.labelWidth})},Ve(e.label),5)):ce("",!0),C("div",RM,[at(t.$slots,"default",{},void 0,!0)])]),_:3},8,["class"]))}});const ue=Me(jM,[["__scopeId","data-v-64e5a967"]]),NM=["disabled"],VM={key:0},DM=J({__name:"CheckboxInput",props:{modelValue:{type:Boolean,default:!1},label:{default:""},disabled:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e,a=b({get(){return n.modelValue},set(o){t("update:model-value",o)}});return(o,r)=>(_(),M("label",{class:et({disabled:e.disabled})},[Qn(C("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>Fe(a)?a.value=s:null),disabled:e.disabled,type:"checkbox"},null,8,NM),[[qv,m(a)]]),e.label?(_(),M("span",VM,Ve(e.label),1)):ce("",!0)],2))}});const ut=Me(DM,[["__scopeId","data-v-585a0f61"]]),FM=["disabled","onClick"],UM=J({__name:"ToggleButtons",props:{modelValue:null,options:null,disabled:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e;function a(r){const s=o.value[r]?n.modelValue.filter(l=>l!==r):[...n.modelValue,r];t("update:model-value",s)}const o=b(()=>n.modelValue.reduce((r,s)=>(r[s]=!0,r),{}));return(r,s)=>(_(),M("div",{class:et(["toggle-buttons",{disabled:e.disabled}])},[(_(!0),M(ye,null,Pe(e.options,l=>(_(),M("button",{key:l.value,type:"button",class:et({selected:m(o)[l.value]}),disabled:e.disabled,onClick:u=>a(l.value)},Ve(l.label),11,FM))),128))],2))}});const Br=Me(UM,[["__scopeId","data-v-78da8ee9"]]),Vn=J({__name:"ToggleRadioButtons",props:{modelValue:null,options:null,disabled:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e,a=b({get(){return n.modelValue!==void 0?[n.modelValue]:[]},set(o){const r=o.filter(s=>s!==n.modelValue);t("update:model-value",r.length>0?r[0]:n.modelValue)}});return(o,r)=>(_(),Se(Br,{modelValue:m(a),"onUpdate:modelValue":r[0]||(r[0]=s=>Fe(a)?a.value=s:null),options:e.options},null,8,["modelValue","options"]))}}),GM={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10"},KM={key:0,width:"10",height:"10",stroke:"none",class:"fill-background-second"},fs=J({__name:"DeleteIcon",props:{float:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("svg",GM,[e.float?ce("",!0):(_(),M("rect",KM)),C("path",{d:"M2.5 2.5L7.5 7.5M2.5 7.5L7.5 2.5","stroke-linejoin":"round",fill:"none",class:et(e.float?"stroke-background-second":"stroke-background")},null,2)]))}}),zM=e=>(it("data-v-69deda17"),e=e(),ct(),e),YM={key:0,class:"dialog-wrapper"},XM=zM(()=>C("div",{class:"overlay"},null,-1)),HM=["onClick"],WM={class:"body-innter"},JM={class:"body-content"},qM={key:0,class:"buttons"},ZM=J({__name:"DialogBase",props:{open:{type:Boolean}},emits:["update:open"],setup(e,{emit:t}){const n=()=>t("update:open",!1);return(a,o)=>e.open?(_(),M("div",YM,[XM,C("div",{class:"body-outer",onClick:Ke(n,["self"])},[C("div",WM,[C("button",{type:"button",class:"close-button",onClick:n},[w(fs,{float:""})]),C("div",JM,[at(a.$slots,"default",{},void 0,!0),a.$slots.buttons?(_(),M("div",qM,[at(a.$slots,"buttons",{},void 0,!0)])):ce("",!0)])])],8,HM)])):ce("",!0)}});const _m=Me(ZM,[["__scopeId","data-v-69deda17"]]),QM=["disabled"],eO=J({__name:"DialogButton",props:{type:{default:"default"},disabled:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("button",{type:"button",class:et({[e.type]:!0}),disabled:e.disabled},[at(t.$slots,"default",{},void 0,!0)],10,QM))}});const bo=Me(eO,[["__scopeId","data-v-738a9523"]]),tO=C("h3",null,"Select Actions",-1),nO=J({__name:"BakingConfigDialog",props:{open:{type:Boolean},actions:null,initialActionIds:{default:()=>[]}},emits:["update:open","execute"],setup(e,{emit:t}){const n=e,a=H(l0(n.initialActionIds,!0)),o=b(()=>n.actions.filter(l=>a.value[l.id]).map(l=>l.id));function r(l){t("update:open",l)}function s(){t("execute",Object.keys(Je(a.value,l=>l)))}return(l,u)=>(_(),Se(Fl,{to:"body"},[w(_m,{open:e.open,"onUpdate:open":r},{default:F(()=>[tO,(_(!0),M(ye,null,Pe(e.actions,i=>(_(),Se(ut,{key:i.id,modelValue:a.value[i.id],"onUpdate:modelValue":c=>a.value[i.id]=c,label:i.name},null,8,["modelValue","onUpdate:modelValue","label"]))),128))]),buttons:F(()=>[w(bo,{onClick:u[0]||(u[0]=i=>r(!1))},{default:F(()=>[$t("Cancel")]),_:1}),w(bo,{type:"primary",disabled:m(o).length===0,onClick:s},{default:F(()=>[$t("Export")]),_:1},8,["disabled"])]),_:1},8,["open"])]))}}),aO=["disabled"],oO=["onMousedown"],rO=J({__name:"SliderInput",props:{modelValue:{default:0},integer:{type:Boolean,default:!1},min:{default:void 0},max:{default:void 0},step:{default:1},disabled:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e,a=H(),o=H(),r=H(0),s=H(!1),l=H(!1),u=H(),i=b(()=>{if(n.min!==void 0&&n.max!==void 0)return n.max-n.min}),c=b(()=>Math.round(Math.log(n.step)/Math.log(10))),p=H("0");rn(()=>{p.value=n.modelValue.toString()});const d=b(()=>n.integer?parseInt(p.value):parseFloat(p.value));function f(R){return!i.value||n.max===n.min?0:(R-n.min)/(n.max-n.min)}const h=b(()=>f(n.modelValue)),y=b(()=>f(r.value)),k=b(()=>lt(0,1,h.value));function E(){var R;document.exitPointerLock(),l.value||(s.value=!0,(R=o.value)==null||R.select())}function g(R){if(!a.value)return;const B=a.value.getBoundingClientRect().width;if(B===0)return;const N=(R.p.x-R.base.x)/B;if(Math.abs(N)>0&&(l.value=!0),i.value){const j=zt(-2,lt(0,1,y.value+N)*i.value+n.min);p.value=x(n.integer?Math.round(j):j).toString()}else{const j=(R.p.x-R.base.x)*.4;p.value=zt(c.value,x(r.value+j*n.step)).toString()}I()}const v=ta(g,1e3/60,!0),A=ts({onMove:v,onEscape:()=>{l.value=!1,u.value=void 0}});function x(R){let B=R;return n.min!==void 0&&(B=Math.max(B,n.min)),n.max!==void 0&&(B=Math.min(B,n.max)),B}function I(){if(isNaN(d.value)){p.value=n.modelValue.toString();return}d.value!==n.modelValue&&t("update:model-value",x(d.value),u.value)}const O=()=>s.value=!0,T=()=>s.value=!1,L=R=>{l.value=!1,u.value=`slider_${Date.now()}`,r.value=n.modelValue,A.requestPointerLock(R,"move-h")};return(R,B)=>(_(),M("div",{ref_key:"el",ref:a,class:"slider-wrapper"},[C("div",{class:"slider-background",style:st({transform:`scaleX(${m(k)})`})},null,4),Qn(C("input",{ref_key:"inputEl",ref:o,"onUpdate:modelValue":B[0]||(B[0]=N=>p.value=N),type:"text",disabled:e.disabled,onChange:I,onFocus:O,onBlur:T},null,40,aO),[[Qr,p.value]]),!s.value&&!e.disabled?(_(),M("div",{key:0,class:"slider-forward",onMouseup:E,onMousedown:Ke(L,["prevent"])},null,40,oO)):ce("",!0)],512))}});const Ae=Me(rO,[["__scopeId","data-v-300dad0d"]]);function jc(e){return e[0]*e[3]-e[1]*e[2]===0?[0,0,0,0,0,0]:nb(e)}function sO(e,t,n){return Ja([n?jc(n):void 0,e?jc(e):void 0,t].filter(a=>!!a))}function lO(e,t){return Ja([e,t].filter(n=>!!n))}function Sm(e,t,n){const a=$u(e,t,n,void 0,void 0);return wm(e,a,t,n)}function $u(e,t,n,a="",o=ot){const r=t[n.id],s=Nc(e,a)??ot,l=(r==null?void 0:r.boneId)||a,u=Nc(e,l),i=uO(n,o),c=Ja([sO(s,u,o),i].filter(p=>!!p));return{[n.id]:c,...n.children.reduce((p,d)=>(mt(d)||(p={...p,...$u(e,t,d,l,i)}),p),{})}}function xm(e,t,n,a){const o=ok(e,n,a);return t&&(o.transform=Au(t)),o}function Au(e){return gb([Ea(6,e[0]),Ea(6,e[1]),Ea(6,e[2]),Ea(6,e[3]),Ea(6,e[4]),Ea(6,e[5])])}function wm(e,t,n,a){const o=xm(e,t[a.id],n[a.id],a);return{...a,attributes:{...a.attributes,...o},children:a.children.map(r=>mt(r)?r:wm(e,t,n,r))}}function Nc(e,t){const n=e[t];return n?L_(n):void 0}function uO(e,t){return lO(t,e.attributes.transform?bb(e.attributes.transform):void 0)}function iO(e,t,n,a,o,r){return[...Array(r+1)].map((s,l)=>dO(e,t,n,a,o,l))}function cO(e,t,n,a){const o=im(e),r=_u(o.bone,a),s=Q(t,(u,i)=>({...u,transform:r[i]??ve()})),l=Su(o.constraint,a);return{bones:s,constraints:Q(n,u=>{const i=l[u.id];return i?{...u,option:i}:u})}}function dO(e,t,n,a,o,r){return km(Em(e,t,n,r),a,o)}function km(e,t,n){const a=$u(e,t,n),o=ie(Go([n]));return Q(a,(r,s)=>xm(e,r,t[s],o[s]))}function Em(e,t,n,a){const o=cO(e,t,n,a);return au(o.bones,o.constraints)}function fO(e,t){return Q(t,(n,a)=>ps(e[a],n))}function Cm(e,t){return Mm(e,hO(e,SO(e,t)))}function Mm(e,t){const n=e[t.id],a=!n||t.attributes[Om];return{...t,attributes:a?t.attributes:ps(n,t.attributes),children:t.children.map(o=>mt(o)?o:Mm(e,o))}}const pO={x:!0,y:!0,dx:!0,dy:!0,width:!0,height:!0,cx:!0,cy:!0,r:!0,rx:!0,ry:!0,fx:!0,fy:!0,"font-size":!0,"stroke-dashoffset":!0,x1:!0,y1:!0,x2:!0,y2:!0,offset:!0},mO={id:!0,"text-anchor":!0,"dominant-baseline":!0,"stroke-dasharray":!0,gradientUnits:!0,spreadMethod:!0,clipPathUnits:!0,"clip-path":!0};function ps(e,t){var a,o;if(e.disabled)return{fill:"none",stroke:"none"};const n={...t};if(e.transform?n.transform=Au(A0(e.transform)):t.transform&&(n.transform=t.transform),e.fill)if(typeof e.fill=="string")n.fill=`url(#${e.fill})`;else{const r=vo(e.fill);n.fill=r.color,n["fill-opacity"]=r.opacity}if(e.stroke)if(typeof e.stroke=="string")n.stroke=`url(#${e.stroke})`;else{const r=vo(e.stroke);n.stroke=r.color,n["stroke-opacity"]=r.opacity}if(e["stroke-width"]&&(n["stroke-width"]=e["stroke-width"].toString()),e.attributes){const r=e.attributes;if(Object.entries(r).forEach(([s,l])=>{l!==void 0&&(pO[s]?n[s]=l.toString():mO[s]&&(n[s]=l))}),e.attributes.viewBox&&(n.viewBox=fu(e.attributes.viewBox)),e.attributes.d){const s=(o=(a=e.attributes.d[0])==null?void 0:a.trim())==null?void 0:o.toLowerCase()[0];(s==="m"||s==="l")&&(n.d=e.attributes.d.join(" "))}if(e.attributes["stop-color"]){const s=vo(e.attributes["stop-color"]);n["stop-color"]=s.color,n["stop-opacity"]=s.opacity}}return Im(e)&&(n[Tm]=e.elementId),n}function hO(e,t){const n=Object.values(e).filter(u=>u.clone),a={},{tree:o,clonedElementIds:r}=vO(n,t,a),s=_O(e,o),l=Object.keys(r).map(u=>e[u]).concat(n);return yO(l,s,a)}function yO(e,t,n){const a=e.reduce((o,r)=>(r.elementId&&(o[r.elementId]=o[r.elementId]?[...o[r.elementId],r]:[r]),o),{});return $m(a,t,n)}const Om="data-blendic-use-origin-id",Bo="data-blendic-use-id",Tm="data-blendic-use-id-for-g";function Vc(e,t,n){return{id:`clone_${e.id}`,tag:"use",attributes:{href:`#${t}`,"xlink:href":`#${t}`,...ps(e,n)},children:[]}}function $m(e,t,n,a={}){const o=t.attributes[Bo]||t.attributes[Tm],r=!!t.attributes[Bo],s=e[o]??[];a[o]||(a[o]=Sa(s,"parent"));const l=a[o],u=t.children.map(i=>{var d;if(mt(i))return i;const c=$m(e,i,n,a),p=(r?l[c.id]:(d=l[c.id])==null?void 0:d.filter(f=>f.id!==o))??[];return{...c,children:[...c.children,...p.map(f=>Vc(f,o,n[o]))]}});return r?{...t,children:[...u,...s.filter(i=>!i.parent).map(i=>Vc(i,o,n[o]))]}:{...t,children:u}}function vO(e,t,n){const a=e.map(o=>o.elementId).reduce((o,r)=>(r&&(o[r]=!0),o),{});return{tree:Am(a,t,n),clonedElementIds:a}}const gO=["transform","fill","stroke","fill-opacity","stroke-opacity","x","y"];function bO(e){const t={...e};gO.forEach(a=>{delete t[a]});const n=e.style;if(n){const a=Ip(n);delete a.fill,delete a.stroke,delete a["fill-opacity"],delete a["stroke-opacity"];const o=Pp(a);o?t.style=o:delete t.style}return t}function Am(e,t,n){const a=t.children.map(o=>mt(o)?o:Am(e,o,n));if(e[t.id]){n[t.id]=t.attributes;const o=bO(t.attributes);return{id:`blendic_group_${t.id}`,tag:"g",attributes:{[Bo]:t.id},children:[{id:"",tag:"defs",attributes:{},children:[{id:t.id,tag:t.tag,attributes:{...o,[Om]:t.id,id:t.id},children:a}]}]}}else return{...t,children:a}}function Im(e){return!!e.create&&!!e.elementId}function _O(e,t){const n=Je(e,Im),a={},o=Pm(n,t,r=>{const s=e[r.id].elementId;a[s]||(a[s]=[]),a[s].push(r)});return Bm(a,o)}function Pm(e,t,n){if(e[t.id]){n(t);return}else{const a=t.children.map(o=>mt(o)?o:Pm(e,o,n)).filter(o=>!!o);return{...t,children:a}}}function Bm(e,t){const n=t.children.map(a=>mt(a)?a:Bm(e,a));if(t.attributes[Bo]){const a=e[t.attributes[Bo]]??[];return{...t,children:[...n,...a]}}else return{...t,children:n}}function SO(e,t){const n=Object.values(e).filter(r=>r.create&&r.tag).map(r=>r.parent?r:{...r,parent:t.id}),a=Sa(n,"parent"),o=Q(a,r=>r.map(xO));return Lm(t,o)}function xO(e){return as({id:e.id,tag:e.tag??"rect",attributes:ps(e,{}),children:e.text?[e.text]:[]})}function Lm(e,t){const n=t[e.id]?[...e.children,...t[e.id]]:e.children;return{...e,children:[...n.map(a=>mt(a)?a:Lm(a,t))]}}function js(e){return{...e,attributes:{...e.attributes,"xmlns:xlink":"http://www.w3.org/1999/xlink"}}}function wO(e){var i,c;const t=ie(e.keyframes),n=Q(ie(e.actions),p=>p.keyframes.map(d=>t[d])),a=ie(e.elements),o=Q(ie(e.actors),p=>p.elements.map(d=>a[d])),r=ie(e.nodes??[]),s=((i=e.graphs)==null?void 0:i.map(p=>$O(p,r)))??[],l=((c=e.customGraphs)==null?void 0:c.map(p=>AO(p,r)))??[],u=PO(e.nodes??[]);return{armatures:e.armatures.map(kO),bones:e.bones.map(EO),constraints:e.constraints.map(CO),armatureSelected:e.armatureSelected??[],boneSelected:e.boneSelected??[],canvasMode:e.canvasMode??"object",currentFrame:e.currentFrame??0,endFrame:e.endFrame??60,actions:e.actions.map(MO),keyframes:e.actions.flatMap(p=>n[p.id].map(OO)),actionSelected:e.actionSelected??[],keyframeState:e.keyframeState??[],targetPropsState:e.targetPropsState??[],actors:e.actors.map(TO),elements:e.actors.flatMap(p=>qw(p.svgTree,o[p.id])),actorSelected:e.actorSelected??[],elementSelected:e.elementSelected??[],graphs:s,customGraphs:l,nodes:u,graphSelected:e.graphSelected??[],customGraphSelected:e.customGraphSelected??[],nodeSelected:e.nodeSelected??[],graphType:e.graphType??"graph"}}function kO(e){return ol(e)}function EO(e){return zn(e)}function CO(e){return Xf(e)}function MO(e){return jf(e)}function OO(e){return lm({name:"bone",...e})}function TO(e){return Jl(e)}function $O(e,t){const n=Rf(e);return{...n,nodes:n.nodes.filter(a=>!!t[a])}}function AO(e,t){const n=Wl(e);return{...n,nodes:n.nodes.filter(a=>!!t[a])}}function IO(e){var a;const t=(a=Ar(e.type))==null?void 0:a.struct;if(!t)return e;const n=t.create();return{...n,...e,inputs:tt({...n.inputs,...e.inputs},t.inputs),data:tt({...n.data,...e.data},t.data)}}function PO(e){return e.filter(BO).map(IO)}function BO(e){return!0}function yr(e,t,n){var y;const a=LO(t,n),o=Math.max(((y=a.beginOutputNode)==null?void 0:y.data.max_loop)??1,1),r=Object.entries(a.inputNodes).reduce((k,[E,g])=>{var A;const v=(A=g.inputs.output.from)==null?void 0:A.id;return v&&(k[E]=v),k},{}),s=Q(n,k=>{if(k.type!=="custom_input")return k;const E={...k,inputs:{...k.inputs}};return delete E.inputs.output,E}),l=RO(a),u=jO(a),i=uu(s),c=new Set([...Object.keys(l),...Object.keys(u)]),p=Object.keys(l).map(k=>cu(e,s,i,{id:k,key:"value",output:!0}).map(E=>{const g={...E,key:E.id};return!E.output&&!E.data?g.output=!0:E.output&&delete g.output,g})).filter(k=>k.every(E=>!cl(E.type))).map(k=>k.filter(E=>!E.data&&c.has(E.id))).map(k=>k.map(E=>{const g={key:E.key};return E.output&&(g.output=!0),g})),d=new Map(p.filter(k=>k.some(E=>E.output)).map(k=>{const E=k.find(v=>v.output),g=k.find(v=>!v.output);return[E.key,g.key]})),f=d.size>0?(k,E)=>{const v=s[E].inputs.value.genericsType;if(cl(v))return v;const A=d.get(E);return A?k.inputs[A].genericsType:S.UNKNOWN}:void 0,h=(k,E,g)=>Xt((f==null?void 0:f(k,g))??u[g],l[E].type??k.inputs[E].genericsType);return{struct:{create:(k={})=>({position:{x:0,y:0},...k,type:t.id,data:{max_loop:o},inputs:Q(l,E=>({value:E.default}))}),data:{max_loop:{type:S.SCALER,default:o}},inputs:l,outputs:u,computation:(k,E,g,v)=>{const A=E.data.max_loop??1;let x,I,O=k,T=!0,L=0;const R=Je(r,(B,N)=>h(E,N,B));for(;T&&L<A;)x=g.beginNamespace(`${E.id}-l${L}`,()=>(I=su(v,g,NO(s,O)),VO(a.outputNodes,I))),T=a.beginOutputNode?DO(a.beginOutputNode,I):!1,O=Q(O,(B,N)=>{const j=R[N];return j?x[j]:B}),L++;return x},width:140,color:"#ff6347",textColor:"#fff",label:`${t.name}`,getOutputType:f,genericsChains:p.length>0?p:void 0,getErrors:k=>{const E=Object.entries(r).filter(([g,v])=>!h(k,g,v)).map(([g,v])=>`Type of "${l[g].label??g}" doesn't match "${u[v].label??v}"`);return E.length>0?E:void 0},custom:!0}}}function LO(e,t){return e.nodes.reduce((n,a)=>{const o=t[a];switch(o.type){case"custom_begin_input":n.beginInputNode=o;break;case"custom_input":n.inputNodes[o.id]=o;break;case"custom_begin_output":n.beginOutputNode=o;break;case"custom_output":n.outputNodes[o.id]=o;break}return n},{beginInputNode:void 0,inputNodes:{},beginOutputNode:void 0,outputNodes:{}})}function RO({beginInputNode:e,inputNodes:t}){if(!e)return{};const n=ke(t).reduce((a,o)=>(o.inputs.input.from&&(a[o.inputs.input.from.id]=o.id),a),{});return Rm(n,e.id).reduce((a,o)=>{const r=t[o];return a[o]={label:r.data.name,type:r.data.default.genericsType??S.GENERICS,default:r.data.default.value},a},{})}function jO({beginOutputNode:e,outputNodes:t}){if(!e)return{};const n=ke(t).reduce((a,o)=>(o.inputs.output.from&&(a[o.inputs.output.from.id]=o.id),a),{});return Rm(n,e.id).reduce((a,o)=>{const r=t[o];return a[o]={...r.inputs.value.genericsType??S.GENERICS,label:r.data.name},a},{})}function Rm(e,t){const n=[];let a=e[t];for(;a;)n.push(a),a=e[a];return n}function NO(e,t){const n=Object.entries(t).reduce((a,[o,r])=>{const s=e[o];return s&&(a[s.id]={...s,data:{...s.data,default:{...s.data.default,value:r}}}),a},{});return{...e,...n}}function VO(e,t){return ke(e).reduce((n,a)=>{if(a.inputs.value.from){const o=t[a.inputs.value.from.id];o&&(n[a.id]=o[a.inputs.value.from.key])}return n},{})}function DO(e,t){const n=e.inputs.loop;return n.from?!!t[n.from.id][n.from.key]:!!n.value}function jm(e,t,n){return n.nodes.reduce((a,o)=>{const r=e[o];return r&&t.has(r.type)&&(a[r.type]=!0),a},{})}function FO(e,t){const n=new Set(t.map(a=>a.id));return t.reduce((a,o)=>(a[o.id]=jm(e,n,o),a),{})}function UO(e,t){return Er(FO(e,t))}function GO(e,t,n){const a=new Set(t.map(s=>s.id)),o=t.reduce((s,l)=>(s[l.id]=jm(e,a,l),s),{}),r=new Set(s0(o,n));return r.add(n),t.filter(s=>!r.has(s.id)).map(s=>s.id)}function KO(e,t,n,a){const o=new Set(n),r=Je(t,y=>o.has(y.id)&&XO(y)),s=a(),l=zO(e,t,Object.keys(r),s,a),u=YO(e,{...t,...l.customGraphNodes},Object.keys({...r,...l.customGraphNodes}),a),i={...u.customGraphNodes,...Uo(e,u.customGraphNodes)},c=Wl({id:a(),nodes:Object.keys(i).sort()}),p=yr(e,c,i),d=y=>y===c.id?p:e(y);let h=fp({[c.id]:p},c.id,{id:s});return Object.entries(u.inputMap).forEach(([y,k])=>{h=Jn(d,{[h.id]:h,[k.id]:t[k.id]},h.id,y,k.id,k.key)[h.id]??h}),{customGraph:c,customGraphNodes:i,customNode:h,updatedNodes:l.updatedNodes,deletedNodeIds:Object.keys(r)}}function zO(e,t,n,a,o){const r=n.map(d=>t[d]).sort((d,f)=>d.position.y-f.position.y).map(d=>d.id),s=new Set(r),l=Je(t,(d,f)=>!s.has(f)),u={},i=Je(t,(d,f)=>s.has(f)),c=Tt("custom_begin_output",{id:o()});i[c.id]=c;let p=c.id;return r.forEach(d=>{var y;const f=t[d],h=(y=e(f.type))==null?void 0:y.struct;h&&Object.keys(h.outputs).forEach(k=>{const E=Object.entries(wp(l,d,k));if(E.length===0)return;const g=Tt("custom_output",{id:o(),inputs:{output:{from:{id:p,key:"output"}}},data:{name:h.outputs[k].label??k}});p=g.id,i[g.id]=g,Object.values(Jn(e,i,g.id,"value",d,k)).forEach(v=>{i[v.id]=v}),E.forEach(([v,A])=>{const x=u[v]??t[v],I={...x,inputs:{...x.inputs,...Q(A,(O,T)=>({...x.inputs[T],value:x.inputs[T].value,from:{id:a,key:g.id}}))}};u[I.id]=I})})}),{customGraphNodes:i,updatedNodes:u}}function YO(e,t,n,a){const o=n.map(p=>t[p]),r=ie(o),s={},l={};o.forEach(p=>{Object.entries(p.inputs).forEach(([d,f])=>{var h,y,k;!f.from||r[f.from.id]||(l[h=f.from.id]??(l[h]={}),(y=l[f.from.id])[k=f.from.key]??(y[k]=[]),l[f.from.id][f.from.key].push({id:p.id,key:d}))})});const u=Tt("custom_begin_input",{id:a()});r[u.id]=u;const i=Object.keys(l).map(p=>t[p]).sort((p,d)=>p.position.y-d.position.y).map(p=>p.id);let c=u.id;return i.forEach(p=>{const d=l[p];Object.entries(d).forEach(([f,h])=>{const y=Tt("custom_input",{id:a(),inputs:{input:{from:{id:c,key:"input"}}}});r[y.id]=y,c=y.id,s[y.id]={id:p,key:f},h.forEach(k=>{Object.values(du(e,r,k.id,k.key)).forEach(E=>{r[E.id]=E}),Object.values(Jn(e,r,k.id,k.key,y.id,"value")).forEach(E=>{r[E.id]=E})})})}),{customGraphNodes:r,inputMap:s}}function XO(e){return!["custom_begin_input","custom_input","custom_begin_output","custom_output","get_bone","get_object"].includes(e.type)}function HO(e,t){const n=ke(e),a=n.length>0?n.map(i=>i.position):[{x:0,y:0}],o=Math.min(...a.map(i=>i.x)),r=Math.max(...a.map(i=>i.x)),s=Math.min(...a.map(i=>i.y)),l=Math.max(...a.map(i=>i.y)),u={x:(o+r)/2,y:(s+l)/2};return{...t,position:ee(t.position,u)}}function WO(e){const t=[],n=[],a=[];Object.values(e).forEach(f=>{switch(f.type){case"custom_begin_input":case"custom_begin_output":return;case"custom_input":t.push(f);return;case"custom_output":n.push(f);return;default:a.push(f);return}});const o=new Map(Er(t.reduce((f,h)=>{const y=h.inputs.input.from;return y&&(f[h.id]={[y.id]:!0}),f},{})).map((f,h)=>[f,h])),r=new Map(Er(n.reduce((f,h)=>{const y=h.inputs.output.from;return y&&(f[h.id]={[y.id]:!0}),f},{})).map((f,h)=>[f,h])),s=a.length>0?a.map(f=>f.position):[{x:0,y:0}],l=Math.min(...s.map(f=>f.x)),u=Math.max(...s.map(f=>f.x)),i=Math.min(...s.map(f=>f.y)),c={x:-(l+u)/2,y:-i},p=Or(10,l+c.x-250),d=Or(10,u+c.x+300);return Q(e,f=>{let h;return f.type==="custom_begin_input"?h={x:p,y:0}:f.type==="custom_begin_output"?h={x:d,y:0}:o.has(f.id)?h={x:p,y:210*o.get(f.id)+100}:r.has(f.id)?h={x:d,y:160*r.get(f.id)+100}:h=ee(f.position,c),{...f,position:h}})}function JO(e,t){const n=_n("Graph"),a=_n("Node"),o=_n("CustomGraph"),r=ma("Graph",()=>n.entities.value.byId),s=ma("Node",()=>x.value),l=ma("CustomGraph",()=>o.entities.value.byId),u=Pr("Graph Type",()=>"graph");e.defineReducers(n.reducers),e.defineReducers(a.reducers),e.defineReducers(o.reducers),e.defineReducers(r.reducers),e.defineReducers(s.reducers),e.defineReducers(l.reducers),e.defineReducers(u.reducers);const i=b(()=>nn(n.entities.value)),c=r.lastSelectedId,p=b(()=>r.lastSelectedId.value?n.entities.value.byId[r.lastSelectedId.value]:void 0),d=b(()=>nn(o.entities.value)),f=l.lastSelectedId,h=b(()=>l.lastSelectedId.value?o.entities.value.byId[l.lastSelectedId.value]:void 0),y=b(()=>u.state.value);function k(U){e.dispatch(u.createUpdateAction(U),[s.createClearAllAction()])}function E(){return y.value==="graph"?n:o}function g(){return y.value==="graph"?r:l}function v(){const U=g().lastSelectedId.value;return U?E().entities.value.byId[U]:void 0}const A=b(v),x=b(()=>{const U=v();if(!U)return{};const q=a.entities.value.byId;return ie(U.nodes.map(le=>q[le]))}),I=s.selectedMap,O=s.lastSelectedId,T=b(()=>O.value?a.entities.value.byId[O.value]:void 0),L=b(t.getArmatureId),R=b(()=>UO(a.entities.value.byId,d.value)),B=b(()=>{const U=a.entities.value.byId,q=ie(d.value);return R.value.reduce((le,de)=>{const Re=q[de];return le[de]=yr(N(le),Re,ie(Re.nodes.map(Xe=>U[Xe]))),le},{})});function N(U){return q=>U[q]?U[q]:Ar(q)}const j=b(()=>()=>N(B.value)),K=b(()=>{const U=h.value;if(y.value==="graph"||!U)return d.value;const q=new Set(GO(a.entities.value.byId,d.value,U.id));return d.value.filter(le=>q.has(le.id))}),D=b(()=>ie(K.value)),fe=b(()=>{const U=K.value.length>0?[{label:"Custom",children:K.value.map(q=>({label:q.name,type:q.id}))}]:[];return y.value==="graph"?oc.concat(U):oc.concat([{label:"Input/Output",children:[{type:"custom_input",label:"Input"},{type:"custom_output",label:"Output"}]},...U])}),Le=b(()=>Yw(j.value(),x.value)),Ge=b(()=>Xw(j.value(),x.value,Le.value)),vt=b(()=>{const U=v();if(!U)return;const q=U==null?void 0:U.armatureId,le=$p(q?t.getElementMap(q):{},t.getPosedBoneMap(),{currentFrame:t.getCurrentFrame(),endFrame:t.getEndFrame()}),de=su(j.value(),le,Ge.value);return{context:le,nodeMap:de}});function $e(U,q,le,de,Re,Xe,gt){n.init(Ft(U)),o.init(Ft(q)),a.init(Ft(le)),r.restore(de),l.restore(Re),s.restore(Xe),u.restore(gt)}function oe(){return{graphs:i.value,customGraphs:d.value,nodes:nn(a.entities.value),graphSelected:r.createSnapshot(),customGraphSelected:l.createSnapshot(),nodeSelected:s.createSnapshot(),graphType:u.createSnapshot()}}function _e(U=""){const q=[s.createClearAllAction()],le=U?n.entities.value.byId[U]?"graph":"custom":y.value;U&&(le==="graph"?q.push(u.createUpdateAction("graph")):q.push(u.createUpdateAction("custom"))),le==="graph"?e.dispatch(r.createSelectAction(U),q):e.dispatch(l.createSelectAction(U),q)}function De(U={}){if(!L.value)return;const q=Rf({id:U.id,name:qt(U.name??"Graph",i.value.map(le=>le.name)),armatureId:L.value},!U.id);e.dispatch(n.createAddAction([q]),[s.createClearAllAction(),r.createSelectAction(q.id)])}function dt(){const U=p.value;U&&e.dispatch(n.createDeleteAction([U.id]),[a.createDeleteAction(U.nodes),s.createClearAllAction(),r.createClearAllAction()])}function Mt(U){c.value&&e.dispatch(n.createUpdateAction({[c.value]:U}))}function Y(U="",q){!v()||!s.getSelectHistoryDryRun(U,q==null?void 0:q.shift)||e.dispatch(s.createSelectAction(U,q==null?void 0:q.shift))}function pe(U,q){const le=Object.keys(U);s.getMultiSelectHistoryDryRun(le,q==null?void 0:q.shift)&&e.dispatch(s.createMultiSelectAction(le,q==null?void 0:q.shift))}function Ee(){Object.keys(x.value).length!==0&&e.dispatch(s.createSelectAllAction(!0))}function me(U,q={}){v()||(y.value==="graph"?De():te());const le=v();if(!le)return;const de=fp(B.value,U,q,!q.id);return e.dispatch(a.createAddAction([de]),[E().createUpdateAction({[le.id]:{nodes:[...le.nodes,de.id]}}),s.createSelectAction(de.id)]),de}function ne(U){return y.value==="graph"?!Nw(U.type):!!D.value[U.type]||!!Ar(U.type)&&!lu(U.type)}function we(U){const q=v(),le=U.filter(de=>ne(de));!q||le.length===0||e.dispatch(a.createAddAction(le),[E().createUpdateAction({[q.id]:{nodes:q.nodes.concat(le.map(de=>de.id))}}),s.createMultiSelectAction(le.map(de=>de.id))])}function $(){const U=v();if(!U)return;const q=Vw(j.value(),ke(x.value),I.value),le=ie(q.nodes),de=tt(le,q.updatedIds),Re=Uo(j.value(),{...le,...de}),Xe=_t(I.value,le),gt={...de,...Re},Ot=qe=>{e.dispatch(a.createDeleteAction(Object.keys(Xe)),[a.createUpdateAction(qe),E().createUpdateAction({[U.id]:{nodes:U.nodes.filter(rt=>!Xe[rt])}}),s.createClearAllAction()])};if(y.value==="custom"&&h.value){const qe={..._t(x.value,Xe),...gt},rt=yr(j.value(),{...h.value,nodes:Object.keys(qe)},qe).struct;if(ic(B.value[h.value.id].struct,rt)){const ft=uc(j.value(),{..._t(a.entities.value.byId,Xe),...qe},h.value.id,rt);Ot(ft)}else Ot(gt)}else Ot(gt)}function P(U,q,le){v()&&e.dispatch(a.createUpdateAction({[U]:q},le))}function G(U){if(v())if(y.value==="custom"&&h.value){const le=Mr(x.value,U),de=yr(j.value(),h.value,le).struct;if(ic(B.value[h.value.id].struct,de)){const Re=uc(j.value(),{...a.entities.value.byId,...le},h.value.id,de);e.dispatch(a.createUpdateAction({...U,...Re}))}else e.dispatch(a.createUpdateAction(U))}else e.dispatch(a.createUpdateAction(U))}function z(){const U=v();if(!U)return;const q=x.value,le=Object.keys(I.value),de=KO(j.value(),q,le,We),Re=HO(Je(q,(qe,rt)=>I.value[rt]),de.customNode),Xe=WO(de.customGraphNodes),gt={...de.customGraph,name:V()},Ot=new Set(le);e.dispatch(a.createAddAction(ke(Xe).filter(qe=>!Ot.has(qe.id))),[o.createAddAction([gt]),a.createAddAction([Re]),s.createSelectAction(Re.id),E().createUpdateAction({[U.id]:{nodes:[...U.nodes.filter(qe=>!Xe[qe]),Re.id]}}),a.createUpdateAction({...de.updatedNodes,...Je(Xe,(qe,rt)=>Ot.has(rt))})])}function V(U){return qt(U??"Custom",d.value.map(q=>q.name))}function te(U={}){const q=Tt("custom_begin_input",{position:{x:-200,y:0}},!0),le=Tt("custom_begin_output",{position:{x:200,y:0}},!0),de=Wl({id:U.id,name:V(U.name),nodes:[q.id,le.id]},!U.id);e.dispatch(o.createAddAction([de]),[a.createAddAction([q,le]),l.createSelectAction(de.id)])}function ge(){const U=h.value;U&&e.dispatch(o.createDeleteAction([U.id]),[a.createDeleteAction(U.nodes),s.createClearAllAction(),l.createClearAllAction()])}function ae(U){f.value&&e.dispatch(o.createUpdateAction({[f.value]:U}))}const re=H(),Z=H(),Oe=b(()=>{if(!re.value)return x.value;const U=Ce(re.value.current,re.value.start),q=I.value;return Q(x.value,(le,de)=>q[de]?{...le,position:ee(le.position,U)}:le)}),xe=b(()=>Q(Oe.value,U=>Sk(j.value(),U))),Te=b(()=>{var le;const U=((le=Z.value)==null?void 0:le.type)==="draft-output"?Z.value.inputs.reduce((de,Re)=>(de[Re.nodeId]={[Re.key]:!0},de),{}):{},q=Oe.value;return Q(q,de=>{var gt;const Re=xe.value[de.id].inputs,Xe=(gt=j.value()(de.type))==null?void 0:gt.struct;return Object.entries(de.inputs).reduce((Ot,[qe,rt])=>{var ft;return!rt.from||!xe.value[rt.from.id]||!xe.value[rt.from.id].outputs[rt.from.key]||(ft=U[de.id])!=null&&ft[qe]||(Ot[qe]={from:ee(q[rt.from.id].position,xe.value[rt.from.id].outputs[rt.from.key].p),to:ee(de.position,Re[qe].p),inputId:de.id,inputKey:qe,outputId:rt.from.id,outputKey:rt.from.key,type:un(Xe,de,qe)}),Ot},{})})});return{initState:$e,exportState:oe,graphType:y,setGraphType:k,parentGraphs:b(()=>nn(E().entities.value)),parentGraph:b(v),graphs:i,lastSelectedGraph:p,customGraphs:d,lastSelectedCustomGraph:h,selectedGraphByType:A,nodeMap:x,lastSelectedNode:T,selectedNodes:I,targetArmatureId:L,getGraphNodeModuleFn:j,nodeItemList:fe,nodeErrorMessagesMap:Le,completedNodeMap:Ge,resolvedGraph:vt,switchGraph:_e,addGraph:De,deleteGraph:dt,updateGraph:Mt,selectNode:Y,selectNodes:pe,selectAllNode:Ee,addNode:me,deleteNodes:$,pasteNodes:we,updateNode:P,updateNodes:G,makeCustomGraphFromSelectedNodes:z,addCustomGraph:te,deleteCustomGraph:ge,updateCustomGraph:ae,editMovement:b(()=>re.value),setEditMovement:U=>{re.value=U},draftEdge:b(()=>Z.value),setDraftEdge:U=>{Z.value=U},editedNodeMap:Oe,edgePositionMap:xe,edgeSummaryMap:Te}}const qO=JO(ea(),{getArmatureId:()=>jt().lastSelectedArmatureId.value,getPosedBoneMap:()=>dn().posedBoneMap.value,getCurrentFrame:()=>cn().currentFrame.value,getEndFrame:()=>cn().endFrame.value,getElementMap:e=>{var n;const t=In();return((n=t.lastSelectedActor.value)==null?void 0:n.armatureId)===e?t.elementMap.value:{}}});function Ko(){return qO}function Nm(e,t,n){return Vm(e,t,n)}function Vm(e,t,n){if(mt(e))return e;const a=hl(e.tag,Bp({...e.attributes,...(n==null?void 0:n[e.id])??{}}),e.children.map(o=>Vm(o,t,n)));return t!=null&&t[e.id]&&a.classList.add(t[e.id]),a}const ZO="http://www.w3.org/2000/svg";function hl(e,t=null,n=[]){const a=document.createElementNS(ZO,e);return QO(a,t,n)}function QO(e,t=null,n=[]){for(const a in t)e.setAttribute(a,t[a].toString());return Array.isArray(n)?eT(e,n):e.textContent=n,e}function eT(e,t){const n=document.createDocumentFragment();for(let a=0;a<t.length;a++){const o=t[a];mt(o)?n.appendChild(new Text(o)):n.appendChild(o)}e.appendChild(n)}const Dm="blendic-viewbox-g",tT="blendic-anim-group";function nT(e,t,n,a,o="infinite",r="discrete",s=1,l){const u=S0(n,s,!0),i=aT(t,l),c=oT(i.id,u,l),p=Go([i]),d=p.map(T=>T.id),f=d.reduce((T,L)=>(T[L]=c.map(R=>R[L]),T),{}),h=Q(f,T=>dT(_0(T))),y=uT(h),k=Q(h,(T,L)=>T.map(R=>{const B=y[L];return!B||!R?R:Je(R,(N,j)=>!B[j])}).map(R=>!R||Object.keys(R).length===0?void 0:R)),E=p.reduce((T,L,R)=>{var B;return(L.id===i.id||(B=k[L.id])!=null&&B.some(N=>!!N))&&(T[L.id]=`${e}-${R}`),T},{}),g=hl("g"),v=new Map(d.map(T=>[T,mT(T,k[T],a,o,r)]).filter(([,T])=>!!T));g.classList.add(tT),g.innerHTML=d.map(T=>v.get(T)??"").join("");const A=hl("style");A.innerHTML=d.map(T=>iT(E[T],k[T])).join("")+`.${E[i.id]} * {animation-duration:${a/1e3}s;animation-iteration-count:${o};animation-timing-function:${vT(r)};}`;const x=new Set([...v.keys(),...Object.keys(y)]),I=Array.from(x).reduce((T,L)=>(T[L]=y[L]??{},v.has(L)&&(T[L].id=L),T),{}),O=Nm(i,E,I);return O.prepend(g),O.prepend(A),O}function aT(e,t){return{...e,attributes:Fm(e.attributes,t),children:[{id:Dm,tag:"g",attributes:{},children:e.children}]}}function oT(e,t,n){return t.map(a=>{var o;return{...a,[e]:Fm(a[e],n),[Dm]:{transform:rT((o=a[e])==null?void 0:o.viewBox,n)}}})}const Lr=100;function Fm(e,t={width:Lr,height:Lr}){const n={...e};return n.viewBox=`0 0 ${t.width} ${t.height}`,delete n.width,delete n.height,n}function rT(e,t={width:Lr,height:Lr}){const n=us(e);if(!n)return"";const a=t.width/n.width,o=t.height/n.height,r=Math.min(a,o),s=(t.width-n.width*r)/2,l=(t.height-n.height*r)/2;return Au([r,0,0,r,s-n.x*r,l-n.y*r])}function sT(e){return e[0]===e[e.length-1]&&e.filter(t=>!!t).length===2}function Iu(e){return Array.from(new Set(e.flatMap(n=>n?Object.keys(n):[]))).reduce((n,a)=>(n[a]=e.map(o=>o==null?void 0:o[a]),n),{})}function lT(e){const t=Object.keys(e);return t.length===0?[]:e[t[0]].map((n,a)=>t.reduce((o,r)=>{const s=e[r][a];return s&&(o[r]=s),o},{}))}function uT(e){return Object.keys(e).reduce((t,n)=>{const a=Iu(e[n]),o=Object.keys(a).reduce((r,s)=>{const l=a[s];return sT(l)&&(r[s]=l[0]),r},{});return Object.keys(o).length>0&&(t[n]=o),t},{})}function iT(e,t){const n=Je(Iu(t),(o,r)=>zm(r)),a=cT(e,lT(n));return a?a+pT(e):""}function cT(e,t){const n=Math.ceil(Math.log10(t.length)),a=Gm(t.length,100).map(r=>zt(-n,r)),o=t.map((r,s)=>fT(r,a[s])).filter(r=>r);return o.length===0?"":`@keyframes ${Um(e)} {${o.join(" ")}}`}function dT(e){const t=Array.from(new Set(e.flatMap(r=>r?Object.keys(r):[]))),n=Dc(e,t),a=Dc(e.concat().reverse(),t),o=e.concat();return o[0]=n,o[o.length-1]=a,o}function Dc(e,t){return t.reduce((n,a)=>{const o=e.find(r=>(r==null?void 0:r[a])!==void 0);return o&&(n[a]=o[a]),n},{})}function fT(e,t){const n=Object.entries(e??{}).filter(([o])=>zm(o));if(n.length===0)return"";const a=n.map(([o,r])=>`${o}:${r};`).join("");return`${t}%{${a}}`}function pT(e){return`.${e}{animation-name:${Um(e)};}`}function Um(e){return`ba-${e}`}function mT(e,t,n,a="infinite",o="discrete"){const r=Je(Iu(t),(s,l)=>gT(l));return Object.keys(r).map(s=>hT(e,s,r[s],n,a,o)).join("")}function Gm(e,t=1){if(e===0)return[];if(e===1)return[0,t];const n=t/(e-1),a=[...Array(e)].map((o,r)=>n*r);return a[a.length-1]=t,a}function hT(e,t,n,a,o="infinite",r="discrete"){const s=Gm(n.length),l=[],u=[];return n.forEach((c,p)=>{c!==void 0&&(l.push(`${s[p]}`),u.push(`${c}`))}),l.length===0?"":`<animate ${[...r!=="linear"?[["calcMode",r]]:[],["repeatCount",typeof o=="string"?"indefinite":o],["dur",`${a/1e3}s`],["href",`#${e}`],["xlink:href",`#${e}`],["attributeName",`${t}`],["keyTimes",l.join(";")],["values",u.join(";")]].map(([c,p])=>`${c}="${p}"`).join(" ")}/>`}function yT(e,t=!1){let n;return e.forEach(a=>{n?n=Km(n,a,t):n=a}),n}function Km(e,t,n=!1){const a=new Map;t.children.forEach((s,l)=>{mt(s)||a.set(s.id,[l,s])});const o=[];let r=-1;return e.children.forEach(s=>{if(mt(s))o.push(s);else{const l=a.get(s.id);if(l){const u=l[0];u-r>1&&o.push(...t.children.slice(r+1,u).filter(i=>!mt(i)).map(i=>n?yl(i):i)),r=u,o.push(Km(s,l[1],n))}else o.push(s)}}),r<t.children.length&&o.push(...t.children.slice(r+1,t.children.length).filter(s=>!mt(s)).map(s=>n?yl(s):s)),{id:e.id,tag:e.tag,attributes:e.attributes,children:o}}function yl(e){return{...e,attributes:{...e.attributes,fill:"none",stroke:"none"},children:e.children.map(t=>mt(t)?t:yl(t))}}function vT(e="discrete"){switch(e){case"linear":return"linear";default:return"step-start"}}function zm(e){return bT.has(e)}function gT(e){return _T.has(e)}const bT=new Set(["transform","fill","fill-opacity","stroke","stroke-opacity","stroke-width","stroke-dashoffset","stroke-dasharray","font-size","text-anchor","dominant-baseline","x","y","dx","dy","width","height","cx","cy","r","rx","ry","fx","fy","x1","y1","x2","y2","gradientUnits","spreadMethod","stop-color","stop-opacity"]),_T=new Set(["d","offset"]),Ns="showOpenFilePicker"in window,vl="blendic.json";let Rn;function Pu(){const e=jt(),t=cn(),n=ea(),a=dn(),o=In(),r=Ko();function s(){const{armatures:g,bones:v,constraints:A,armatureSelected:x,boneSelected:I}=e.exportState(),O=t.exportState(),{actions:T,keyframes:L}=tC(O.actions,O.keyframes,g,v),{canvasMode:R}=a.exportState(),B=o.exportState(),{actors:N,elements:j}=ek(B.actors,B.elements,g,v),K=r.exportState(),D=K.graphs,fe=K.nodes,Le={armatures:g,bones:v,constraints:A,armatureSelected:x,boneSelected:I,canvasMode:R,currentFrame:O.currentFrame,endFrame:O.endFrame,actions:T,keyframes:L,actionSelected:O.actionSelected,keyframeState:O.keyframeState,targetPropsState:O.targetPropsState,actors:N,elements:j,actorSelected:B.actorSelected,elementSelected:B.elementSelected,graphs:D,customGraphs:K.customGraphs,nodes:fe,graphSelected:K.graphSelected,customGraphSelected:K.customGraphSelected,nodeSelected:K.nodeSelected,graphType:K.graphType};return JSON.stringify(Le)}function l(g){try{const v=wO(JSON.parse(g));n.clear(),e.initState(v.armatures,v.bones,v.constraints,v.armatureSelected,v.boneSelected),a.initState(v.canvasMode),t.initState(v.currentFrame,v.endFrame,v.actions,v.keyframes,v.actionSelected,v.keyframeState,v.targetPropsState),o.initState(v.actors,v.elements,v.actorSelected,v.elementSelected),r.initState(v.graphs,v.customGraphs,v.nodes,v.graphSelected,v.customGraphSelected,v.nodeSelected,v.graphType)}catch(v){console.error(v),alert("Failed to load: Invalid file.")}}async function u(){let g;try{if(Ns){const v=await kT();if(!v)return;Rn=v.handle,g=v.content}else{const v=await Uc();g=await Gc(v)}}catch{alert("Failed to open a file.")}if(g)try{l(g)}catch{Rn=void 0,alert("Failed to load: Invalid file.")}}async function i(){const g=s();Vs(g,(Rn==null?void 0:Rn.name)??vl)}async function c(){const g=s();Rn?await Hm(Rn,g):Ns?Rn=await ET(g):Vs(g,vl)}async function p(g=!1){try{const v=await Uc(".svg, image/svg+xml"),A=await Gc(v),{actor:x,elements:I}=Jw(A);if(g&&o.lastSelectedActor.value){const O=tk({actor:o.lastSelectedActor.value,elements:ke(o.elementMap.value)},{actor:x,elements:I});o.importActor(O.actor,O.elements)}else o.importActor(x,I)}catch{alert("Failed to load: Invalid file.")}}function d(g){const v=e.lastSelectedArmature.value,A=o.lastSelectedActor.value;if(!v||!A)return;const x=js(A.svgTree),I=t.exportState(),O=ie(I.actions),T=ie(I.keyframes),L=g.filter(B=>O[B]).map(B=>{const N=O[B],j=N.keyframes.map(D=>T[D]),K=iO(Ka(j),e.boneMap.value,e.constraintMap.value,o.elementMap.value,x,rC(j));return{name:N.name,attributesMapPerFrame:K}});Vs(JSON.stringify({version:"1.0.0",appVersion:"0.18.1",actions:L,svgTree:x}),L.map(B=>B.name).join("_")+".json")}function f(g){return{id:g.id,tag:g.tag,index:g.index,parentId:g.parentId}}function h(g,v,A,x=!1){const I=o.lastSelectedActor.value,O=o.elementMap.value,T=x?Q(O,f):O,L=js(Sm(A,T,I.svgTree)),R=cc(r.getGraphNodeModuleFn.value(),T,A,{currentFrame:g,endFrame:v},r.completedNodeMap.value);return Cm(R,L)}function y(){if(!o.lastSelectedActor.value)return;const v=h(t.currentFrame.value,t.endFrame.value,t.currentPosedBones.value),A=t.selectedAction.value,x=r.lastSelectedGraph.value,I=[A==null?void 0:A.name,x==null?void 0:x.name].filter(O=>!!O).join("_");Fc(new XMLSerializer().serializeToString(Nm(v)),`${I}.svg`)}function k(g){if(!o.lastSelectedActor.value)return;const[A,x]=g.range==="auto"?[0,t.endFrame.value]:[g.customRange.from,Math.max(g.customRange.from,g.customRange.to)],I=x-A+1,O=[...Array(I)].map((_e,De)=>A+De),T=t.selectedAction.value,L=ie(t.keyframes.value),R=Ka((T==null?void 0:T.keyframes.map(_e=>L[_e]))??[]),B=new Map(O.map(_e=>[_e,Em(R,e.boneMap.value,e.constraintMap.value,_e)])),N=O.map(_e=>h(_e,x,B.get(_e),!0)),j=yT(N,!0);if(!j)return;const K={...ie(ls(j)),...o.elementMap.value},D=js(j),fe=new Map(O.map(_e=>[_e,km(B.get(_e),K,D)])),Le=Q(ie(Go([j])),_e=>_e.attributes),Ge=O.map(_e=>{const De=cc(r.getGraphNodeModuleFn.value(),K,B.get(_e),{currentFrame:_e,endFrame:x},r.completedNodeMap.value),dt=fe.get(_e);return fO(De,Q(Le,(Mt,Y)=>({...Mt,...dt[Y]})))}),vt=r.lastSelectedGraph.value,$e=g.duration==="auto"?(I-1)*100/6:g.customDuration,oe=nT([T==null?void 0:T.id,vt==null?void 0:vt.id].filter(_e=>!!_e).join("-")??"bsvg",D,Ge,$e,"infinite",g.interpolation,g.fps/60,g.size==="custom"?g.customSize:void 0);return g.size==="custom"&&(oe.setAttribute("width",`${g.customSize.width}px`),oe.setAttribute("height",`${g.customSize.height}px`)),oe}function E(g){const v=k(g);if(!v)return;const A=t.selectedAction.value,x=r.lastSelectedGraph.value,I=[A==null?void 0:A.name,x==null?void 0:x.name,"anim"].filter(O=>!!O).join("-");Fc(new XMLSerializer().serializeToString(v),`${I}.svg`)}return{fileSystemEnable:Ns,loadProjectFile:u,saveProjectFile:i,overrideProjectFile:c,loadSvgFile:p,bakeAction:d,bakeSvg:y,bakeAnimatedSvg:k,bakeAndSaveAnimatedSvg:E}}function Vs(e,t){Ym(URL.createObjectURL(new Blob([e],{type:"text/plain"})),t)}const ST='<?xml version = "1.0" standalone = "no"?>';function Fc(e,t){Ym(URL.createObjectURL(new Blob([`${ST}
${e}`],{type:"image/svg+xml"})),t)}function Ym(e,t){const n=document.createElement("a");n.href=e,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function Uc(e=".json, application/json"){return new Promise((t,n)=>{const a=document.createElement("input");a.type="file",a.accept=e,a.onchange=o=>{const r=o==null?void 0:o.target;r!=null&&r.files?t(r.files[0]):n()},a.click()})}function Gc(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=()=>{t(a.result)},a.onerror=n,a.readAsText(e)})}const Xm={types:[{description:"JSON File",accept:{"text/plain":[".json"]}}]};async function xT(e){var t;try{const[n]=await window.showOpenFilePicker(e);return n}catch(n){if(n instanceof Error&&((t=n.message)!=null&&t.includes("aborted")))return;throw n}}async function wT(e){var t;try{return await window.showSaveFilePicker({...e,suggestedName:vl})}catch(n){if(n instanceof Error&&((t=n.message)!=null&&t.includes("aborted")))return;throw n}}async function kT(){const e=await xT(Xm);if(!e)return;const n=await(await e.getFile()).text();return{handle:e,content:n}}async function ET(e){const t=await wT(Xm);if(t)return await Hm(t,e),t}async function Hm(e,t){var n;try{const a=await e.createWritable();await a.write(t),await a.close()}catch(a){if(a instanceof Error&&((n=a.message)!=null&&n.includes("not allowed")))return;throw a}}const ms=e=>(it("data-v-94cf5f9e"),e=e(),ct(),e),CT=ms(()=>C("h3",null,"Animation Settings",-1)),MT={class:"content"},OT={class:"settings"},TT=ms(()=>C("span",{class:"slider-between"},"to",-1)),$T=ms(()=>C("span",{class:"slider-between"},"x",-1)),AT={class:"preview"},IT={class:"preview-outer"},PT=["src"],BT={key:1},LT=ms(()=>C("span",null,"Size(b): ",-1)),RT=Pu(),jT=J({__name:"AnimatedSvgSettingDialog",props:{open:{type:Boolean},settings:null},emits:["update:open","execute"],setup(e,{emit:t}){const n=e,a=H({...n.settings,customRange:{...n.settings.customRange},customSize:{...n.settings.customSize}}),o=[5,10,20,30,60].map(d=>({value:d,label:`${d}`})),r=[{value:"discrete",label:"Discrete"},{value:"linear",label:"Linear"}],s=[{value:"auto",label:"Auto"},{value:"custom",label:"Custom"}];function l(d){t("update:open",d)}function u(){t("execute",a.value)}const i=b({get(){return a.value.customDuration/1e3},set(d){a.value.customDuration=d*1e3}}),c=H();function p(){const d=RT.bakeAnimatedSvg(a.value);if(!d)return;const f=new XMLSerializer().serializeToString(d);c.value={src:"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(f))),size:new Blob([f]).size}}return pt(()=>n.open,()=>{c.value=void 0}),(d,f)=>(_(),Se(Fl,{to:"body"},[w(_m,{open:e.open,"onUpdate:open":l},{default:F(()=>[CT,C("div",MT,[C("div",OT,[w(ue,{label:"FPS",between:""},{default:F(()=>[w(Vn,{modelValue:a.value.fps,"onUpdate:modelValue":f[0]||(f[0]=h=>a.value.fps=h),options:m(o)},null,8,["modelValue","options"])]),_:1}),w(ue,{label:"FPS(Custom)",between:""},{default:F(()=>[w(Ae,{modelValue:a.value.fps,"onUpdate:modelValue":f[1]||(f[1]=h=>a.value.fps=h),min:1,max:60,integer:"",class:"inline-slider"},null,8,["modelValue"])]),_:1}),w(ue,{label:"Interpolation",between:""},{default:F(()=>[w(Vn,{modelValue:a.value.interpolation,"onUpdate:modelValue":f[2]||(f[2]=h=>a.value.interpolation=h),options:r},null,8,["modelValue"])]),_:1}),w(ue,{label:"Range",between:""},{default:F(()=>[w(Vn,{modelValue:a.value.range,"onUpdate:modelValue":f[3]||(f[3]=h=>a.value.range=h),options:s},null,8,["modelValue"])]),_:1}),w(ue,{label:"Custom Range",between:""},{default:F(()=>[w(Ae,{modelValue:a.value.customRange.from,"onUpdate:modelValue":f[4]||(f[4]=h=>a.value.customRange.from=h),min:0,disabled:a.value.range!=="custom",class:"inline-slider"},null,8,["modelValue","disabled"]),TT,w(Ae,{modelValue:a.value.customRange.to,"onUpdate:modelValue":f[5]||(f[5]=h=>a.value.customRange.to=h),min:0,disabled:a.value.range!=="custom",class:"inline-slider"},null,8,["modelValue","disabled"])]),_:1}),w(ue,{label:"Duration",between:""},{default:F(()=>[w(Vn,{modelValue:a.value.duration,"onUpdate:modelValue":f[6]||(f[6]=h=>a.value.duration=h),options:s},null,8,["modelValue"])]),_:1}),w(ue,{label:"Custom Duration (s)",between:""},{default:F(()=>[w(Ae,{modelValue:m(i),"onUpdate:modelValue":f[7]||(f[7]=h=>Fe(i)?i.value=h:null),min:0,step:.1,disabled:a.value.duration!=="custom",class:"inline-slider"},null,8,["modelValue","step","disabled"])]),_:1}),w(ue,{label:"Size",between:""},{default:F(()=>[w(Vn,{modelValue:a.value.size,"onUpdate:modelValue":f[8]||(f[8]=h=>a.value.size=h),options:s},null,8,["modelValue"])]),_:1}),w(ue,{label:"Custom Size (px)",between:""},{default:F(()=>[w(Ae,{modelValue:a.value.customSize.width,"onUpdate:modelValue":f[9]||(f[9]=h=>a.value.customSize.width=h),min:0,disabled:a.value.size!=="custom",class:"inline-slider"},null,8,["modelValue","disabled"]),$T,w(Ae,{modelValue:a.value.customSize.height,"onUpdate:modelValue":f[10]||(f[10]=h=>a.value.customSize.height=h),min:0,disabled:a.value.size!=="custom",class:"inline-slider"},null,8,["modelValue","disabled"])]),_:1})]),C("div",AT,[C("div",null,[w(bo,{onClick:p},{default:F(()=>[$t(Ve(c.value?"Reset":"Preview"),1)]),_:1})]),C("div",IT,[c.value?(_(),M("img",{key:0,src:c.value.src,alt:"Preview"},null,8,PT)):(_(),M("p",BT,"None"))]),C("p",null,[LT,C("span",null,Ve(c.value?c.value.size.toLocaleString():"-"),1)])])])]),buttons:F(()=>[w(bo,{onClick:f[11]||(f[11]=h=>l(!1))},{default:F(()=>[$t("Cancel")]),_:1}),w(bo,{type:"primary",onClick:u},{default:F(()=>[$t("Export")]),_:1})]),_:1},8,["open"])]))}});const NT=Me(jT,[["__scopeId","data-v-94cf5f9e"]]),hs=e=>(it("data-v-ba382ba6"),e=e(),ct(),e),VT={class:"file-panel"},DT=hs(()=>C("h3",null,"Project",-1)),FT={class:"menu-list"},UT=hs(()=>C("h3",null,"Import",-1)),GT={class:"menu-list"},KT=hs(()=>C("h3",null,"Export",-1)),zT={class:"menu-list"},YT=["disabled"],XT=hs(()=>C("h3",null,"App",-1)),or=Pu(),HT=jt(),WT=cn(),JT=J({__name:"FilePanel",setup(e){const t=H(!0),n=H(!1),a=H([]),o=b(()=>WT.actions.value.filter(A=>{var x;return((x=HT.lastSelectedArmature.value)==null?void 0:x.id)===A.armatureId}));function r(A){n.value=!1,a.value=A,or.bakeAction(A)}const s=H(!1),{settings:l}=Ct();function u(A){l.animationExportingSettings=A,or.bakeAndSaveAnimatedSvg(A),s.value=!1}const i=[{value:"auto",label:"Auto"},{value:"light",label:"Light"},{value:"dark",label:"Dark"}],c=b({get(){return l.colorTheme},set(A){l.colorTheme=A}}),p="0.18.1",{fileSystemEnable:d,loadProjectFile:f,saveProjectFile:h,overrideProjectFile:y,bakeSvg:k}=or;function E(){or.loadSvgFile(t.value)}function g(){n.value=!0}function v(){s.value=!0}return(A,x)=>(_(),M("div",VT,[DT,C("div",FT,[C("button",{type:"button",onClick:x[0]||(x[0]=(...I)=>m(f)&&m(f)(...I))},"Open"),C("button",{type:"button",onClick:x[1]||(x[1]=(...I)=>m(y)&&m(y)(...I))},"Save"),m(d)?(_(),M("button",{key:0,type:"button",onClick:x[2]||(x[2]=(...I)=>m(h)&&m(h)(...I))}," Save as.. ")):ce("",!0)]),UT,C("div",GT,[C("button",{type:"button",onClick:E},"SVG"),w(ut,{modelValue:t.value,"onUpdate:modelValue":x[3]||(x[3]=I=>t.value=I),label:"Inherit weight"},null,8,["modelValue"])]),KT,C("div",zT,[C("button",{type:"button",disabled:m(o).length===0,onClick:g}," Baked Action ",8,YT),C("button",{type:"button",onClick:x[4]||(x[4]=(...I)=>m(k)&&m(k)(...I))},"Posed SVG"),C("button",{type:"button",onClick:v}," Animated SVG ")]),XT,w(ue,{label:"Theme",between:""},{default:F(()=>[w(Vn,{modelValue:m(c),"onUpdate:modelValue":x[5]||(x[5]=I=>Fe(c)?c.value=I:null),options:i},null,8,["modelValue"])]),_:1}),w(ue,{label:"Version",between:""},{default:F(()=>[C("span",null,Ve(m(p)),1)]),_:1}),w(nO,{open:n.value,"onUpdate:open":x[6]||(x[6]=I=>n.value=I),actions:m(o),onExecute:r},null,8,["open","actions"]),w(NT,{open:s.value,"onUpdate:open":x[7]||(x[7]=I=>s.value=I),settings:m(l).animationExportingSettings,onExecute:u},null,8,["open","settings"])]))}});const qT=Me(JT,[["__scopeId","data-v-ba382ba6"]]),Ca={};function Wm(e,t){const n=t.provide??Wa;t.getSelectedMap&&n("getSelectedMap",t.getSelectedMap),t.getEditable&&n("getEditable",t.getEditable),t.updateName&&n("updateName",t.updateName),t.onClickElement&&n("onClickElement",t.onClickElement),Ca[e]??(Ca[e]=H({})),n("getClosedMap",()=>Ca[e].value),n("setClosed",(a,o)=>{o?Ca[e].value[a]=o:delete Ca[e].value[a]})}function ZT(e=ba){return{getSelectedMap:e("getSelectedMap",()=>({})),getEditable:e("getEditable",()=>!1),updateName:e("updateName",()=>{}),onClickElement:e("onClickElement",()=>{}),getClosedMap:e("getClosedMap",()=>({})),setClosed:e("setClosed",()=>{})}}const QT=["data-scroll_anchor"],e$={key:1,class:"spacer",style:{width:"16px"}},t$=["onClick","onDblclick"],n$={class:"children-space"},a$={name:"TreeNodeVue"},o$=J({...a$,props:{node:null,nestIndex:{default:0}},emits:["expand-all"],setup(e,{emit:t}){const n=e,a=b(()=>n.node.children),{getEditable:o,getSelectedMap:r,updateName:s,onClickElement:l,getClosedMap:u,setClosed:i}=ZT(),c=b(()=>!!r()[n.node.id]);pt(c,(x,I)=>{x&&!I&&t("expand-all")});function p(){i(n.node.id,!1),t("expand-all")}const d=b(()=>!!u()[n.node.id]);function f(){i(n.node.id,!d.value)}const h=H(!1),y=b(o),k=b(()=>n.node.children.length>0),E=x=>l(n.node.id,gn(x));function g(){y.value&&(h.value=!0)}function v(){h.value=!1}function A(x){y.value&&(s(n.node.id,x),h.value=!1)}return(x,I)=>{const O=jl("TreeNodeVue");return _(),M("div",{class:et(["tree-node",{"has-children":m(k)}])},[C("div",{"data-scroll_anchor":e.node.id,class:"node-view"},[C("div",{class:"spacer",style:st({width:`${e.nestIndex*8}px`})},null,4),m(k)?(_(),M("button",{key:0,type:"button",class:"toggle-closed",onClick:f},[w(xr,{flipped:!m(d),right:m(d)},null,8,["flipped","right"])])):(_(),M("div",e$)),h.value?(_(),Se(Gn,{key:2,"model-value":e.node.name,autofocus:"","onUpdate:modelValue":A,onBlur:v},null,8,["model-value"])):(_(),M("a",{key:3,class:et(["node-name",{selected:m(c)}]),onClick:Ke(E,["left","prevent"]),onDblclick:Ke(g,["prevent"])},Ve(e.node.name),43,t$))],8,QT),Qn(C("div",n$,[(_(!0),M(ye,null,Pe(m(a),T=>(_(),Se(O,{key:T.id,node:T,"nest-index":e.nestIndex+1,onExpandAll:p},null,8,["node","nest-index"]))),128))],512),[[mf,!m(d)]])],2)}}});const Jm=Me(o$,[["__scopeId","data-v-f69cba8f"]]),qm=J({__name:"TreeContainer",props:{scrollTarget:null},setup(e){const t=e,n=H();return rn(async()=>{var a,o;t.scrollTarget&&n.value&&(await Ha(),(o=(a=n.value)==null?void 0:a.querySelector(`[data-scroll_anchor="${t.scrollTarget}"]`))==null||o.scrollIntoView({behavior:"smooth",block:"center"}))}),(a,o)=>(_(),M("div",{ref_key:"scrollContainer",ref:n},[at(a.$slots,"default")],512))}}),Vt=jt(),r$=dn(),s$=J({__name:"ArmatureTreePanel",setup(e){const t=b(()=>{if(Vt.lastSelectedArmature.value)return{id:Vt.lastSelectedArmature.value.id,name:Vt.lastSelectedArmature.value.name,children:nu(Vt.boneMap.value)}}),n=b(()=>Vt.lastSelectedBoneId.value);function a(r,s){Vt.lastSelectedArmature.value&&(r===Vt.lastSelectedArmature.value.id?Vt.selectAllBones():Vt.selectBone(r,{head:!0,tail:!0},s,r$.canvasMode.value==="pose"))}function o(r,s){Vt.lastSelectedArmature.value&&(r===Vt.lastSelectedArmature.value.id?Vt.updateArmatureName(s):Vt.updateBone({name:s}))}return Wm("armature",{onClickElement:a,getSelectedMap:()=>Q(Vt.selectedBones.value,()=>!0),getEditable:()=>!0,updateName:o}),(r,s)=>m(t)?(_(),Se(qm,{key:0,"scroll-target":m(n),class:"tree-view"},{default:F(()=>[w(Jm,{node:m(t)},null,8,["node"])]),_:1},8,["scroll-target"])):ce("",!0)}}),rr=In(),l$=J({__name:"ElementTreePanel",setup(e){const t=b(()=>{const a=rr.lastSelectedActor.value;if(a)return Tp(a.svgTree)}),n=b(()=>rr.lastSelectedElementId.value);return Wm("element",{onClickElement:rr.selectElement,getSelectedMap:()=>rr.selectedElements.value}),(a,o)=>m(t)?(_(),Se(qm,{key:0,"scroll-target":m(n),class:"tree-view"},{default:F(()=>[w(Jm,{node:m(t)},null,8,["node"])]),_:1},8,["scroll-target"])):ce("",!0)}}),u$=dn(),i$=J({__name:"TreePanel",setup(e){const t=u$.canvasMode,n=b(()=>{switch(t.value){case"weight":return"Element Tree";default:return"Armature Tree"}});return(a,o)=>(_(),M("div",null,[C("h3",null,Ve(m(n)),1),m(t)==="weight"?(_(),Se(l$,{key:0})):(_(),Se(s$,{key:1}))]))}});const c$=Me(i$,[["__scopeId","data-v-bb8aed9a"]]),d$={class:"select-root"},f$=["disabled"],p$={key:0,value:""},m$=["value"],h$=J({__name:"SelectField",props:{options:{type:Array,default:()=>[]},modelValue:{type:[Number,String],default:""},placeholder:{type:String,default:"None"},noPlaceholder:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e,a=b({get(){return n.modelValue},set(o){t("update:model-value",o)}});return(o,r)=>(_(),M("span",d$,[Qn(C("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>Fe(a)?a.value=s:null),disabled:e.disabled},[e.noPlaceholder?ce("",!0):(_(),M("option",p$,"-- "+Ve(e.placeholder)+" --",1)),(_(!0),M(ye,null,Pe(e.options,s=>(_(),M("option",{key:s.value,value:s.value},Ve(s.label),9,m$))),128))],8,f$),[[Zv,m(a)]])]))}});const Pt=Me(h$,[["__scopeId","data-v-fdeefc82"]]),y$=J({__name:"SelectButton",props:{options:{default:()=>[]}},emits:["select"],setup(e,{emit:t}){const n=H();async function a(){t("select",n.value),await Ha(),n.value=void 0}return(o,r)=>(_(),Se(Pt,{modelValue:n.value,"onUpdate:modelValue":[r[0]||(r[0]=s=>n.value=s),a],options:e.options,placeholder:"Add"},null,8,["modelValue","options"]))}});const v$={},g$={class:"field-with-button"},b$={class:"field"},_$={class:"button"};function S$(e,t){return _(),M("div",g$,[C("div",b$,[at(e.$slots,"default",{},void 0,!0)]),C("div",_$,[at(e.$slots,"button",{},void 0,!0)])])}const x$=Me(v$,[["render",S$],["__scopeId","data-v-4d2495ef"]]),w$={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},k$={transform:"rotate(45 10 10)"},E$=J({__name:"EyedropperIcon",props:{highlight:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("svg",w$,[C("g",k$,[C("path",{d:"M8 2 A2 2 0 0 1 12 2 L12 5 L13 5 L13 7 L7 7 L7 5 L8 5z","stroke-linejoin":"round",stroke:"none",class:et(e.highlight?"fill-highlight":"fill-text")},null,2),C("path",{d:"M11.5 7 L11.5 17 L10 19 L8.5 17 L8.5 7","stroke-linejoin":"round",fill:"none",class:et(e.highlight?"stroke-highlight":"stroke-text")},null,2)])]))}}),an=J({__name:"SelectWithPicker",props:{modelValue:null,name:null,options:null},emits:["update:model-value","start-pick"],setup(e,{emit:t}){const n=e,a=b({get:()=>n.modelValue,set:s=>{t("update:model-value",s)}}),o=H(!1);function r(){o.value?t("start-pick"):t("start-pick",{name:n.name,callback:s=>{n.options.some(l=>l.value===s)&&t("update:model-value",s),o.value=!1},onstart:()=>{o.value=!0},oncancel:()=>{o.value=!1}})}return(s,l)=>(_(),Se(x$,null,{button:F(()=>[C("button",{type:"button",onClick:r},[w(E$,{highlight:o.value},null,8,["highlight"])])]),default:F(()=>[w(Pt,{modelValue:m(a),"onUpdate:modelValue":l[0]||(l[0]=u=>Fe(a)?a.value=u:null),options:e.options},null,8,["modelValue","options"])]),_:1}))}}),C$={xmlns:"http://www.w3.org/2000/svg",viewBox:"-8 -8 16 16"},M$=["fill"],O$=["fill"],T$=["stroke"],$$=J({__name:"KeyDot",props:{status:{default:"none"},updated:{type:Boolean,default:!1}},emits:["create","delete"],setup(e,{emit:t}){const n=e;function a(){if(n.updated){t("create");return}switch(n.status){case"none":case"others":t("create");return;case"self":t("delete");return}}const o=b(()=>n.updated?"#ffc0cb":"#aaa");return(r,s)=>(_(),M("button",{type:"button",onClick:a},[(_(),M("svg",C$,[e.status==="none"?(_(),M("circle",{key:0,r:"2.5",fill:m(o)},null,8,M$)):e.status==="others"?(_(),M("path",{key:1,d:"M0,-5 L5,0 L0,5 L-5,0z",stroke:"none",fill:m(o)},null,8,O$)):(_(),M("path",{key:2,d:"M0,-5 L5,0 L0,5 L-5,0z","stroke-linejoin":"round","stroke-width":"1.5",stroke:m(o),fill:"none"},null,8,T$))]))]))}});const Jt=Me($$,[["__scopeId","data-v-2bb9de41"]]),A$=J({__name:"IKOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value","start-pick-bone"],setup(e,{emit:t}){const n=e;function a(d,f){t("update:model-value",{...n.modelValue,...d},f)}const o="100px";function r(d){a({targetId:d})}function s(d){a({poleTargetId:d})}function l(d){a({smoothJoint:d})}function u(d,f){a({chainLength:d},f)}function i(d,f){a({iterations:d},f)}function c(d,f){a({influence:d},f)}function p(d){t("start-pick-bone",d)}return(d,f)=>(_(),M("div",null,[w(ue,{label:"Target","label-width":o},{default:F(()=>[w(an,{"model-value":e.modelValue.targetId,options:e.boneOptions,name:"targetId","onUpdate:modelValue":r,onStartPick:p},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Pole Target","label-width":o},{default:F(()=>[w(an,{"model-value":e.modelValue.poleTargetId,options:e.boneOptions,name:"poleTargetId","onUpdate:modelValue":s,onStartPick:p},null,8,["model-value","options"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{"model-value":e.modelValue.smoothJoint,label:"Smooth Joint","onUpdate:modelValue":l},null,8,["model-value"])]),_:1}),w(ue,{label:"Chain Length","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.chainLength,integer:"",min:0,"onUpdate:modelValue":u},null,8,["model-value"])]),_:1}),w(ue,{label:"Iterations","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.iterations,integer:"",min:0,max:500,"onUpdate:modelValue":i},null,8,["model-value"])]),_:1}),w(ue,{label:"Influence","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":c},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:f[0]||(f[0]=h=>e.createKeyframe("influence")),onDelete:f[1]||(f[1]=h=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}}),An=[{value:"world",label:"World"},{value:"local",label:"Local"}],I$={class:"inline"},P$={class:"inline"},B$={class:"inline"},L$={class:"inline"},R$=J({__name:"LimitLocationOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value"],setup(e,{emit:t}){const n=e;function a(y,k){t("update:model-value",{...n.modelValue,...y},k)}const o="90px";function r(y){a({spaceType:y})}function s(y,k){a({minX:y},k)}function l(y,k){a({maxX:y},k)}function u(y,k){a({minY:y},k)}function i(y,k){a({maxY:y},k)}function c(y,k){a({useMinX:y},k)}function p(y,k){a({useMaxX:y},k)}function d(y,k){a({useMinY:y},k)}function f(y,k){a({useMaxY:y},k)}function h(y,k){a({influence:y},k)}return(y,k)=>(_(),M("div",null,[w(ue,{label:"Space Type","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.spaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":r},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Min X","label-width":o},{default:F(()=>[C("div",I$,[w(ut,{"model-value":e.modelValue.useMinX,"onUpdate:modelValue":c},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.minX,"onUpdate:modelValue":s},null,8,["model-value"])])]),_:1}),w(ue,{label:"Min Y","label-width":o},{default:F(()=>[C("div",P$,[w(ut,{"model-value":e.modelValue.useMinY,"onUpdate:modelValue":d},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.minY,"onUpdate:modelValue":u},null,8,["model-value"])])]),_:1}),w(ue,{label:"Max X","label-width":o},{default:F(()=>[C("div",B$,[w(ut,{"model-value":e.modelValue.useMaxX,"onUpdate:modelValue":p},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.maxX,"onUpdate:modelValue":l},null,8,["model-value"])])]),_:1}),w(ue,{label:"Max Y","label-width":o},{default:F(()=>[C("div",L$,[w(ut,{"model-value":e.modelValue.useMaxY,"onUpdate:modelValue":f},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.maxY,"onUpdate:modelValue":i},null,8,["model-value"])])]),_:1}),w(ue,{label:"Influence","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":h},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:k[0]||(k[0]=E=>e.createKeyframe("influence")),onDelete:k[1]||(k[1]=E=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}});const j$=Me(R$,[["__scopeId","data-v-05ba7f77"]]),N$={class:"inline"},V$={class:"inline"},D$=J({__name:"LimitRotationOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value"],setup(e,{emit:t}){const n=e;function a(p,d){t("update:model-value",{...n.modelValue,...p},d)}const o="100px";function r(p){a({spaceType:p})}function s(p,d){a({min:p},d)}function l(p,d){a({max:p},d)}function u(p,d){a({useMin:p},d)}function i(p,d){a({useMax:p},d)}function c(p,d){a({influence:p},d)}return(p,d)=>(_(),M("div",null,[w(ue,{label:"Space Type","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.spaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":r},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Min","label-width":o},{default:F(()=>[C("div",N$,[w(ut,{"model-value":e.modelValue.useMin,"onUpdate:modelValue":u},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.min,"onUpdate:modelValue":s},null,8,["model-value"])])]),_:1}),w(ue,{label:"Max","label-width":o},{default:F(()=>[C("div",V$,[w(ut,{"model-value":e.modelValue.useMax,"onUpdate:modelValue":i},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.max,"onUpdate:modelValue":l},null,8,["model-value"])])]),_:1}),w(ue,{label:"Influence","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":c},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:d[0]||(d[0]=f=>e.createKeyframe("influence")),onDelete:d[1]||(d[1]=f=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}});const F$=Me(D$,[["__scopeId","data-v-915f3e2c"]]),U$={class:"inline"},G$={class:"inline"},K$={class:"inline"},z$={class:"inline"},Y$=J({__name:"LimitScaleOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value"],setup(e,{emit:t}){const n="90px";function a(h,y){t("update:model-value",h,y)}function o(h){a({spaceType:h})}function r(h,y){a({minX:h},y)}function s(h,y){a({maxX:h},y)}function l(h,y){a({minY:h},y)}function u(h,y){a({maxY:h},y)}function i(h,y){a({useMinX:h},y)}function c(h,y){a({useMaxX:h},y)}function p(h,y){a({useMinY:h},y)}function d(h,y){a({useMaxY:h},y)}function f(h,y){a({influence:h},y)}return(h,y)=>(_(),M("div",null,[w(ue,{label:"Space Type","label-width":n},{default:F(()=>[w(Pt,{"model-value":e.modelValue.spaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":o},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Min X","label-width":n},{default:F(()=>[C("div",U$,[w(ut,{"model-value":e.modelValue.useMinX,"onUpdate:modelValue":i},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.minX,step:.1,"onUpdate:modelValue":r},null,8,["model-value","step"])])]),_:1}),w(ue,{label:"Min Y","label-width":n},{default:F(()=>[C("div",G$,[w(ut,{"model-value":e.modelValue.useMinY,"onUpdate:modelValue":p},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.minY,step:.1,"onUpdate:modelValue":l},null,8,["model-value","step"])])]),_:1}),w(ue,{label:"Max X","label-width":n},{default:F(()=>[C("div",K$,[w(ut,{"model-value":e.modelValue.useMaxX,"onUpdate:modelValue":c},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.maxX,step:.1,"onUpdate:modelValue":s},null,8,["model-value","step"])])]),_:1}),w(ue,{label:"Max Y","label-width":n},{default:F(()=>[C("div",z$,[w(ut,{"model-value":e.modelValue.useMaxY,"onUpdate:modelValue":d},null,8,["model-value"]),w(Ae,{"model-value":e.modelValue.maxY,step:.1,"onUpdate:modelValue":u},null,8,["model-value","step"])])]),_:1}),w(ue,{label:"Influence","label-width":n},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":f},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:y[0]||(y[0]=k=>e.createKeyframe("influence")),onDelete:y[1]||(y[1]=k=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}});const X$=Me(Y$,[["__scopeId","data-v-316eaf35"]]),H$=J({__name:"CopyLocationOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value","start-pick-bone"],setup(e,{emit:t}){const n=e;function a(f,h){t("update:model-value",{...n.modelValue,...f},h)}const o="100px";function r(f){a({targetId:f})}function s(f){a({targetSpaceType:f})}function l(f){a({ownerSpaceType:f})}function u(f,h){a({influence:f},h)}const i=[{value:"x",label:"X"},{value:"y",label:"Y"}],c=b({get(){return[n.modelValue.copyX?"x":"",n.modelValue.copyY?"y":""].filter(f=>f)},set(f){a({copyX:f.includes("x"),copyY:f.includes("y")})}}),p=b({get(){return[n.modelValue.invertX?"x":"",n.modelValue.invertY?"y":""].filter(f=>f)},set(f){a({invertX:f.includes("x"),invertY:f.includes("y")})}});function d(f){t("start-pick-bone",f)}return(f,h)=>(_(),M("div",null,[w(ue,{label:"Target","label-width":o},{default:F(()=>[w(an,{"model-value":e.modelValue.targetId,options:e.boneOptions,name:"targetId","onUpdate:modelValue":r,onStartPick:d},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Target Space","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.targetSpaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":s},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Owner Space","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.ownerSpaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":l},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Axis","label-width":o},{default:F(()=>[w(Br,{modelValue:m(c),"onUpdate:modelValue":h[0]||(h[0]=y=>Fe(c)?c.value=y:null),options:i},null,8,["modelValue"])]),_:1}),w(ue,{label:"Invert Axis","label-width":o},{default:F(()=>[w(Br,{modelValue:m(p),"onUpdate:modelValue":h[1]||(h[1]=y=>Fe(p)?p.value=y:null),options:i},null,8,["modelValue"])]),_:1}),w(ue,{label:"Influence","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":u},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:h[2]||(h[2]=y=>e.createKeyframe("influence")),onDelete:h[3]||(h[3]=y=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}}),W$=J({__name:"CopyRotationOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value","start-pick-bone"],setup(e,{emit:t}){const n=e;function a(p,d){t("update:model-value",{...n.modelValue,...p},d)}const o="100px";function r(p){a({targetId:p})}function s(p){a({targetSpaceType:p})}function l(p){a({ownerSpaceType:p})}function u(p,d){a({influence:p},d)}function i(p){a({invert:p})}function c(p){t("start-pick-bone",p)}return(p,d)=>(_(),M("div",null,[w(ue,{label:"Target","label-width":o},{default:F(()=>[w(an,{"model-value":e.modelValue.targetId,options:e.boneOptions,name:"targetId","onUpdate:modelValue":r,onStartPick:c},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Target Space","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.targetSpaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":s},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Owner Space","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.ownerSpaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":l},null,8,["model-value","options"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{"model-value":e.modelValue.invert,label:"Invert","onUpdate:modelValue":i},null,8,["model-value"])]),_:1}),w(ue,{label:"Influence","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":u},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:d[0]||(d[0]=f=>e.createKeyframe("influence")),onDelete:d[1]||(d[1]=f=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}}),J$=J({__name:"CopyScaleOptionField",props:{modelValue:null,propsUpdatedStatus:{default:()=>({})},boneOptions:{default:()=>[]},keyframeStatusMap:{default:()=>({})},createKeyframe:{type:Function,default:()=>{}},deleteKeyframe:{type:Function,default:()=>{}}},emits:["update:model-value","start-pick-bone"],setup(e,{emit:t}){const n=e;function a(f,h){t("update:model-value",{...n.modelValue,...f},h)}const o="100px";function r(f){a({targetId:f})}function s(f){a({targetSpaceType:f})}function l(f){a({ownerSpaceType:f})}function u(f,h){a({influence:f},h)}function i(f,h){a({power:f},h)}const c=[{value:"x",label:"X"},{value:"y",label:"Y"}],p=b({get(){return[n.modelValue.copyX?"x":"",n.modelValue.copyY?"y":""].filter(f=>f)},set(f){a({copyX:f.includes("x"),copyY:f.includes("y")})}});function d(f){t("start-pick-bone",f)}return(f,h)=>(_(),M("div",null,[w(ue,{label:"Target","label-width":o},{default:F(()=>[w(an,{"model-value":e.modelValue.targetId,options:e.boneOptions,name:"targetId","onUpdate:modelValue":r,onStartPick:d},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Target Space","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.targetSpaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":s},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Owner Space","label-width":o},{default:F(()=>[w(Pt,{"model-value":e.modelValue.ownerSpaceType,options:m(An),"no-placeholder":"","onUpdate:modelValue":l},null,8,["model-value","options"])]),_:1}),w(ue,{label:"Axis","label-width":o},{default:F(()=>[w(Br,{modelValue:m(p),"onUpdate:modelValue":h[0]||(h[0]=y=>Fe(p)?p.value=y:null),options:c},null,8,["modelValue"])]),_:1}),w(ue,{label:"Power","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.power,step:.1,"onUpdate:modelValue":i},null,8,["model-value","step"])]),_:1}),w(ue,{label:"Influence","label-width":o},{default:F(()=>[w(Ae,{"model-value":e.modelValue.influence,min:0,max:1,"onUpdate:modelValue":u},null,8,["model-value"]),w(Jt,{status:e.keyframeStatusMap.influence,updated:e.propsUpdatedStatus.influence,onCreate:h[1]||(h[1]=y=>e.createKeyframe("influence")),onDelete:h[2]||(h[2]=y=>e.deleteKeyframe("influence"))},null,8,["status","updated"])]),_:1})]))}}),q$={class:"constraint-header"},Z$=["disabled","onClick"],Q$=["disabled","onClick"],eA=["onClick"],Ds={IK:"IK",LIMIT_LOCATION:"Limit Location",LIMIT_ROTATION:"Limit Rotation",LIMIT_SCALE:"Limit Scale",COPY_LOCATION:"Copy Location",COPY_ROTATION:"Copy Rotation",COPY_SCALE:"Copy Scale"},tA={IK:A$,LIMIT_LOCATION:j$,LIMIT_ROTATION:F$,LIMIT_SCALE:X$,COPY_LOCATION:H$,COPY_ROTATION:W$,COPY_SCALE:J$},nA=J({__name:"ConstraintList",props:{constraints:null,originalConstraints:{default:()=>({})},boneOptions:null,pickBone:{type:Function,default:void 0},constraintKeyframeMap:{default:()=>({})},currentFrame:{default:0}},emits:["update","update-item","add-keyframe","remove-keyframe","start-pick-bone"],setup(e,{emit:t}){const n=e,a=b(()=>ie(n.constraints)),o=b(()=>Object.keys(Ds).map(v=>({value:v,label:Ds[v]})));function r(v){const A=n.constraintKeyframeMap[v];if(A)return Q(Po(A).props,x=>x.some(I=>I.frame===n.currentFrame)?"self":"others")}function s(v){const A=n.originalConstraints[v],x=a.value[v];return!A||!x?{}:{influence:A.option.influence!==x.option.influence}}function l(v){v&&i(v)}function u(v,A){t("update",v,A)}function i(v){const A=Xf({type:v},!0);A.name=qt(Ds[A.type],n.constraints.map(x=>x.name)),u([...n.constraints,A])}function c(v,A,x){const I=n.constraints[v];t("update-item",{...I,option:A},x)}function p(v){const A=n.constraints.concat();A.splice(v,1),u(A)}function d(v,A){u(n0(n.constraints,v,A))}function f(v){u(a0(n.constraints,v))}function h(v){u(o0(n.constraints,v))}function y(v,A){const x=n.constraints[v];x&&t("add-keyframe",x.id,A)}function k(v,A){const x=n.constraints[v];x&&t("remove-keyframe",x.id,A)}function E(v){return A=>{y(v,A)}}function g(v){return A=>{k(v,A)}}return(v,A)=>(_(),M(ye,null,[w(ue,{label:"Constraints"},{default:F(()=>[w(y$,{options:m(o),onSelect:l},null,8,["options"])]),_:1}),(_(!0),M(ye,null,Pe(e.constraints,(x,I)=>(_(),M("div",{key:x.id,class:"constraints-item"},[C("div",q$,[w(Gn,{"model-value":x.name,"onUpdate:modelValue":O=>d(I,O)},null,8,["model-value","onUpdate:modelValue"]),C("button",{disabled:I===0,type:"button",onClick:O=>f(I)},[w(xr,{class:"icon"})],8,Z$),C("button",{disabled:I===e.constraints.length-1,type:"button",onClick:O=>h(I)},[w(xr,{class:"icon",flipped:""})],8,Q$),C("button",{type:"button",onClick:O=>p(I)},[w(fs,{class:"icon"})],8,eA)]),(_(),Se(Nl(tA[x.type]),{"model-value":x.option,"props-updated-status":s(x.id),"keyframe-status-map":r(x.id),"bone-options":e.boneOptions,"pick-bone":e.pickBone,"create-keyframe":E(I),"delete-keyframe":g(I),"onUpdate:modelValue":(O,T)=>c(I,O,T),onAddKeyframe:O=>y(I,O),onRemoveKeyframe:O=>k(I,O),onStartPickBone:A[0]||(A[0]=O=>v.$emit("start-pick-bone",O))},null,40,["model-value","props-updated-status","keyframe-status-map","bone-options","pick-bone","create-keyframe","delete-keyframe","onUpdate:modelValue","onAddKeyframe","onRemoveKeyframe"]))]))),128))],64))}});const aA=Me(nA,[["__scopeId","data-v-9e42e5a4"]]),Zm=e=>(it("data-v-a606d27e"),e=e(),ct(),e),oA=Zm(()=>C("h3",null,"Armature",-1)),rA=Zm(()=>C("h3",null,"Bone",-1)),sA=J({__name:"DetailPanel",setup(e){const t=jt(),n=cn(),a=dn(),o=b(()=>t.lastSelectedBone.value),r=n.keyframeMapByTargetId,s=n.currentFrame,l=b(()=>{if(!o.value)return[];const T=t.boneMap.value;return Y_(T,o.value.id).map(L=>({value:L,label:T[L].name}))}),u=b(()=>o.value?o.value.constraints.map(T=>n.currentInterpolatedConstraintMap.value[T]):[]),i=b(()=>o.value&&a.canvasMode.value!=="object"?"bone":t.lastSelectedArmature.value?"armature":"");function c(T){return r.value[T].find(L=>L.frame===s.value)}function p(T,L){o.value&&t.updateBoneConstraints(T,L)}function d(T,L){if(!o.value)return;const R=u.value.findIndex(j=>j.id===T.id),B=u.value[R];if((Po(r.value[T.id]??[]).props??{}).influence&&B.option.influence!==T.option.influence)n.applyEditedConstraint({[T.id]:{influence:T.option.influence}},L);else{const j=u.value.concat();j[R]=T,t.updateBoneConstraints(j,L)}}function f(T,L){n.execInsertKeyframeConstraint(T,{[L]:!0})}function h(T,L){const R=c(T);R&&n.execDeleteKeyframeConstraint(R.id,{[L]:!0})}function y(T){a.dispatchCanvasEvent({type:"state",data:{name:"pick-bone",options:T}})}const k=t.lastSelectedArmature,E=b({get(){var T;return((T=o.value)==null?void 0:T.connected)??!1},set(T){t.updateBone({connected:T})}}),g=b({get(){var T;return((T=o.value)==null?void 0:T.inheritRotation)??!1},set(T){t.updateBone({inheritRotation:T})}}),v=b({get(){var T;return((T=o.value)==null?void 0:T.inheritScale)??!1},set(T){t.updateBone({inheritScale:T})}}),A=b({get(){var T;return((T=o.value)==null?void 0:T.parentId)??""},set(T){t.updateBone({parentId:T})}});function x(T){t.updateArmatureName(T)}function I(T){t.updateBoneName(T)}const O=n.originalInterpolatedConstraintMap;return(T,L)=>(_(),M("div",null,[m(i)==="armature"&&m(k)?(_(),M("form",{key:0,onSubmit:L[0]||(L[0]=Ke(()=>{},["prevent"]))},[oA,w(ue,{label:"Name","label-width":"50px"},{default:F(()=>[w(Gn,{"model-value":m(k).name,"onUpdate:modelValue":x},null,8,["model-value"])]),_:1})],32)):ce("",!0),m(i)==="bone"&&m(o)?(_(),M("form",{key:1,onSubmit:L[5]||(L[5]=Ke(()=>{},["prevent"]))},[rA,w(ue,{label:"Name","label-width":"50px"},{default:F(()=>[w(Gn,{"model-value":m(o).name,"onUpdate:modelValue":I},null,8,["model-value"])]),_:1}),w(ue,{label:"Parent","label-width":"50px"},{default:F(()=>[w(an,{modelValue:m(A),"onUpdate:modelValue":L[1]||(L[1]=R=>Fe(A)?A.value=R:null),options:m(l),name:"targetId",onStartPick:y},null,8,["modelValue","options"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{modelValue:m(E),"onUpdate:modelValue":L[2]||(L[2]=R=>Fe(E)?E.value=R:null),disabled:!m(A),label:"Connect"},null,8,["modelValue","disabled"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{modelValue:m(g),"onUpdate:modelValue":L[3]||(L[3]=R=>Fe(g)?g.value=R:null),label:"Inherit Rotation"},null,8,["modelValue"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{modelValue:m(v),"onUpdate:modelValue":L[4]||(L[4]=R=>Fe(v)?v.value=R:null),label:"Inherit Scale"},null,8,["modelValue"])]),_:1}),w(aA,{constraints:m(u),"original-constraints":m(O),"bone-options":m(l),"constraint-keyframe-map":m(r),"current-frame":m(s),onUpdate:p,onUpdateItem:d,onAddKeyframe:f,onRemoveKeyframe:h,onStartPickBone:y},null,8,["constraints","original-constraints","bone-options","constraint-keyframe-map","current-frame"])],32)):ce("",!0)]))}});const lA=Me(sA,[["__scopeId","data-v-a606d27e"]]),Kc=J({__name:"SidePanel",props:{initialTab:{default:"file"}},setup(e){return(t,n)=>(_(),Se(OM,{tabs:[{key:"file",label:"File"},{key:"detail",label:"Detail"},{key:"tree",label:"Tree"},{key:"history",label:"History"}],"initial-tab":e.initialTab},{detail:F(()=>[w(lA)]),history:F(()=>[w(IM)]),file:F(()=>[w(qT)]),tree:F(()=>[w(c$)]),_:1},8,["initial-tab"]))}}),uA=["x","y","width","height"],iA=J({__name:"DotBackground",props:{x:{default:0},y:{default:0},width:{default:100},height:{default:100},size:{default:100}},setup(e){return(t,n)=>(_(),M("foreignObject",{x:e.x,y:e.y,width:e.width,height:e.height},[C("div",{xmlns:"http://www.w3.org/1999/xhtml",style:st({"background-position":`${e.size/2-e.x}px ${e.size/2-e.y}px`,"background-size":`${e.size}px ${e.size}px`})},null,4)],8,uA))}});const cA=Me(iA,[["__scopeId","data-v-e99b1201"]]),dA={class:"edge-cutter","data-type":"edge-cutter"},fA=["d","stroke-width"],pA=J({__name:"EdgeCutter",props:{from:null,to:null},setup(e){const t=e,n=b(()=>`M${t.from.x},${t.from.y} L${t.to.x},${t.to.y}`),a=b(wn());return(o,r)=>(_(),M("g",dA,[C("path",{d:m(n),stroke:"lime","stroke-width":3*m(a),fill:"none"},null,8,fA)]))}});function mA(e){return xf(e).map(n=>{const[a,o]=hA(n);switch(yA(a,o),a){case"M":case"m":case"L":case"l":return{command:a,p:{x:o[0],y:o[1]}};case"H":case"h":return{command:a,x:o[0]};case"V":case"v":return{command:a,y:o[0]};case"Q":case"q":return{command:a,c1:{x:o[0],y:o[1]},p:{x:o[2],y:o[3]}};case"T":case"t":return{command:a,p:{x:o[0],y:o[1]}};case"C":case"c":return{command:a,c1:{x:o[0],y:o[1]},c2:{x:o[2],y:o[3]},p:{x:o[4],y:o[5]}};case"S":case"s":return{command:a,c1:{x:o[0],y:o[1]},p:{x:o[2],y:o[3]}};case"A":case"a":return{command:a,rx:o[0],ry:o[1],rotate:o[2],"large-arc":!!o[3],sweep:!!o[4],p:{x:o[5],y:o[6]}};case"Z":case"z":return{command:a};default:throw new Error(`Unknown command: ${n.join(" ")}`)}})}function hA(e){const[t,...n]=e,a=n.map(o=>{const r=parseFloat(o);if(isNaN(r))throw new Error(`Invalid command: ${e.join(" ")}`);return r});return[t,a]}function yA(e,t){let n=-1;switch(e){case"M":case"m":case"L":case"l":case"T":case"t":n=2;break;case"H":case"h":case"V":case"v":n=1;break;case"Q":case"q":case"S":case"s":n=4;break;case"C":case"c":n=6;break;case"A":case"a":n=7;break;case"Z":case"z":n=0;break}if(t.length!==n)throw new Error(`Unknown command: ${[e,...t].join(" ")}`)}function vA(e,t=We){const n=mA(e);let a="";return n.map(o=>{const r=t(),s=a?{from:{id:a,key:"d"}}:{value:[]};switch(a=r,o.command){case"M":case"m":return Tt("make_path_m",{id:r,inputs:{d:s,relative:{value:o.command==="m"},p:{value:o.p}}});case"L":case"l":return Tt("make_path_l",{id:r,inputs:{d:s,relative:{value:o.command==="l"},p:{value:o.p}}});case"H":case"h":return Tt("make_path_h",{id:r,inputs:{d:s,relative:{value:o.command==="h"},x:{value:o.x}}});case"V":case"v":return Tt("make_path_v",{id:r,inputs:{d:s,relative:{value:o.command==="v"},y:{value:o.y}}});case"Q":case"q":return Tt("make_path_q",{id:r,inputs:{d:s,relative:{value:o.command==="q"},c1:{value:o.c1},p:{value:o.p}}});case"T":case"t":return Tt("make_path_t",{id:r,inputs:{d:s,relative:{value:o.command==="t"},p:{value:o.p}}});case"C":case"c":return Tt("make_path_c",{id:r,inputs:{d:s,relative:{value:o.command==="c"},c1:{value:o.c1},c2:{value:o.c2},p:{value:o.p}}});case"S":case"s":return Tt("make_path_s",{id:r,inputs:{d:s,relative:{value:o.command==="s"},c1:{value:o.c1},p:{value:o.p}}});case"A":case"a":return Tt("make_path_a",{id:r,inputs:{d:s,relative:{value:o.command==="a"},rx:{value:o.rx},ry:{value:o.ry},rotate:{value:o.rotate},"large-arc":{value:o["large-arc"]},sweep:{value:o.sweep},p:{value:o.p}}});case"Z":case"z":return Tt("make_path_z",{id:r,inputs:{d:s}})}})}function gA(e,t){let n={x:-20,y:-50};return e.map(a=>(a.type==="make_path_m"?n={x:0,y:n.y+50}:n=ee(n,{x:20,y:50}),{...a,position:ee(t,n)}))}function Qm(e,t,n){const a=bA(e,t,n);return Object.keys(a).reduce((o,r)=>{const s=e[r];return o[r]={...s,position:ee(s.position,a[r].translate)},o},{})}function bA(e,t,n){const a=Bu(Ce(n.current,n.start)),o=ee(a,_A(e[t].position)),r=ve({translate:o});return Q(e,()=>r)}function eh(e){const t=Bu(Ce(e.current,e.start));return{...e,current:ee(t,e.start)}}function Bu(e){return{x:Or(10,e.x),y:Or(10,e.y)}}function _A(e){return Ce(Bu(e),e)}function th(e){var a,o;const t=(a=e.data)==null?void 0:a.node_id,n=(o=e.data)==null?void 0:o.edge_key;if(!t||!n)throw new Error("Invalid node edge data.");return{id:t,key:n}}function SA(e){var r,s,l,u;const t=(r=e.data)==null?void 0:r.input_id,n=(s=e.data)==null?void 0:s.input_key,a=(l=e.data)==null?void 0:l.output_id,o=(u=e.data)==null?void 0:u.output_key;if(!t||!n||!a||!o)throw new Error("Invalid edge data.");return{inputId:t,inputKey:n,outputId:a,outputKey:o}}const En={add:{command:"A",title:"Add"},selectAll:{command:"a",title:"All Select"},delete:{command:"x",title:"Delete"},grab:{command:"g",title:"Grab"},duplicate:{command:"D",title:"Duplicate"},reconnect:{command:`${tn()} + Drag`,title:"Reconnect"},cutEdge:{command:`${tn()} + R-Drag`,title:"Disconnect"},clip:{command:`${tn()} + c`,title:"Clip"},paste:{command:`${tn()} + v`,title:"Paste"}};function gl(e,t,n,a,o,r){const s=t[o],l=t[n];return s&&l&&Bw(e,{node:s,key:r},{node:l,key:a})}function zc(e,t,n,a,o){return o.every(r=>gl(e,t,r.nodeId,r.key,n,a))}const Yc=cs("graph-nodes");function Xc(e){return is(()=>({"text/plain":Yc.serialize(ie(Dw(e.getGraphNodeModule,ke(e.getSelectedNodeMap())).nodes))}),async t=>{const n=t.find(o=>o.kind==="string");if(!n)return;const a=await n.getAsString();try{const o=Je(Yc.deserialize(a),c=>!!e.getGraphNodeModule(c.type));if(Object.keys(o).length===0)return;const r=e.getCursorPoint(),s=ke(o).map(c=>c.position),l=Math.min(...s.map(c=>c.x)),u=Math.min(...s.map(c=>c.y)),i={x:r.x-l,y:r.y-u};e.pasteNodes(ke(hp(e.getGraphNodeModule,o,e.getNodeMap(),e.generateUuid)).map(c=>({...c,position:ee(i,c.position)})))}catch{e.pasteNodes(gA(vA(a),e.getCursorPoint()))}})}function xA(e){let t=0;return{getLabel:()=>"MovingNode",onStart:n=>(n.startEditMovement(),n.startDragging(),t=n.getTimestamp(),Promise.resolve()),handleEvent:async(n,a)=>{switch(a.type){case"pointerdrag":n.getTimestamp()-t>100&&n.setEditMovement(eh(a.data));return;case"pointerup":{if(a.data.options.button===0){const o=n.getEditMovement();o&&It(o.start,o.current)>0&&n.updateNodes(Qm(n.getSelectedNodeMap(),e.nodeId,o))}return n.setEditMovement(),xt}case"keydown":switch(a.data.key){case"Escape":return n.setEditMovement(),xt}return}}}}function nh(){return wA}const wA={getLabel:()=>"GrabbingNodeState",shouldRequestPointerLock:!0,onStart:async e=>{e.startEditMovement()},handleEvent:async(e,t)=>{switch(t.type){case"pointermove":e.setEditMovement(eh(t.data));return;case"pointerup":{if(t.data.options.button===0){const n=e.getEditMovement(),a=e.getLastSelectedNodeId();n&&a&&e.updateNodes(Qm(e.getSelectedNodeMap(),a,n))}return e.setEditMovement(),xt}case"keydown":switch(t.data.key){case"Escape":return e.setEditMovement(),xt}return}}};function Rr(e){return{getLabel:()=>"AddingNewNodeState",onStart:async t=>{e.insertion?EA(t,e):kA(t,e)},onEnd:async t=>{t.setDraftEdge(),t.setPopupMenuList()},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 1:return{getState:Gt,type:"stack-resume"}}return;case"pointerup":if(n.data.options.button!==1)return xt;break;case"keydown":switch(n.data.key){case"Escape":return xt}return;case"popupmenu":return e.insertion?MA(t,n,e):CA(t,n,e)}}}}function kA(e,t){var c;const n=e.getDraftEdge();if(!n){ah(e,t);return}const a=n.type==="draft-input",[o,r]=a?[n.output,n.input]:[n.inputs[0],n.output],s=(c=e.getGraphNodeModule(e.getNodeMap()[o.nodeId].type))==null?void 0:c.struct,l=e.getNodeMap()[o.nodeId],i=il(e.getGraphNodeModule,e.getNodeItemList(),a?Qa(s,l,o.key):un(s,l,o.key),a).map(({label:p,children:d})=>({label:p,children:d.map(f=>({label:f.label,key:`${f.type}`,data:Lf({inputKey:f.inputKey,outputKey:f.outputKey})}))}));e.setPopupMenuList({point:r,items:i})}function ah(e,t){const n=e.getNodeItemList().map(({label:a,children:o})=>({label:a,children:o.map(({label:r,type:s})=>({label:r,key:s}))}));e.setPopupMenuList({point:t.point,items:n})}function EA(e,t){var c,p;const n=t.insertion;if(!n){ah(e,t);return}const a=e.getNodeMap(),o=a[n.inputId],r=a[n.outputId];if(!o||!r)return;const s=(c=e.getGraphNodeModule(o.type))==null?void 0:c.struct,l=(p=e.getGraphNodeModule(r.type))==null?void 0:p.struct,i=Mw(e.getGraphNodeModule,e.getNodeItemList(),Qa(l,r,n.outputKey),un(s,o,n.inputKey)).map(({label:d,children:f})=>({label:d,children:f.map(h=>({label:h.label,key:`${h.type}`,data:Lf({inputKey:h.inputKey,outputKey:h.outputKey})}))}));e.setPopupMenuList({point:t.point,items:i})}function CA(e,t,n){var f,h,y;const a=t.data.key,o=(f=e.getGraphNodeModule(a))==null?void 0:f.struct,r=e.getDraftEdge();if(!o)return xt;const s=r&&r.type==="draft-input",l=s?{x:n.point.x,y:n.point.y-10}:{x:n.point.x-o.width,y:n.point.y-10},u=(r==null?void 0:r.type)==="draft-output"?(y=(h=e.getNodeMap()[r.inputs[0].nodeId])==null?void 0:h.inputs[r.inputs[0].key])==null?void 0:y.value:void 0,i=u?Hw(a,u):{},c=e.addNode(a,{...i,position:l});if(!c||!r)return xt;const{inputKey:p,outputKey:d}=t.data;return s&&p?e.updateNodes(Jn(e.getGraphNodeModule,e.getNodeMap(),c.id,p,r.output.nodeId,r.output.key)):!s&&d&&e.updateNodes(kp(e.getGraphNodeModule,e.getNodeMap(),c.id,d,r.inputs)),xt}function MA(e,t,n){var d;const a=t.data.key,o=(d=e.getGraphNodeModule(a))==null?void 0:d.struct;if(!o)return xt;const r={x:n.point.x-o.width/2,y:n.point.y-10},s=e.addNode(a,{position:r});if(!s||!n.insertion)return xt;const{inputKey:l,outputKey:u}=t.data,i=e.getNodeMap(),c=Jn(e.getGraphNodeModule,i,s.id,l,n.insertion.outputId,n.insertion.outputKey),p=Jn(e.getGraphNodeModule,{...i,...c},n.insertion.inputId,n.insertion.inputKey,s.id,u);return e.updateNodes({...c,...p}),xt}function OA(){return TA}const TA={getLabel:()=>"RectangleSelectingState",onStart:async e=>{e.startDragging(),e.setRectangleDragging(!0)},onEnd:async e=>{e.setRectangleDragging()},handleEvent:async(e,t)=>{switch(t.type){case"pointerup":{const n=e.getDraggedRectangle();if(n){const a=I0(n);e.selectNodes(Q(Je(e.getNodeMap(),o=>a(pu(e.getGraphNodeModule,o))),()=>!0),t.data.options)}return xt}case"keydown":switch(t.data.key){case"Escape":return xt}return}}};function oh(e){return{getLabel:()=>"ConnectingInputEdgeState",onStart:async t=>{t.startDragging(),t.setDraftEdge({type:"draft-output",inputs:e.inputs,output:e.point})},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 1:return{getState:Gt,type:"stack-restart"}}return;case"pointerdrag":{const a=Hc(t,n.data.current);a&&zc(t.getGraphNodeModule,t.getNodeMap(),a.id,a.key,e.inputs)?t.setDraftEdge({type:"draft-output",inputs:e.inputs,output:a?a.p:n.data.current,connected:!0}):t.setDraftEdge({type:"draft-output",inputs:e.inputs,output:n.data.current});return}case"pointerup":if(n.data.options.button===0){const a=t.getNodeMap(),o=Hc(t,n.data.point);if(o&&zc(t.getGraphNodeModule,t.getNodeMap(),o.id,o.key,e.inputs))t.updateNodes(kp(t.getGraphNodeModule,a,o.id,o.key,e.inputs));else if(!o){const r=t.getDraftEdge();if((r==null?void 0:r.type)==="draft-output"){const s=t.getNodeMap();return s[r.inputs[0].nodeId].inputs[r.inputs[0].key].from&&t.updateNodes(xp(t.getGraphNodeModule,s,r.inputs.reduce((u,i)=>(u[i.nodeId]={[i.key]:!0},u),{}))),()=>Rr({point:r.output})}}}return t.setDraftEdge(),xt;case"keydown":switch(n.data.key){case"escape":return t.setDraftEdge(),xt}return}}}}function Hc(e,t){const n=e.getNodeMap(),a=e.getEdgePositionMap(),o=12*Math.max(1,e.getScale()),r=Object.entries(a).flatMap(([l,u])=>Object.entries(u.outputs).map(([i,c])=>{const p=ee(c.p,n[l].position);return[l,i,p,It(p,t)]}).filter(([,,,i])=>i<=o));if(r.length===0)return;r.sort((l,u)=>l[3]-u[3]);const s=r[0];return{id:s[0],key:s[1],p:s[2]}}function rh(e){return{getLabel:()=>"ConnectingOutputEdgeState",onStart:async t=>{t.startDragging(),t.setDraftEdge({type:"draft-input",output:{nodeId:e.nodeId,key:e.outputKey},input:e.point})},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 1:return{getState:Gt,type:"stack-restart"}}return;case"pointerdrag":{const a=Wc(t,n.data.current);a&&gl(t.getGraphNodeModule,t.getNodeMap(),a.id,a.key,e.nodeId,e.outputKey)?t.setDraftEdge({type:"draft-input",output:{nodeId:e.nodeId,key:e.outputKey},input:a?a.p:n.data.current,connected:!0}):t.setDraftEdge({type:"draft-input",output:{nodeId:e.nodeId,key:e.outputKey},input:n.data.current});return}case"pointerup":if(n.data.options.button===0){const a=t.getNodeMap(),o=Wc(t,n.data.point);if(o&&gl(t.getGraphNodeModule,t.getNodeMap(),o.id,o.key,e.nodeId,e.outputKey))t.updateNodes(Jn(t.getGraphNodeModule,a,o.id,o.key,e.nodeId,e.outputKey));else if(!o){const r=t.getDraftEdge();if((r==null?void 0:r.type)==="draft-input")return()=>Rr({point:r.input})}}return t.setDraftEdge(),xt;case"keydown":switch(n.data.key){case"escape":return t.setDraftEdge(),xt}return}}}}function Wc(e,t){const n=e.getNodeMap(),a=e.getEdgePositionMap(),o=12*Math.max(1,e.getScale()),r=Object.entries(a).flatMap(([l,u])=>Object.entries(u.inputs).map(([i,c])=>{const p=ee(c.p,n[l].position);return[l,i,p,It(p,t)]}).filter(([,,,i])=>i<=o));if(r.length===0)return;r.sort((l,u)=>l[3]-u[3]);const s=r[0];return{id:s[0],key:s[1],p:s[2]}}function $A(e){const t=Q(e,a=>yb(a));function n(a){return Object.entries(t).reduce((o,[r,s])=>(s.some((u,i)=>{if(i<s.length-1)return Yg(a,[u,s[i+1]])})&&(o[r]=!0),o),{})}return{getHitPathMap:n}}function AA(e){let t;return{getLabel:()=>"EdgeCutting",onStart:async n=>{t=Q(n.getEdgeSummaryMap(),a=>$A(Q(a,o=>Fp(o.from,o.to)))),n.setEdgeCutter({from:e.point,to:e.point}),n.startDragging()},onEnd:async n=>{n.setEdgeCutter(void 0)},handleEvent:async(n,a)=>{switch(a.type){case"pointerdrag":{const o=n.getEdgeCutter();if(o){n.setEdgeCutter({...o,to:a.data.current});return}else return{type:"break"}}case"pointerup":{const o=n.getEdgeCutter();if(o&&t){const r=[o.from,o.to],s=Q(t,u=>u.getHitPathMap(r)),l=xp(n.getGraphNodeModule,n.getNodeMap(),s);Object.keys(l).length>0&&n.updateNodes(l)}return{type:"break"}}}}}}function xt(){return IA}const IA={getLabel:()=>"Default",onStart:async e=>{Jc(e),qc(e)},handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 0:switch(t.target.type){case"node-body":return BA(e,t);case"node-edge-input":return LA(e,t);case"node-edge-output":return RA(e,t);case"edge":return;case"node-custom-anchor":return jA(e,t);default:return PA(e,t)}case 1:return Gt;case 2:if(t.data.options.ctrl)return()=>AA({point:t.data.point})}return;case"pointerup":switch(t.data.options.button){case 0:switch(t.target.type){case"edge":return()=>Rr({point:t.data.point,insertion:SA(t.target)})}return}return;case"keydown":switch(t.data.key){case"A":{const n=t.point;return n?()=>Rr({point:n}):void 0}case"a":e.selectAllNode();return;case"g":return e.getLastSelectedNodeId()?nh:void 0;case"D":return NA(e);case"x":e.deleteNodes();return;case"!":case"Home":{const n=Object.values(e.getNodeMap());e.setViewport(n.length?os(n.map(a=>pu(e.getGraphNodeModule,a))):void 0);return}}return;case"popupmenu":{switch(t.data.key){case"create_custom_graph":{e.makeCustomGraphFromSelectedNodes();return}}return}case"copy":{Xc(e).onCopy(t.nativeEvent);return}case"paste":{await Xc(e).onPaste(t.nativeEvent);return}case"selection":Jc(e),qc(e);return}}};function Jc(e){const t=e.getLastSelectedNodeId();e.setCommandExams([En.add,En.selectAll,En.reconnect,En.cutEdge,...t?[En.delete,En.grab,En.duplicate,En.clip]:[],En.paste])}function qc(e){const t=e.getLastSelectedNodeId();e.setToolMenuList([...t?[{label:"Node",items:[{label:"Create custom graph",key:"create_custom_graph"}]}]:[]])}function PA(e,t){return e.selectNodes({},t.data.options),OA}function BA(e,t){var a;const n=(a=t.target.data)==null?void 0:a.node_id;if(n)if(t.data.options.shift)e.selectNodes({[n]:!0},t.data.options);else return e.getSelectedNodeMap()[n]||e.selectNodes({[n]:!0},t.data.options),()=>xA({nodeId:n})}function LA(e,t){var a;const n=th(t.target);if(t.data.options.ctrl){const r=(a=e.getNodeMap()[n.id].inputs[n.key])==null?void 0:a.from;if(r)return e.updateNodes(du(e.getGraphNodeModule,e.getNodeMap(),n.id,n.key)),()=>rh({nodeId:r.id,outputKey:r.key,point:t.data.point})}return()=>oh({point:t.data.point,inputs:[{nodeId:n.id,key:n.key}]})}function RA(e,t){const n=th(t.target);if(t.data.options.ctrl){const a=wp(e.getNodeMap(),n.id,n.key);return()=>oh({point:t.data.point,inputs:Object.entries(a).flatMap(([o,r])=>Object.keys(r).map(s=>({nodeId:o,key:s}))).flat()})}else return()=>rh({nodeId:n.id,outputKey:n.key,point:t.data.point})}function jA(e,t){var a;const n=(a=t.target.data)==null?void 0:a.node_type;n&&e.switchGraph(n)}function NA(e){return e.pasteNodes(ke(hp(e.getGraphNodeModule,e.getSelectedNodeMap(),e.getNodeMap(),e.generateUuid)).map(t=>({...t,position:ee(t.position,{x:20,y:20})}))),nh}function VA(e){const t=e.graphStore,n={generateUuid:We,requestPointerLock:e.requestPointerLock,exitPointerLock:e.exitPointerLock,getTimestamp:()=>Date.now(),getGraphNodeModule:o=>t.getGraphNodeModuleFn.value()(o),getNodeMap:()=>t.nodeMap.value,getEdgePositionMap:()=>t.edgePositionMap.value,updateNodes:t.updateNodes,getSelectedNodeMap:()=>Q(t.selectedNodes.value,(o,r)=>t.nodeMap.value[r]),getLastSelectedNodeId:()=>{var o;return(o=t.lastSelectedNode.value)==null?void 0:o.id},selectNodes:t.selectNodes,selectAllNode:t.selectAllNode,deleteNodes:t.deleteNodes,addNode:t.addNode,pasteNodes:t.pasteNodes,getEditMovement:()=>t.editMovement.value,setEditMovement:t.setEditMovement,switchGraph:t.switchGraph,getDraftEdge:()=>t.draftEdge.value,setDraftEdge:t.setDraftEdge,makeCustomGraphFromSelectedNodes:t.makeCustomGraphFromSelectedNodes,getScale:e.getScale,startEditMovement:e.startEditMovement,startDragging:e.startDragging,getCursorPoint:e.getCursorPoint,setPopupMenuList:e.setPopupMenuList,getNodeItemList:e.getNodeItemList,setToolMenuList:e.setToolMenuList,setViewport:e.setViewport,panView:e.panView,setRectangleDragging:e.setRectangleDragging,getDraggedRectangle:e.getDraggedRectangle,setCommandExams:e.setCommandExams,setEdgeCutter:e.setEdgeCutter,getEdgeCutter:e.getEdgeCutter,getEdgeSummaryMap:()=>t.edgeSummaryMap.value};return{sm:Ra(n,xt)}}const DA=e=>(it("data-v-f4cf9991"),e=e(),ct(),e),FA=["viewBox","width","height","onMousedown","onMouseup"],UA=DA(()=>C("g",{"stroke-width":"2","stroke-dasharray":"3",stroke:"#000"},[C("line",{x1:"-20",x2:"20"}),C("line",{y1:"-20",y2:"20"})],-1)),GA=J({__name:"AnimationGraphCanvas",props:{canvas:null},setup(e){const t=e,{wrapper:n,svg:a,addRootPosition:o,removeRootPosition:r}=ku(()=>t.canvas);yu(()=>t.canvas.scale.value),Ut(()=>{t.canvas.adjustToCenter()});const s=H(),l=b(()=>s.value?o(t.canvas.canvasToView(s.value.point)):void 0),u=ta(v,1e3/60,!0),i=ts({onMove:u,onGlobalMove:$e=>{if(!a.value)return;const oe=r($e.p);oe&&t.canvas.setMousePoint(oe)},onEscape:L}),c=Tu(()=>{var $e;return(($e=s.value)==null?void 0:$e.items.map(({label:oe,children:_e})=>({label:oe,children:_e==null?void 0:_e.map(({label:De,key:dt,data:Mt})=>({label:De,exec:dt?()=>I(dt,Mt):void 0}))})))??[]}),p=H([]),d=b(()=>p.value.map(({label:$e,items:oe})=>({label:$e,items:oe.map(({label:_e,key:De})=>({label:_e,exec:De?()=>I(De):void 0}))}))??[]),f=H(),h=H(),y=Ko(),k=VA({graphStore:y,requestPointerLock:()=>{a.value&&(t.canvas.startMoving(),i.requestPointerLockFromElement(a.value))},exitPointerLock:()=>{i.exitPointerLock(),t.canvas.endMoving()},getScale:()=>t.canvas.scale.value,startEditMovement:()=>{y.setEditMovement({start:t.canvas.viewToCanvas(t.canvas.mousePoint.value),current:t.canvas.viewToCanvas(t.canvas.mousePoint.value),ctrl:!1,scale:t.canvas.scale.value})},startDragging:()=>t.canvas.startDragging(),getCursorPoint:()=>t.canvas.viewToCanvas(t.canvas.mousePoint.value),setViewport:$e=>t.canvas.setViewport($e),panView:$e=>t.canvas.viewMove($e),setRectangleDragging:$e=>t.canvas.setRectangleDragging($e),getDraggedRectangle:()=>t.canvas.draggedRectangle.value,setPopupMenuList:$e=>{s.value=$e,c.clearOpened()},setToolMenuList:($e=[])=>p.value=$e,getNodeItemList:()=>y.nodeItemList.value,setCommandExams:$e=>f.value=$e,getEdgeCutter:()=>h.value,setEdgeCutter:$e=>h.value=$e});pt(y.selectedNodes,()=>{k.sm.handleEvent({type:"selection"})}),pt(y.selectedGraphByType,()=>{L()});function E($e){k.sm.handleEvent({type:"pointerdown",target:za($e),data:{point:t.canvas.viewToCanvas(t.canvas.mousePoint.value),options:gn($e)}})}function g($e){t.canvas.endMoving(),k.sm.handleEvent({type:"pointerup",target:za($e),data:{point:t.canvas.viewToCanvas(t.canvas.mousePoint.value),options:gn($e)}})}function v($e){t.canvas.editStartPoint.value&&k.sm.handleEvent({type:"pointermove",data:{start:t.canvas.viewToCanvas(t.canvas.editStartPoint.value),current:t.canvas.viewToCanvas(t.canvas.mousePoint.value),ctrl:$e.ctrl,scale:t.canvas.scale.value}})}function A($e){t.canvas.dragged.value&&t.canvas.editStartPoint.value&&k.sm.handleEvent({type:"pointerdrag",data:{start:t.canvas.viewToCanvas(t.canvas.editStartPoint.value),current:t.canvas.viewToCanvas(t.canvas.mousePoint.value),ctrl:Kn($e),scale:t.canvas.scale.value}})}function x($e){k.sm.handleEvent({type:"keydown",data:Oo($e),point:t.canvas.viewToCanvas(t.canvas.mousePoint.value)})}function I($e,oe={}){k.sm.handleEvent({type:"popupmenu",data:{key:$e,...oe}})}function O($e){k.sm.handleEvent({type:"copy",nativeEvent:$e})}function T($e){k.sm.handleEvent({type:"paste",nativeEvent:$e})}function L(){k.sm.handleEvent({type:"keydown",data:{key:"Escape"},point:t.canvas.viewToCanvas(t.canvas.mousePoint.value)})}const R=b(()=>t.canvas.scale.value),B=b(()=>t.canvas.viewOrigin.value),N=b(()=>t.canvas.viewSize.value),j=b(()=>t.canvas.viewBox.value),K=b(()=>t.canvas.viewCanvasRect.value),D=b(()=>c.list.value),fe=b(()=>f.value??[]),Le=b(()=>t.canvas.draggedRectangle.value),Ge=O,vt=T;return($e,oe)=>(_(),M("div",{ref_key:"wrapper",ref:n,class:"graph-canvas-root"},[w(gu,{onKeydown:x,onCopy:m(Ge),onPaste:m(vt)},{default:F(()=>[(_(),M("svg",{ref_key:"svg",ref:a,xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none","font-family":"sans-serif",viewBox:m(j),width:m(N).width,height:m(N).height,onWheel:oe[0]||(oe[0]=Ke((..._e)=>e.canvas.wheel&&e.canvas.wheel(..._e),["prevent"])),onMousedown:Ke(E,["prevent"]),onMouseup:Ke(g,["prevent"]),onMousemove:A,onContextmenu:oe[1]||(oe[1]=Ke(()=>{},["prevent"]))},[w(cA,{x:m(K).x,y:m(K).y,width:m(K).width,height:m(K).height,size:40,class:"view-only"},null,8,["x","y","width","height"]),UA,at($e.$slots,"default",{scale:m(R),viewOrigin:m(B),viewSize:m(N)},void 0,!0),m(Le)?(_(),Se(vu,{key:0,x:m(Le).x,y:m(Le).y,width:m(Le).width,height:m(Le).height,class:"view-only"},null,8,["x","y","width","height"])):ce("",!0),h.value?(_(),Se(pA,{key:1,from:h.value.from,to:h.value.to},null,8,["from","to"])):ce("",!0)],40,FA))]),_:3},8,["onCopy","onPaste"]),w(zl,{class:"command-exam-panel","available-command-list":m(fe)},null,8,["available-command-list"]),w(hf,{class:"tool-menus",groups:m(d)},null,8,["groups"]),m(D).length>0&&m(l)?(_(),Se(Yl,{key:0,class:"popup-menu-list","enabled-search":"","popup-menu-list":m(D),style:st({left:`${m(l).x-80}px`,top:`${m(l).y-10}px`})},null,8,["popup-menu-list","style"])):ce("",!0)],512))}});const KA=Me(GA,[["__scopeId","data-v-f4cf9991"]]),zA={},YA={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10"},XA=C("rect",{width:"10",height:"10",stroke:"none",class:"fill-background-second"},null,-1),HA=C("path",{d:"M2.5 5L7.5 5M5 2.5L5 7.5","stroke-linejoin":"round",fill:"none",class:"stroke-background"},null,-1),WA=[XA,HA];function JA(e,t){return _(),M("svg",YA,WA)}const sh=Me(zA,[["render",JA]]),qA=["data-input_id","data-input_key","data-output_id","data-output_key","stroke-opacity"],ZA=["d","stroke-width"],QA=["d","stroke","stroke-width"],eI=["d","stroke","stroke-width"],tI=J({__name:"GraphEdge",props:{from:null,to:null,status:{default:void 0},inputId:{default:void 0},inputKey:{default:void 0},outputId:{default:void 0},outputKey:{default:void 0}},setup(e){const t=e,n=b(()=>Fp(t.from,t.to)),{settings:a}=Ct(),o=b(wn()),r=b(()=>t.status?a.selectedColor:"#888");return(s,l)=>(_(),M("g",{class:"edge","data-type":"edge","data-input_id":e.inputId,"data-input_key":e.inputKey,"data-output_id":e.outputId,"data-output_key":e.outputKey,"stroke-opacity":e.status==="connecting"?.5:1},[C("path",{d:m(n),stroke:"#222","stroke-width":5*m(o),fill:"none"},null,8,ZA),C("path",{d:m(n),stroke:m(r),"stroke-width":4*m(o),fill:"none"},null,8,QA),e.status?ce("",!0):(_(),M("path",{key:0,class:"highlight",d:m(n),stroke:m(r),"stroke-width":9*m(o),fill:"none"},null,8,eI))],8,qA))}});const Zc=Me(tI,[["__scopeId","data-v-9491f894"]]),nI={class:"side-bar"},aI={class:"tab-list"},oI=["onClick"],rI={key:0,class:"tab-content"},sI=J({__name:"SideBar",props:{tabs:{default:()=>[]},defaultTab:{default:""}},setup(e){const n=H(e.defaultTab);function a(o){n.value=n.value===o?"":o}return(o,r)=>(_(),M("div",nI,[C("ul",aI,[(_(!0),M(ye,null,Pe(e.tabs,s=>(_(),M("li",{key:s.key,class:et({current:n.value===s.key})},[C("a",{href:"#",onClick:Ke(l=>a(s.key),["prevent"])},Ve(s.label),9,oI)],2))),128))]),n.value!==""?(_(),M("div",rI,[at(o.$slots,n.value,{},void 0,!0)])):ce("",!0)]))}});const lh=Me(sI,[["__scopeId","data-v-f300b055"]]),lI={key:0,class:"label"},uI={class:"block-content"},iI=J({__name:"BlockField",props:{label:{default:""}},setup(e){return(t,n)=>(_(),Se(bm,null,{default:F(()=>[e.label?(_(),M("label",lI,Ve(e.label),1)):ce("",!0),C("div",uI,[at(t.$slots,"default",{},void 0,!0)])]),_:3}))}});const vn=Me(iI,[["__scopeId","data-v-70f08417"]]),cI=["d","stroke","fill"],dI=J({__name:"HueCicle",props:{radius:{default:50}},setup(e){const t=e,n=120,a=[...Array(n)].map((u,i)=>r(Math.PI*2/n*i)),o=a.map((u,i)=>l(i));function r(u){return{x:Math.cos(u)*t.radius,y:Math.sin(u)*t.radius}}function s(u){const i=a[u],c=a[(u+1)%n];return`M0,0L${i.x},${i.y}A${t.radius},${t.radius},0,0,1,${c.x},${c.y}z`}function l(u){return Fo(Za({h:u*360/n,s:1,v:1,a:1}))}return(u,i)=>(_(),M("g",null,[(_(!0),M(ye,null,Pe(m(a),(c,p)=>(_(),M("path",{key:p,d:s(p),stroke:m(o)[p],fill:m(o)[p]},null,8,cI))),128))]))}});var fI=Object.defineProperty,Qc=Object.getOwnPropertySymbols,pI=Object.prototype.hasOwnProperty,mI=Object.prototype.propertyIsEnumerable,ed=(e,t,n)=>t in e?fI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lo=(e,t)=>{for(var n in t||(t={}))pI.call(t,n)&&ed(e,n,t[n]);if(Qc)for(var n of Qc(t))mI.call(t,n)&&ed(e,n,t[n]);return e};function hI(e){return"touches"in e}function jr(e){return hI(e)?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.pageX,y:e.pageY}}function ys(e,t=()=>{}){let n=!1,a=null,o=null,r=null,s=0;return{onDown:l=>{n=!0,a=jr(l),r=lo({},a),o=lo({},a),s=Date.now()},onMove:l=>{n&&(l.preventDefault(),r=jr(l),!(!n||!a||!r||!o)&&(e({base:a,p:lo({},r),d:{x:r.x-o.x,y:r.y-o.y}}),o=lo({},r)))},onUp:()=>{r&&Date.now()-s<100&&t(lo({},r)),n=!1,a=null,r=null,o=null,s=0}}}const yI=C("circle",{r:"40",class:"fill-background"},null,-1),vI=["x2","y2"],gI=C("circle",{r:"39",class:"fill-background"},null,-1),bI=J({__name:"HueCiclePicker",props:{modelValue:null},emits:["update:model-value"],setup(e,{emit:t}){const n=e;function a(y){return{x:Math.cos(y)*50,y:Math.sin(y)*50}}const o=b(()=>n.modelValue===void 0?0:n.modelValue*Math.PI/180),r=b(()=>{if(n.modelValue!==void 0)return a(o.value)}),s=H(!1),l=H(),u=H();function i(y){t("update:model-value",y,l.value)}function c(y){if(!u.value)return;const k=u.value.getBoundingClientRect(),E=Ce(y,{x:k.left+k.width/2,y:k.top+k.height/2}),g=o.value+Vf(o.value,ht(E));return Math.round(g*180/Math.PI)}function p(y){const k=c(y.p);k!==void 0&&i(k)}const d=ta(p,1e3/60,!0),f=ys(d);Vo(f.onMove),Do(()=>{f.onUp(),s.value=!1,l.value=void 0});function h(y){s.value=!1,l.value=`color_${Date.now()}`;const k=c(jr(y));k!==void 0&&(i(k),f.onDown(y))}return(y,k)=>(_(),M("svg",{ref_key:"svg",ref:u,xmlns:"http://www.w3.org/2000/svg",viewBox:"-50 -50 100 100",onMousedown:h},[w(dI,{radius:49}),yI,m(r)?(_(),M("line",{key:0,x2:m(r).x,y2:m(r).y,stroke:"#ddd","stroke-width":"4"},null,8,vI)):ce("",!0),gI],544))}}),_I=e=>(it("data-v-273404f7"),e=e(),ct(),e),SI={class:"color-picker-wrapper"},xI={class:"color-picker-inner"},wI=_I(()=>C("div",null,null,-1)),kI=[wI],EI={class:"input-block"},sr=110,CI=J({__name:"ColorPicker",props:{modelValue:{default:()=>({h:0,s:0,v:0,a:1})},extraHue:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e,a=H(),o=H(!1),r=H(),s=b(()=>n.modelValue),l=b(()=>({x:s.value.s,y:1-s.value.v})),u=b(()=>Fo(Za({h:s.value.h,s:1,v:1,a:1})));function i(E,g){t("update:model-value",E,g)}function c(E,g){i({...s.value,h:E},g)}function p(E,g){i({...s.value,a:E},g)}function d(E){if(!a.value)return;const g=a.value.getBoundingClientRect(),v=Ce(E,{x:g.left,y:g.top}),A={x:v.x/sr,y:v.y/sr},x={s:lt(0,1,A.x),v:1-lt(0,1,A.y)};i({...s.value,s:x.s,v:x.v},r.value)}function f(E){d(E.p)}const h=ta(f,1e3/60,!0),y=ys(h);Vo(y.onMove),Do(()=>{y.onUp(),o.value=!1,r.value=void 0});function k(E){o.value=!1,r.value=`color_${Date.now()}`,d(jr(E)),y.onDown(E)}return(E,g)=>(_(),M("div",SI,[C("div",xI,[w(bI,{"model-value":m(s).h,class:"hue-circle","onUpdate:modelValue":c},null,8,["model-value"]),C("div",{ref_key:"colorRect",ref:a,class:"color-rect",style:st({"background-color":m(u)}),onMousedown:k},[C("div",{class:"cursor",style:st({transform:`translate(${m(l).x*sr}px,${m(l).y*sr}px)`})},kI,4)],36),C("div",EI,[C("div",null,[w(ue,{label:"A","label-width":"10px"},{default:F(()=>[w(Ae,{"model-value":m(s).a,min:0,max:1,"onUpdate:modelValue":p},null,8,["model-value"])]),_:1})])])])]))}});const uh=Me(CI,[["__scopeId","data-v-273404f7"]]),MI=J({__name:"ColorRect",props:{hsva:null,transform:null},setup(e){const t=e,n=b(()=>t.hsva?Fo(Za(t.hsva)):t.transform?lk(t.transform):"#000");return(a,o)=>(_(),M("div",{class:"color-rect",style:st({"background-color":m(n)})},null,4))}});const Lu=Me(MI,[["__scopeId","data-v-41dc92ca"]]),OI=J({__name:"FixedContainer",setup(e){const t=H(),n=H(0),a=H(0);rn(o),Bb(o,!0);function o(){var s;if(!((s=t.value)!=null&&s.parentElement))return;const r=t.value.parentElement.getBoundingClientRect();n.value=r.left,a.value=r.top}return(r,s)=>(_(),M("div",{ref_key:"root",ref:t,class:"fixed-container",style:st({transform:`translate(${n.value}px, ${a.value}px)`})},[at(r.$slots,"default",{},void 0,!0)],4))}});const ih=Me(OI,[["__scopeId","data-v-2298d696"]]),ch=J({__name:"OutsideEventContainer",emits:["click-outside"],setup(e,{emit:t}){const n=H();return Lb(a=>{!n.value||!a.target||n.value.contains(a.target)||t("click-outside")}),(a,o)=>(_(),M("div",{ref_key:"root",ref:n},[at(a.$slots,"default")],512))}}),TI=J({__name:"GraphNodeDataFieldTransform",props:{modelValue:null,disabled:{type:Boolean,default:!1}},emits:["update:model-value"],setup(e,{emit:t}){const n=e;function a(c,p){t("update:model-value",{...n.modelValue,translate:{x:c,y:n.modelValue.translate.y}},p)}function o(c,p){t("update:model-value",{...n.modelValue,translate:{x:n.modelValue.translate.x,y:c}},p)}function r(c,p){t("update:model-value",{...n.modelValue,scale:{x:c,y:n.modelValue.scale.y}},p)}function s(c,p){t("update:model-value",{...n.modelValue,scale:{x:n.modelValue.scale.x,y:c}},p)}function l(c,p){t("update:model-value",{...n.modelValue,rotate:c},p)}function u(c,p){t("update:model-value",{...n.modelValue,origin:{x:c,y:n.modelValue.origin.y}},p)}function i(c,p){t("update:model-value",{...n.modelValue,origin:{x:n.modelValue.origin.x,y:c}},p)}return(c,p)=>(_(),M("div",null,[w(ue,{label:"tr","label-width":"10px"},{default:F(()=>[$t(" ( "),w(Ae,{"model-value":e.modelValue.translate.x,step:1,disabled:e.disabled,"onUpdate:modelValue":a},null,8,["model-value","disabled"]),$t(" , "),w(Ae,{"model-value":e.modelValue.translate.y,step:1,disabled:e.disabled,"onUpdate:modelValue":o},null,8,["model-value","disabled"]),$t(" ) ")]),_:1}),w(ue,{label:"ro","label-width":"10px"},{default:F(()=>[w(Ae,{"model-value":e.modelValue.rotate,step:1,disabled:e.disabled,"onUpdate:modelValue":l},null,8,["model-value","disabled"])]),_:1}),w(ue,{label:"sc","label-width":"10px"},{default:F(()=>[$t(" ( "),w(Ae,{"model-value":e.modelValue.scale.x,step:.1,disabled:e.disabled,"onUpdate:modelValue":r},null,8,["model-value","step","disabled"]),$t(" , "),w(Ae,{"model-value":e.modelValue.scale.y,step:.1,disabled:e.disabled,"onUpdate:modelValue":s},null,8,["model-value","step","disabled"]),$t(" ) ")]),_:1}),w(ue,{label:"or","label-width":"10px"},{default:F(()=>[$t(" ( "),w(Ae,{"model-value":e.modelValue.origin.x,step:1,disabled:e.disabled,"onUpdate:modelValue":u},null,8,["model-value","disabled"]),$t(" , "),w(Ae,{"model-value":e.modelValue.origin.y,step:1,disabled:e.disabled,"onUpdate:modelValue":i},null,8,["model-value","disabled"]),$t(" ) ")]),_:1})]))}}),dh=Symbol(),fh=Symbol(),ph=Symbol();function $I(e){Wa(dh,e)}function mh(){return ba(dh,()=>Ar)}function AI(e){Wa(fh,e)}function II(){return ba(fh,()=>[])}function PI(e){Wa(ph,e)}function hh(){return ba(ph,()=>[])}const BI={key:0},LI={key:7,class:"color-block"},RI=["disabled"],jI={key:0,class:"color-popup"},NI={[W.BOOLEAN]:!0,[W.SCALER]:!0,[W.VECTOR2]:!0,[W.BONE]:!0,[W.OBJECT]:!0,[W.COLOR]:!0,[W.TEXT]:!0,[W.TRANSFORM]:!0},VI=J({__name:"GraphNodeDataField",props:{modelValue:null,label:null,type:null,disabled:{type:Boolean,default:!1}},emits:["update:model-value","start-pick-bone"],setup(e,{emit:t}){const n=e;function a(y,k){t("update:model-value",y,k)}const o=b(II()),r=b(hh()),s=H(!1);function l(){s.value=!s.value}function u(y,k){a(Ql(y),k)}const i=b(()=>n.type.type),c=b(()=>n.type.scale??1),p=b(()=>n.type.enumKey),d=b(()=>(Ef[p.value]??[]).map(y=>({label:`${y.value}: ${y.key}`,value:y.value}))),f=b(()=>i.value==="COLOR"?eo(n.modelValue):void 0);function h(y){t("start-pick-bone",y)}return(y,k)=>NI[m(i)]?(_(),M("div",BI,[C("h5",null,Ve(e.label),1),m(i)==="SCALER"?(_(),M(ye,{key:0},[m(p)?(_(),Se(Pt,{key:0,"model-value":e.modelValue,options:m(d),disabled:e.disabled,"no-placeholder":"","onUpdate:modelValue":a},null,8,["model-value","options","disabled"])):(_(),Se(Ae,{key:1,step:m(c),"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":a},null,8,["step","model-value","disabled"]))],64)):m(i)==="BONE"?(_(),M(ye,{key:1},[e.disabled?(_(),Se(Gn,{key:0,"model-value":e.modelValue,disabled:""},null,8,["model-value"])):(_(),Se(an,{key:1,"model-value":e.modelValue,options:m(r),name:"targetId","onUpdate:modelValue":a,onStartPick:h},null,8,["model-value","options"]))],64)):m(i)==="OBJECT"?(_(),M(ye,{key:2},[e.disabled?(_(),Se(Gn,{key:0,"model-value":e.modelValue,disabled:""},null,8,["model-value"])):(_(),Se(Pt,{key:1,"model-value":e.modelValue,options:m(o),"onUpdate:modelValue":a},null,8,["model-value","options"]))],64)):m(i)==="TEXT"?(_(),Se(Gn,{key:3,"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":a},null,8,["model-value","disabled"])):m(i)==="BOOLEAN"?(_(),Se(ut,{key:4,"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":a},null,8,["model-value","disabled"])):m(i)==="VECTOR2"?(_(),M(ye,{key:5},[w(ue,{label:"x","label-width":"20px"},{default:F(()=>[w(Ae,{"model-value":e.modelValue.x,step:m(c),disabled:e.disabled,"onUpdate:modelValue":k[0]||(k[0]=(E,g)=>a({x:E,y:e.modelValue.y},g))},null,8,["model-value","step","disabled"])]),_:1}),w(ue,{label:"y","label-width":"20px"},{default:F(()=>[w(Ae,{"model-value":e.modelValue.y,step:m(c),disabled:e.disabled,"onUpdate:modelValue":k[1]||(k[1]=(E,g)=>a({x:e.modelValue.x,y:E},g))},null,8,["model-value","step","disabled"])]),_:1})],64)):m(i)==="TRANSFORM"?(_(),Se(TI,{key:6,"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":a},null,8,["model-value","disabled"])):m(i)==="COLOR"?(_(),M("div",LI,[w(ch,{class:"color-field",onClickOutside:k[2]||(k[2]=E=>s.value=!1)},{default:F(()=>[C("button",{type:"button",class:"color-button",disabled:e.disabled,onClick:l},[w(Lu,{hsva:m(f)},null,8,["hsva"])],8,RI),s.value?(_(),M("div",jI,[w(ih,null,{default:F(()=>[w(uh,{class:"color-picker","model-value":m(f),"extra-hue":"","onUpdate:modelValue":u},null,8,["model-value"])]),_:1})])):ce("",!0)]),_:1})])):ce("",!0)])):ce("",!0)}});const td=Me(VI,[["__scopeId","data-v-1c8b1d0c"]]),Ru=e=>(it("data-v-3edd5512"),e=e(),ct(),e),DI={key:0,class:"item-panel"},FI=Ru(()=>C("h5",null,"Data",-1)),UI=Ru(()=>C("h5",null,"Inputs",-1)),GI={key:1},KI=Ru(()=>C("p",null,"No Item",-1)),zI=[KI],YI=J({__name:"GraphItemPanel",setup(e){const t=dn(),n=Ko(),a=n.lastSelectedNode,o=b(mh()),r=b(()=>{var d;if(a.value)return(d=o.value(a.value.type))==null?void 0:d.struct}),s=b(()=>{const d=a.value;return!d||!r.value?{}:Q(d.data,(f,h)=>({...gp(o.value,d,h),label:h}))});function l(d,f,h){const y=a.value;y&&n.updateNode(y.id,{data:{...y.data,[d]:Uw(o.value,y.type,d,y.data[d],f)}},h)}const u=b(()=>{var y,k;if(!a.value||!r.value)return{};const d=a.value.inputs,f=iu((y=o.value(a.value.type))==null?void 0:y.struct,a.value),h=((k=n.resolvedGraph.value)==null?void 0:k.nodeMap)??{};return r.value.inputs,Q(d,(E,g)=>{var A,x,I;const v=((x=(A=r.value)==null?void 0:A.inputs[g])==null?void 0:x.label)??g;return E.from?{type:f[g],value:((I=h[E.from.id])==null?void 0:I[E.from.key])??"",disabled:!0,label:v}:{type:f[g],value:E.value,label:v}})});function i(d,f,h){a.value&&n.updateNode(a.value.id,{inputs:{...a.value.inputs,[d]:{...a.value.inputs[d],value:f}}},h)}const c=b(()=>Object.keys(u.value).length>0);function p(d){t.dispatchCanvasEvent({type:"state",data:{name:"pick-bone",options:d}})}return(d,f)=>m(a)?(_(),M("div",DI,[C("form",{onSubmit:f[0]||(f[0]=Ke(()=>{},["prevent"]))},[FI,(_(!0),M(ye,null,Pe(m(s),(h,y)=>(_(),Se(vn,{key:y},{default:F(()=>[w(td,{label:y,type:h.type,"model-value":h.value,"onUpdate:modelValue":(k,E)=>l(y,k,E),onStartPickBone:p},null,8,["label","type","model-value","onUpdate:modelValue"])]),_:2},1024))),128)),m(c)?(_(),M(ye,{key:0},[UI,(_(!0),M(ye,null,Pe(m(u),(h,y)=>(_(),Se(vn,{key:y},{default:F(()=>[w(td,{label:h.label,type:h.type,"model-value":h.value,disabled:h.disabled,"onUpdate:modelValue":(k,E)=>i(y,k,E),onStartPickBone:p},null,8,["label","type","model-value","disabled","onUpdate:modelValue"])]),_:2},1024))),128))],64)):ce("",!0)],32)])):(_(),M("div",GI,zI))}});const XI=Me(YI,[["__scopeId","data-v-3edd5512"]]),HI=J({__name:"GraphSideBar",setup(e){const t=b(()=>[{key:"item",label:"Item"}]);return(n,a)=>(_(),Se(lh,{tabs:m(t),"default-tab":"item"},{item:F(()=>[w(XI)]),_:1},8,["tabs"]))}}),WI=["transform"],JI=J({__name:"OutlineRect",props:{dep:null,marginSize:{default:()=>({width:0,height:0})}},setup(e){const t=e,n=H(),a=H({width:0,height:0}),o=kk();function r(){if(!n.value)return;const s=o(n.value);a.value={width:s.width+t.marginSize.width*2,height:s.height+t.marginSize.height*2}}return pt(()=>t.dep,r),pt(()=>t.marginSize,r),Ut(r),(s,l)=>(_(),M("g",null,[at(s.$slots,"background",{size:a.value}),C("g",{ref_key:"target",ref:n,transform:`translate(${e.marginSize.width}, ${e.marginSize.height})`},[at(s.$slots,"default")],8,WI)]))}}),qI=["width","height"],ZI={"font-size":"16","font-weight":"600",fill:"red","dominant-baseline":"text-before-edge"},QI=["dy"],eP=J({__name:"ErrorText",props:{errors:null},setup(e){return(t,n)=>(_(),Se(JI,{dep:e.errors,"margin-size":{width:10,height:4}},{background:F(a=>[C("rect",{width:a.size.width,height:a.size.height,fill:"#fff",stroke:"red","stroke-width":"2"},null,8,qI)]),default:F(()=>[C("text",ZI,[(_(!0),M(ye,null,Pe(e.errors,(a,o)=>(_(),M("tspan",{key:o,x:"0",dy:o===0?0:"1.2em"},Ve(a),9,QI))),128))])]),_:1},8,["dep"]))}}),tP={width:"100",height:"40"},nP={xmlns:"http://www.w3.org/1999/xhtml",class:"field"},aP={key:1},oP=J({__name:"GraphNodeDataField",props:{modelValue:null,label:null,type:null},setup(e){const t=e,n=b(()=>t.type.type),a=b(()=>xn(hh()(),"value")),o=b(()=>{var r;switch(t.type.type){case W.TEXT:case W.SCALER:case W.BOOLEAN:return Mn(`${t.modelValue}`,6);case W.BONE:{const s=((r=a.value[t.modelValue])==null?void 0:r.label)??"";return Mn(`${s}`,10)}case W.VECTOR2:{const s=t.modelValue;return`(${Mn(s.x,4)},${Mn(s.y,4)})`}default:return""}});return(r,s)=>(_(),M("foreignObject",tP,[C("div",nP,[C("h5",null,Ve(e.label),1),m(n)==="COLOR"?(_(),Se(Lu,{key:0,transform:e.modelValue,class:"color"},null,8,["transform"])):(_(),M("p",aP,Ve(m(o)),1))])]))}});const rP=Me(oP,[["__scopeId","data-v-6a0b1d68"]]),sP=["x","fill"],lP=J({__name:"GraphNodeInputLabel",props:{inputKey:null,input:null,type:null},setup(e){const t=e,n=H(),a=H(0),o=wn();Ut(async()=>{if(await Ha(),!n.value)return 0;a.value=n.value.getBoundingClientRect().width*o()});const r=b(()=>t.input.from?"":wk(t.type,t.input.value)),s=b(()=>t.type.type===W.COLOR);return(l,u)=>(_(),M("g",null,[C("text",{ref_key:"textRef",ref:n,"dominant-baseline":"middle","font-size":"14",fill:"#000"},Ve(e.inputKey+(m(r)&&!m(s)?` (${m(r)})`:"")),513),m(r)&&m(s)?(_(),M("rect",{key:0,x:a.value+6,y:"-6",width:"12",height:"12",fill:m(r)},null,8,sP)):ce("",!0)]))}});function yh(e){switch(e.type){case W.SCALER:return"l6,8 l-6,8";case W.VECTOR2:return"l6,4 l-6,4 l6,4 l-6,4";case W.TRANSFORM:return"l0,4 l6,0 l0,8 l-6,0 l0,4";case W.COLOR:return"l0,4 l4,0 l0,2 l3,0 l0,4 l-3,0 l0,2 l-4,0 l0,4";case W.BOOLEAN:return"l0,3 l6,0 l0,2 l-6,8 l0,3";case W.OBJECT:return"l0,4 a5,5,0,1,1,0,8 l0,4";case W.D:return"l0,5 l6,0 a6,8,0,0,1,-6,8 l0,3";case W.GENERICS:return"a10 10 0 0 1 0,16";case W.INPUT:return"l0,4 l8,0 l0,8 l-3,0 l0,-2 l-5,0 l0,6";case W.OUTPUT:return"l0,6 l5,0 l0,-2 l3,0 l0,8 l-8,0 l0,4";default:return"a10 10 0 0 1 0,16"}}const uP=["fill"],iP=["d"],Nr=J({__name:"EdgeAnchorMale",props:{type:null},setup(e){const t=e,n=b(()=>Dp[t.type.type]),a=b(()=>`M-6,-8 l6,0 ${yh(t.type)} l-6,0z`);return(o,r)=>(_(),M("g",{fill:m(n),stroke:"#333"},[C("path",{d:m(a),"stroke-linejoin":"round"},null,8,iP)],8,uP))}}),cP=["fill"],dP=["d"],Vr=J({__name:"EdgeAnchorFemale",props:{type:null},setup(e){const t=e,n=b(()=>Dp[t.type.type]),a=b(()=>`M-8,-8 ${yh(t.type)} l12,0 l0,-16z`);return(o,r)=>(_(),M("g",{fill:m(n),stroke:"#333"},[C("path",{d:m(a),"stroke-linejoin":"round"},null,8,dP)],8,cP))}}),vh=e=>(it("data-v-5261b165"),e=e(),ct(),e),fP=["transform"],pP=["data-node_id"],mP=["d","stroke","stroke-width"],hP=["d","stroke","stroke-width","fill"],yP=["fill"],vP=["transform","data-node_type"],gP=vh(()=>C("rect",{width:"18",height:"18",rx:"4",ry:"4",fill:"#eee"},null,-1)),bP=vh(()=>C("path",{d:"M4 6L14 6L9 12z","stroke-linejoin":"round",stroke:"none",fill:"#000"},null,-1)),_P=[gP,bP],SP=["transform"],xP={class:"view-only"},wP=["x","y","height"],kP={x:"-10","dominant-baseline":"middle","text-anchor":"end","font-size":"14",fill:"#000"},EP=["data-node_id","data-edge_key"],CP={class:"view-only"},MP=["transform"],OP=["transform"],TP={class:"view-only"},$P=["y","height"],AP={transform:"translate(10, 0)"},IP=["data-node_id","data-edge_key"],PP=["transform"],BP=J({__name:"GraphNode",props:{node:null,edgePositions:{default:()=>({inputs:{},outputs:{}})},selected:{type:Boolean,default:!1},errors:{default:void 0}},setup(e){const t=e;function n(x){return`M${0},${On} L${0},${14} A${14},${14} 0 0 1 ${14},${0} L${x.width-14},${0} A${14},${14} 0 0 1 ${x.width},${14} L${x.width},${On}`}function a(x){return`M${0},${On} L${0},${x.height-8} A${8},${8} 0 0 0 ${8},${x.height} L${x.width-8},${x.height} A${8},${8} 0 0 0 ${x.width},${x.height-8} L${x.width},${On}`}const{settings:o}=Ct(),r=b(mh()),s=b(()=>{var x;return(x=r.value(t.node.type))==null?void 0:x.struct.custom}),l=b(()=>mu(r.value,t.node)),u=b(()=>n(l.value)),i=b(()=>a(l.value)),c=b(()=>{var x;return(x=r.value(t.node.type))==null?void 0:x.struct}),p=b(()=>{var x;return((x=c.value)==null?void 0:x.label)??"Unknown"}),d=b(()=>{var x;return((x=c.value)==null?void 0:x.color)??"#ccc"}),f=b(()=>{var x;return((x=c.value)==null?void 0:x.textColor)??"#ff0000"}),h=b(()=>gk(r.value,t.node)),y=b(()=>Q(h.value,(x,I)=>({position:x,...gp(r.value,t.node,I)}))),k=b(()=>iu(c.value,t.node)),E=qn,g=b(()=>t.errors?"red":t.selected?o.selectedColor:"#555"),v=b(()=>t.errors?6:t.selected?2:1),A=60;return(x,I)=>(_(),M("g",{transform:`translate(${e.node.position.x}, ${e.node.position.y})`},[C("g",{"data-type":"node-body","data-node_id":e.node.id},[C("path",{d:m(i),stroke:m(g),"stroke-width":m(v),fill:"#fafafa"},null,8,mP),C("path",{d:m(u),stroke:m(g),"stroke-width":m(v),fill:m(d)},null,8,hP)],8,pP),C("g",null,[C("text",{x:"8",y:"6","dominant-baseline":"text-before-edge","font-size":"16",fill:m(f),class:"view-only"},Ve(m(p)),9,yP)]),m(s)?(_(),M("g",{key:0,transform:`translate(${m(l).width-28}, 6)`,"data-type":"node-custom-anchor","data-node_type":e.node.type,class:"node-custom-anchor"},_P,8,vP)):ce("",!0),C("g",null,[(_(!0),M(ye,null,Pe(Object.entries(e.edgePositions.outputs),([O,T])=>(_(),M("g",{key:O,transform:`translate(${T.p.x}, ${T.p.y})`},[C("g",xP,[C("rect",{x:-A,y:-m(E)/2,width:A,height:m(E),fill:"transparent",stroke:"none"},null,8,wP),C("text",kP,Ve(T.label),1)]),C("circle",{"data-type":"node-edge-output","data-node_id":e.node.id,"data-edge_key":O,r:"10",fill:"transparent",stroke:"none",class:"edge-anchor"},null,8,EP),w(Nr,{type:T.type,class:"view-only"},null,8,["type"])],8,SP))),128))]),C("g",CP,[(_(!0),M(ye,null,Pe(m(y),(O,T)=>(_(),M("g",{key:T,transform:`translate(${O.position.x}, ${O.position.y})`},[w(rP,{label:T,type:O.type,"model-value":O.value},null,8,["label","type","model-value"])],8,MP))),128))]),C("g",null,[(_(!0),M(ye,null,Pe(Object.entries(e.edgePositions.inputs),([O,T])=>(_(),M("g",{key:O,transform:`translate(${T.p.x}, ${T.p.y})`},[C("g",TP,[C("rect",{y:-m(E)/2,width:A,height:m(E),fill:"transparent",stroke:"none"},null,8,$P),C("g",AP,[w(lP,{"input-key":T.label,type:m(k)[O],input:e.node.inputs[O]},null,8,["input-key","type","input"])])]),C("circle",{"data-type":"node-edge-input","data-node_id":e.node.id,"data-edge_key":O,r:"10",fill:"transparent",stroke:"none",class:"edge-anchor"},null,8,IP),w(Vr,{type:T.type,class:"view-only"},null,8,["type"])],8,OP))),128))]),e.errors?(_(),M("g",{key:1,transform:`translate(0, ${m(l).height})`},[w(eP,{errors:e.errors},null,8,["errors"])],8,PP)):ce("",!0)],8,fP))}});const LP=Me(BP,[["__scopeId","data-v-5261b165"]]),gh=e=>(it("data-v-d9fa6762"),e=e(),ct(),e),RP=["transform"],jP=["data-node_id"],NP=["d","stroke","stroke-width"],VP=["transform"],DP=["data-node_id"],FP=gh(()=>C("circle",{r:"8",fill:"transparent",stroke:"none"},null,-1)),UP=[FP],GP=["transform"],KP=["data-node_id"],zP=gh(()=>C("circle",{r:"8",fill:"transparent",stroke:"none"},null,-1)),YP=[zP],{settings:XP}=Ct(),HP=J({__name:"GraphNodeReroute",props:{node:null,edgePositions:null,selected:{type:Boolean,default:!1},errors:{default:void 0}},setup(e){const t=e,n=b(()=>t.edgePositions.inputs.value),a=b(()=>t.edgePositions.outputs.value),o=b(()=>{const l=a.value.p.x-n.value.p.x;return`M0,-2 Q${l},-2 ${l},10 T${0},22 z`}),r=b(()=>t.errors?"red":t.selected?XP.selectedColor:"#555"),s=b(()=>t.errors?6:t.selected?3:2);return(l,u)=>(_(),M("g",{transform:`translate(${e.node.position.x}, ${e.node.position.y})`},[C("title",null,Ve(e.node.type),1),C("g",{"data-type":"node-body","data-node_id":e.node.id},[C("path",{d:m(o),stroke:m(r),"stroke-width":m(s),fill:"#ddd"},null,8,NP)],8,jP),C("g",{transform:`translate(${m(a).p.x}, ${m(a).p.y})`},[C("g",{class:"edge-anchor","data-type":"node-edge-output","data-node_id":e.node.id,"data-edge_key":"value"},UP,8,DP),w(Nr,{type:m(a).type,class:"view-only"},null,8,["type"])],8,VP),C("g",{transform:`translate(${m(n).p.x}, ${m(n).p.y})`},[C("g",{class:"edge-anchor","data-type":"node-edge-input","data-node_id":e.node.id,"data-edge_key":"value"},YP,8,KP),w(Vr,{type:m(n).type,class:"view-only"},null,8,["type"])],8,GP)],8,RP))}});const WP=Me(HP,[["__scopeId","data-v-d9fa6762"]]),JP=e=>(it("data-v-8525f932"),e=e(),ct(),e),qP={class:"animation-graph-panel-root"},ZP={class:"top"},QP={class:"select-graph"},eB={class:"graph-buttons"},tB=["disabled"],nB=["disabled"],aB=JP(()=>C("p",null,"(!!Experimental!!)",-1)),oB={class:"main"},rB={key:0},sB=J({__name:"AnimationGraphPanel",setup(e){const t=[{value:"graph",label:"Graph"},{value:"custom",label:"Custom"}],n=jt(),a=In(),o=Ko(),r=b(()=>o.lastSelectedGraph.value),s=go(),l=b(()=>o.getGraphNodeModuleFn.value());$I(()=>l.value);const u=b(()=>n.lastSelectedArmature.value),i=b(()=>o.parentGraph.value),c=H({});pt(i,(B,N)=>{if(N&&(c.value={...c.value,[N.id]:{scale:s.scale.value,origin:s.viewOrigin.value}}),B){const j=c.value[B.id];if(j)s.scale.value=j.scale,s.viewOrigin.value=j.origin;else{const K=Object.values(o.nodeMap.value);s.setViewport(K.length?os(K.map(D=>pu(o.getGraphNodeModuleFn.value(),D))):void 0)}}});const p=b(()=>o.parentGraphs.value.map(B=>B.name)),d=H("");rn(()=>{var B;d.value=((B=i.value)==null?void 0:B.name)??""});function f(){o.graphType.value==="graph"?o.addGraph():o.addCustomGraph()}function h(){o.graphType.value==="graph"?o.deleteGraph():o.deleteCustomGraph()}function y(){var B;p.value.includes(d.value)?d.value=((B=i.value)==null?void 0:B.name)??"":o.graphType.value==="graph"?o.updateGraph({name:d.value}):o.updateCustomGraph({name:d.value})}const k=b(()=>o.graphType.value==="graph"?o.graphs.value.map(B=>{var j;const N=((j=u.value)==null?void 0:j.id)!==B.armatureId;return{value:B.id,label:`${N?"(x)":""} ${B.name}`}}):o.customGraphs.value.map(B=>({value:B.id,label:B.name}))),E=b({get:()=>{var B;return((B=o.selectedGraphByType.value)==null?void 0:B.id)??""},set:B=>o.switchGraph(B)}),g=o.selectedNodes,v=o.editedNodeMap,A=o.edgePositionMap,x=b(()=>{var K,D;const B=o.draftEdge.value;if(!B)return;const N=v.value,j=A.value;if(B.type==="draft-input"){const fe=N[B.output.nodeId],Le=Qa((K=l.value(fe.type))==null?void 0:K.struct,fe,B.output.key);return fe?[{output:ee(fe.position,j[fe.id].outputs[B.output.key].p),input:B.input,type:Le,connected:B.connected}]:void 0}else{const fe=B.inputs[0],Le=un((D=l.value(N[fe.nodeId].type))==null?void 0:D.struct,N[fe.nodeId],fe.key);return B.inputs.filter(Ge=>N[Ge.nodeId]).map(Ge=>({output:B.output,input:ee(N[Ge.nodeId].position,j[Ge.nodeId].inputs[Ge.key].p),type:Le,connected:B.connected,draftOutput:!0}))}});AI(()=>{const B=a.lastSelectedActor.value;if(o.graphType.value!=="graph"||!B||!r.value)return[];if(B.armatureId!==r.value.armatureId)return[];const N=ie(Go([B.svgTree]));return B.elements.map(j=>({value:j,label:Op(N[j])}))}),PI(()=>{const B=n.lastSelectedArmature.value;return o.graphType.value!=="graph"||!B||!r.value?[]:B.id!==r.value.armatureId?[]:Object.values(n.boneMap.value).map(N=>({value:N.id,label:N.name}))});const I=o.graphType,O=B=>o.setGraphType(B),T=o.edgeSummaryMap,L=o.nodeErrorMessagesMap,R=b(()=>{const B=Q(T.value,()=>({inputs:{},outputs:{}}));return Object.values(T.value).forEach(N=>{Object.values(N).forEach(j=>{var K,D,fe,Le;(K=B[j.inputId].inputs)[D=j.inputKey]??(K[D]={p:j.to,type:j.type}),(fe=B[j.outputId].outputs)[Le=j.outputKey]??(fe[Le]={p:j.from,type:j.type})})}),B});return(B,N)=>(_(),M("div",qP,[C("div",ZP,[w(Vn,{"model-value":m(I),options:t,"onUpdate:modelValue":O},null,8,["model-value"]),C("div",QP,[w(Pt,{modelValue:m(E),"onUpdate:modelValue":N[0]||(N[0]=j=>Fe(E)?E.value=j:null),options:m(k)},null,8,["modelValue","options"])]),Qn(C("input",{"onUpdate:modelValue":N[1]||(N[1]=j=>d.value=j),type:"text",class:"name-input",onChange:y},null,544),[[Qr,d.value]]),C("div",eB,[C("button",{type:"button",class:"add-graph",title:"Add graph",disabled:!m(u),onClick:f},[w(sh)],8,tB),C("button",{type:"button",class:"delete-graph",title:"Delete graph",disabled:!m(E),onClick:h},[w(fs)],8,nB)]),aB]),C("div",oB,[w(KA,{class:"canvas",canvas:m(s)},{default:F(()=>[C("g",null,[(_(!0),M(ye,null,Pe(m(T),(j,K)=>(_(),M("g",{key:`edge_${K}`},[(_(!0),M(ye,null,Pe(j,(D,fe)=>(_(),M("g",{key:fe},[(_(),Se(Zc,{key:fe,from:D.from,to:D.to,"input-id":D.inputId,"input-key":D.inputKey,"output-id":D.outputId,"output-key":D.outputKey},null,8,["from","to","input-id","input-key","output-id","output-key"]))]))),128))]))),128))]),C("g",null,[(_(!0),M(ye,null,Pe(m(v),j=>(_(),M("g",{key:`node_${j.id}`},[(_(),Se(Nl(j.type==="reroute"?WP:LP),{node:j,"edge-positions":m(A)[j.id],selected:m(g)[j.id],errors:m(L)[j.id]},null,8,["node","edge-positions","selected","errors"])),(_(!0),M(ye,null,Pe(m(R)[j.id].inputs,(K,D)=>(_(),M("g",{key:`input_${D}`},[w(Nr,{type:K.type,transform:`translate(${K.p.x-8},${K.p.y})`},null,8,["type","transform"])]))),128)),(_(!0),M(ye,null,Pe(m(R)[j.id].outputs,(K,D)=>(_(),M("g",{key:`output_${D}`},[w(Vr,{type:K.type,transform:`translate(${K.p.x+8},${K.p.y})`},null,8,["type","transform"])]))),128))]))),128))]),m(x)?(_(),M("g",rB,[(_(!0),M(ye,null,Pe(m(x),(j,K)=>(_(),M("g",{key:`draft-edge_${K}`},[w(Zc,{from:j.output,to:j.input,status:j.connected?"connected":"connecting"},null,8,["from","to","status"]),!j.draftOutput||j.connected?(_(),Se(Nr,{key:0,type:j.type,transform:`translate(${j.input.x-(j.connected?8:0)},${j.input.y})`},null,8,["type","transform"])):ce("",!0),j.draftOutput||j.connected?(_(),Se(Vr,{key:1,type:j.type,transform:`translate(${j.output.x+(j.connected?8:0)},${j.output.y})`},null,8,["type","transform"])):ce("",!0)]))),128))])):ce("",!0)]),_:1},8,["canvas"]),w(HI,{class:"side-bar"})])]))}});const lB=Me(sB,[["__scopeId","data-v-8525f932"]]);function bh(e,t,n){return{x:dm(t),y:e.value*n}}function bl(e,t){return{x:dm(e.x),y:e.y*t}}function uB(e,t){return{x:wu(e.x),y:e.y/t}}function iB(e,t,n,a,o,r){if(e===a.length-1)return{...n};const s=a[e+1],l=bh(s.points[o],s.frame,r);if(t.curve.name!=="bezier3")return{...n,to:l};const u=bl(t.curve.controlOut,r),i=bl(s.points[o].curve.controlIn,r),[,c,p]=qp(n.from,u,i,l),[,d,f]=Zp(n.from,u,i,l);return{...n,to:l,c1:c,c2:p,fixedC1:d,fixedC2:f,controlOut:c}}function cB(e){const t=e.keyframes.length,n={};let a;return e.keyframes.reduce((o,r,s)=>{const l=e.selectedStateMap[r.id],u=r.points[e.pointKey],i=bh(u,r.frame,e.valueWidth),c=(a==null?void 0:a.name)==="bezier3"?ee(bl(u.curve.controlIn,e.valueWidth),i):void 0;n[r.id]=!0;const p=iB(s,u,{id:r.id,keyframeName:r.name,name:u.curve.name,selected:(l==null?void 0:l.props[e.pointKey])??!1,first:s===0,last:s===t-1,from:i,controlIn:c},e.keyframes,e.pointKey,e.valueWidth);return a=p,o[p.id]=p,o},{})}function dB(e,t,n,a=!1){return Object.keys(t).reduce((o,r)=>(e[r]&&(o[r]=fB(e[r],t[r],n,a)),o),{})}function fB(e,t,n,a=!1){return{...e,points:Q(e.points,(o,r)=>{const s=t[r];if(!s)return o;if(s.controlIn){const l={x:Math.min(o.curve.controlIn.x+n.x,0),y:o.curve.controlIn.y+n.y},u=a?Hi({x:0,y:0},l,o.curve.controlOut):o.curve.controlOut;return{value:o.value,curve:{name:o.curve.name,controlIn:l,controlOut:u}}}else{const l={x:Math.max(o.curve.controlOut.x+n.x,0),y:o.curve.controlOut.y+n.y},u=a?Hi({x:0,y:0},l,o.curve.controlIn):o.curve.controlIn;return{value:o.value,curve:{name:o.curve.name,controlIn:u,controlOut:l}}}})}}function nd(){return pB}const pB={getLabel:()=>"Grabbing",shouldRequestPointerLock:!0,onStart:async e=>{e.startEditMovement()},onEnd:async e=>{e.setEditMovement()},handleEvent:async(e,t)=>{switch(t.type){case"pointermove":e.setEditMovement({...t.data,current:{x:t.data.current.x,y:t.data.start.y}});return;case"pointerup":return t.data.options.button===0&&e.completeEdit(),_l;case"keydown":switch(t.data.key){case"Escape":return _l}return}}};function _h(){let e="";return{getLabel:()=>"MovingFrame",onStart:async t=>{t.startDragging(),e=t.generateSeriesKey()},handleEvent:async(t,n)=>{switch(n.type){case"pointerdrag":t.setCurrentFrame(ml(n.data.current.x),e);return;case"pointerup":return t.setCurrentFrame(ml(n.data.point.x),e),{type:"break"};case"keydown":switch(n.data.key){case"Escape":return{type:"break"}}return}}}}function Sh(e){return{getLabel:()=>"ChangingCurveType",onStart:async t=>{t.setPopupMenuList({items:Jp.map(n=>({label:n.label,key:n.name})),point:e.point})},onEnd:async t=>{t.setPopupMenuList()},handleEvent:async(t,n)=>{switch(n.type){case"pointerdown":switch(n.data.options.button){case 1:return Gt}return{type:"break"};case"keydown":switch(n.data.key){case"Escape":return{type:"break"}}return;case"popupmenu":{const a=t.getSelectedKeyframes();return t.updateKeyframes(UE(tt(t.getKeyframes(),a),a,o=>({...o,curve:{...o.curve,name:n.data.key}}))),{type:"break"}}}}}}function xh(e){const t=e.getKeyframes(),n=Object.keys(e.getSelectedKeyframes()).reduce((a,o)=>{const r=t[o];if(r){const s=e.generateUuid();a[s]=lm({...r,id:s})}return a},{});e.setTmpKeyframes(n)}const ad=cs("keyframes");function Dr(e){return is(()=>({"text/plain":ad.serialize(ke(um(e.getKeyframes(),e.getSelectedKeyframes()).selected))}),async t=>{const n=t.find(r=>r.kind==="string");if(!n)return;const a=await n.getAsString(),o=ad.deserialize(a);o.length!==0&&e.pasteKeyframes(o)})}function _l(){return mB}const mB={getLabel:()=>"Default",onStart:async e=>{od(e)},handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 0:switch(t.target.type){case"keyframes-by-frame":{const n=parseInt(t.target.id),a=Je(e.getKeyframes(),o=>o.frame===n);Object.keys(a).length>0&&e.selectKeyframes(Q(a,o=>Ir(o)),t.data.options.shift);return}case"keyframe-body":{const n=t.target.id;e.selectKeyframe(n,Ir(e.getKeyframes()[n]),t.data.options.shift);return}case"keyframe-prop":{const n=t.target.data.key;e.selectKeyframe(t.target.id,{props:{[n]:!0}},t.data.options.shift);return}case"frame-control":return _h;default:t.data.options.shift||e.selectKeyframe("");return}case 1:return Gt}return;case"keydown":switch(t.data.key){case"a":e.selectAllKeyframes();return;case"x":e.getLastSelectedKeyframeId()&&e.deleteKeyframes();return;case"g":return e.getLastSelectedKeyframeId()?nd:void 0;case"D":return e.getLastSelectedKeyframeId()?(xh(e),nd):void 0;case"t":if(e.getLastSelectedKeyframeId()){const n=t.point;return n?()=>Sh({point:n}):void 0}return;case"!":case"Home":{e.setViewport();return}default:return}case"copy":{Dr(e).onCopy(t.nativeEvent);return}case"paste":{await Dr(e).onPaste(t.nativeEvent);return}case"selection":od(e);return;default:return}}};function od(e){e.setCommandExams([{command:"a",title:"All Select"},...e.getLastSelectedKeyframeId()?[{command:"g",title:"Grab"},{command:"t",title:"Interpolation"},{command:"x",title:"Delete"},{command:"D",title:"Duplicate"}]:[],{command:"Space",title:"Play/Stop"}])}function rd(){return hB}const hB={getLabel:()=>"Grabbing",shouldRequestPointerLock:!0,onStart:async e=>{e.startEditMovement()},onEnd:async e=>{e.setEditMovement()},handleEvent:async(e,t)=>{switch(t.type){case"pointermove":e.setEditMovement(t.data);return;case"pointerup":return t.data.options.button===0&&e.completeEdit(),ga;case"keydown":switch(t.data.key){case"Escape":return ga}return}}};function yB(e){return{getLabel:()=>"MovingBezier",onStart:async t=>{t.startDragging(),t.setCommandExams([{command:"Shift",title:"Synchronize"},{command:tn(),title:"Symmetrize"}])},handleEvent:async(t,n)=>{switch(n.type){case"pointerdrag":{const a=dB(t.getKeyframes(),n.data.shift?Q(t.getSelectedKeyframes(),({props:o})=>Q(o,()=>e.controls)):{[e.id]:{[e.key]:e.controls}},t.toCurveControl(Ce(n.data.current,n.data.start)),n.data.ctrl);t.setTmpKeyframes(a);return}case"pointerup":return t.completeEdit(),ga;case"keydown":switch(n.data.key){case"Escape":return ga}return}}}}function vB(){return gB}const gB={getLabel:()=>"RectangleSelecting",onStart:async e=>{e.startDragging(),e.setRectangleDragging(!0)},onEnd:async e=>{e.setRectangleDragging()},handleEvent:async(e,t)=>{switch(t.type){case"pointerup":{const n=e.getDraggedRectangle();if(n){const a=e.toFrameValue(n,!0),o=e.toFrameValue({x:n.x+n.width,y:n.y+n.height},!0);e.selectKeyframes(zE(e.getKeyframes(),[a.x,o.x],[a.y,o.y]),t.data.options.shift)}return ga}case"keydown":switch(t.data.key){case"Escape":return ga}return}}};function ga(){return bB}const bB={getLabel:()=>"Default",onStart:async e=>{sd(e)},handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 0:switch(t.target.type){case"keyframe-body":{const n=t.target.id;e.selectKeyframe(n,Ir(e.getKeyframes()[n]),t.data.options.shift);return}case"keyframe-prop":{const n=t.target.data.key;e.selectKeyframe(t.target.id,{props:{[n]:!0}},t.data.options.shift);return}case"frame-control":return _h;case"bezier-control":{const n=t.target.data??{};return()=>yB({id:t.target.id,key:n.key,controls:{controlIn:!!n.control_in,controlOut:!!n.control_out}})}default:return t.data.options.shift||e.selectKeyframe(""),vB}case 1:return Gt}return;case"keydown":switch(t.data.key){case"a":e.selectAllKeyframes();return;case"x":e.getLastSelectedKeyframeId()&&e.deleteKeyframes();return;case"g":return e.getLastSelectedKeyframeId()?rd:void 0;case"D":return e.getLastSelectedKeyframeId()?(xh(e),rd):void 0;case"t":if(e.getLastSelectedKeyframeId()){const n=t.point;return n?()=>Sh({point:n}):void 0}return;case"!":case"Home":{e.setViewport();return}default:return}case"copy":{Dr(e).onCopy(t.nativeEvent);return}case"paste":{await Dr(e).onPaste(t.nativeEvent);return}case"selection":sd(e);return;default:return}}};function sd(e){e.setCommandExams([{command:"a",title:"All Select"},...e.getLastSelectedKeyframeId()?[{command:"g",title:"Grab"},{command:"t",title:"Interpolation"},{command:"x",title:"Delete"},{command:"D",title:"Duplicate"}]:[],{command:"Space",title:"Play/Stop"}])}function _B(){return SB}const SB={getLabel:()=>"Default",handleEvent:async(e,t)=>{switch(t.type){case"pointerdown":switch(t.data.options.button){case 1:return Gt}return;case"keydown":switch(t.data.key){case"a":e.selectAllKeyframes();return;case"!":case"Home":{e.setViewport();return}default:return}default:return}}};function xB(e){return e.canvasType==="graph"?{sm:Ra(ld(e),ga)}:e.canvasType==="label"?{sm:Ra(ld(e),_B)}:{sm:Ra(wB(e),_l)}}function wB(e){return wh(e)}function ld(e){return{...wh(e),toCurveControl:t=>uB(t,e.settings.graphValueWidth),toFrameValue:(t,n)=>fm(t,e.settings.graphValueWidth,n)}}function wh(e){const{animationStore:t}=e;return{...kB(e),generateUuid:We,setViewport:e.setViewport,panView:e.panView,startDragging:e.startDragging,setRectangleDragging:e.setRectangleDragging,getDraggedRectangle:e.getDraggedRectangle,setPopupMenuList:e.setPopupMenuList,setCommandExams:e.setCommandExams,generateSeriesKey:()=>`${Date.now()}`,startEditMovement:e.startEditMovement,getCursorPoint:e.getCursorPoint,getEditMovement:t.getEditMovement,setEditMovement:t.setEditMovement,completeEdit:t.completeEdit,setCurrentFrame:t.setCurrentFrame,getKeyframes:()=>t.visibledKeyframeMap.value,getLastSelectedKeyframeId:()=>{var n;return((n=t.lastSelectedKeyframe.value)==null?void 0:n.id)??""},getSelectedKeyframes:()=>t.selectedKeyframeMap.value,selectKeyframe:t.selectKeyframe,selectKeyframes:t.selectKeyframes,selectAllKeyframes:t.selectAllKeyframes,deleteKeyframes:t.execDeleteKeyframes,updateKeyframes:t.execUpdateKeyframes,pasteKeyframes:t.pasteKeyframes,setTmpKeyframes:t.setTmpKeyframes}}function kB(e){return{requestPointerLock:e.requestPointerLock,exitPointerLock:e.exitPointerLock,getTimestamp:()=>Date.now()}}const EB=["viewBox","width","height","onMousedown","onMouseup"],CB=J({__name:"TimelineCanvas",props:{canvas:null,canvasType:null},setup(e){const t=e,{wrapper:n,svg:a,addRootPosition:o,removeRootPosition:r}=ku(()=>t.canvas);yu(()=>t.canvas.scale.value);const s=H(),l=b(()=>s.value?o(t.canvas.canvasToView(s.value.point)):void 0),u=Tu(()=>{var D;return((D=s.value)==null?void 0:D.items.map(({label:fe,key:Le,data:Ge})=>({label:fe,exec:Le?()=>A(Le,Ge):void 0})))??[]}),i=H(),c=cn(),{settings:p}=Ct(),d=xB({indexStore:jt(),animationStore:c,settings:p,canvasType:t.canvasType,requestPointerLock:()=>{a.value&&(t.canvas.startMoving(),h.requestPointerLockFromElement(a.value))},exitPointerLock:()=>{h.exitPointerLock(),t.canvas.endMoving()},startEditMovement:()=>{c.setEditMovement({start:t.canvas.viewToCanvas(t.canvas.mousePoint.value),current:t.canvas.viewToCanvas(t.canvas.mousePoint.value),ctrl:!1,scale:t.canvas.scale.value})},startDragging:()=>t.canvas.startDragging(),getCursorPoint:()=>t.canvas.viewToCanvas(t.canvas.mousePoint.value),setViewport:D=>t.canvas.setViewport(D),panView:D=>t.canvas.viewMove(D),setRectangleDragging:D=>t.canvas.setRectangleDragging(D),getDraggedRectangle:()=>t.canvas.draggedRectangle.value,setPopupMenuList:D=>s.value=D,setCommandExams:D=>i.value=D}),f=ta(E,1e3/60,!0),h=ts({onMove:f,onGlobalMove:D=>{if(!a.value)return;const fe=r(D.p);fe&&t.canvas.setMousePoint(fe)},onEscape:()=>{d.sm.handleEvent({type:"keydown",data:{key:"Escape"},point:t.canvas.viewToCanvas(t.canvas.mousePoint.value)})}});pt(c.selectedKeyframeMap,()=>{d.sm.handleEvent({type:"selection"})});function y(D){d.sm.handleEvent({type:"pointerdown",target:za(D),data:{point:t.canvas.viewToCanvas(t.canvas.mousePoint.value),options:gn(D)}})}function k(D){t.canvas.endMoving(),d.sm.handleEvent({type:"pointerup",target:za(D),data:{point:t.canvas.viewToCanvas(t.canvas.mousePoint.value),options:gn(D)}})}function E(D){t.canvas.editStartPoint.value&&d.sm.handleEvent({type:"pointermove",data:{start:t.canvas.viewToCanvas(t.canvas.editStartPoint.value),current:t.canvas.viewToCanvas(t.canvas.mousePoint.value),ctrl:D.ctrl,shift:D.shift,scale:t.canvas.scale.value}})}function g(D){t.canvas.dragged.value&&t.canvas.editStartPoint.value&&d.sm.handleEvent({type:"pointerdrag",data:{start:t.canvas.viewToCanvas(t.canvas.editStartPoint.value),current:t.canvas.viewToCanvas(t.canvas.mousePoint.value),scale:t.canvas.scale.value,...gn(D)}})}function v(D){d.sm.handleEvent({type:"keydown",data:Oo(D),point:t.canvas.viewToCanvas(t.canvas.mousePoint.value)})}function A(D,fe={}){d.sm.handleEvent({type:"popupmenu",data:{key:D,...fe}})}function x(D){d.sm.handleEvent({type:"copy",nativeEvent:D})}function I(D){d.sm.handleEvent({type:"paste",nativeEvent:D})}const O=b(()=>t.canvas.scale.value),T=b(()=>t.canvas.viewOrigin.value),L=b(()=>t.canvas.viewSize.value),R=b(()=>t.canvas.viewBox.value),B=b(()=>u.list.value),N=b(()=>t.canvas.draggedRectangle.value),j=x,K=I;return(D,fe)=>(_(),M("div",{ref_key:"wrapper",ref:n,class:"timeline-canvas-root"},[w(gu,{onKeydown:v,onCopy:m(j),onPaste:m(K)},{default:F(()=>[(_(),M("svg",{ref_key:"svg",ref:a,xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none","font-family":"sans-serif",viewBox:m(R),width:m(L).width,height:m(L).height,onWheel:fe[0]||(fe[0]=Ke((...Le)=>e.canvas.wheel&&e.canvas.wheel(...Le),["prevent"])),onMousedown:Ke(y,["prevent"]),onMouseup:Ke(k,["prevent"]),onMousemove:g,onContextmenu:fe[1]||(fe[1]=Ke(()=>{},["prevent"]))},[at(D.$slots,"default",{scale:m(O),viewOrigin:m(T),viewSize:m(L)},void 0,!0),m(N)?(_(),Se(vu,{key:0,x:m(N).x,y:m(N).y,width:m(N).width,height:m(N).height,class:"view-only"},null,8,["x","y","width","height"])):ce("",!0)],40,EB))]),_:3},8,["onCopy","onPaste"]),w(zl,{class:"command-exam-panel","available-command-list":i.value},null,8,["available-command-list"]),m(B).length>0&&m(l)?(_(),Se(Yl,{key:0,class:"popup-menu-list","popup-menu-list":m(B),style:st({left:`${m(l).x-20}px`,top:`${m(l).y-10}px`})},null,8,["popup-menu-list","style"])):ce("",!0)],512))}});const Fs=Me(CB,[["__scopeId","data-v-ad1b6040"]]),MB={class:"view-only"},OB=["transform"],TB=["y1","stroke-width"],$B={class:"view-only"},AB=["transform"],IB=C("g",{transform:"scale(-1, 1)"},[C("rect",{width:"200000",height:"200000"})],-1),PB=["transform"],BB=C("rect",{width:"200000",height:"200000"},null,-1),LB=[BB],RB={class:"view-only"},jB=["transform","y1"],NB=["transform"],VB=["height"],DB={class:"view-only"},FB=["transform"],UB=["y","font-size"],GB={class:"view-only"},KB=["transform"],zB=["x","y","width"],YB=["y"],ud=J({__name:"TimelineAxis",props:{scale:{default:1},originX:{default:0},viewWidth:{default:100},currentFrame:{default:0},endFrame:{default:60},headerHeight:{default:24}},setup(e){const t=e,n=b(()=>YE(t.scale)),a=b(()=>JE(n.value,t.originX)),o=b(()=>Math.ceil(t.viewWidth*t.scale/yn)),r=b(()=>Math.ceil(o.value/n.value)+3),s=b(()=>[...Array(r.value)].map((c,p)=>{const d=p*n.value+a.value;return{f:d,labelSize:d%10===0?14:d%5===0?11:0,strokeWidth:d%10===0?2:1}})),l=b(()=>t.currentFrame*yn),u=b(()=>Math.max(t.currentFrame.toString().length,2)*10+2),i=b(()=>t.endFrame*yn);return(c,p)=>(_(),M("g",null,[C("g",MB,[(_(!0),M(ye,null,Pe(m(s),d=>(_(),M("g",{key:d.f,transform:`translate(${d.f*m(yn)}, 0) scale(${e.scale})`},[d.strokeWidth>0?(_(),M("line",{key:0,x1:"0",y1:e.headerHeight,x2:"0",y2:"20000",class:"stroke-background-second","stroke-width":d.strokeWidth},null,8,TB)):ce("",!0)],8,OB))),128))]),C("g",$B,[C("g",{transform:`translate(0, ${e.headerHeight})`,stroke:"none","fill-opacity":"0.5",class:"fill-background-second"},[IB,C("g",{transform:`translate(${m(i)}, 0)`},LB,8,PB)],8,AB)]),C("g",RB,[C("line",{transform:`translate(${m(l)}, 0) scale(${e.scale})`,x1:"0",y1:e.headerHeight,x2:"0",y2:"20000",stroke:"blue","stroke-width":"2"},null,8,jB)]),at(c.$slots,"default"),C("g",{transform:`scale(${e.scale})`,"data-type":"frame-control"},[C("rect",{x:"-100000",width:"200000",height:e.headerHeight,class:"fill-background stroke-text"},null,8,VB)],8,NB),C("g",DB,[(_(!0),M(ye,null,Pe(m(s),d=>(_(),M("g",{key:d.f,transform:`translate(${d.f*m(yn)}, 0) scale(${e.scale})`},[d.labelSize>0?(_(),M("text",{key:0,y:e.headerHeight-4,"font-size":d.labelSize,"dominant-baseline":"text-after-edge","text-anchor":"middle",class:"fill-text"},Ve(d.f),9,UB)):ce("",!0)],8,FB))),128))]),C("g",GB,[C("g",{transform:`translate(${m(l)}, 0) scale(${e.scale})`},[C("rect",{x:-m(u)/2,y:e.headerHeight-22,width:m(u),height:20,rx:"4",ry:"4",fill:"blue",stroke:"none"},null,8,zB),C("text",{y:e.headerHeight-4,"font-size":"12","dominant-baseline":"text-after-edge","text-anchor":"middle",fill:"#fff"},Ve(e.currentFrame),9,YB)],8,KB)])]))}}),XB={"font-size":"14","text-anchor":"middle","dominant-baseline":"middle"},HB=["transform"],WB={transform:"translate(10,0) rotate(-90)"},JB={class:"fill-text"},qB=["x2"],ZB=J({__name:"GraphAxis",props:{scale:{default:1},originY:{default:0},viewWidth:{default:100},viewHeight:{default:100}},setup(e){const t=e,{settings:n}=Ct(),a=b(()=>XE(n.graphValueWidth,t.scale)),o=b(()=>qE(n.graphValueWidth,a.value,t.originY)),r=b(()=>Math.ceil(t.viewHeight*t.scale/n.graphValueWidth)),s=b(()=>Math.ceil(r.value/a.value)+3),l=b(()=>[...Array(s.value)].map((i,c)=>c*a.value+o.value)),u=b(()=>n.graphValueWidth);return(i,c)=>(_(),M("g",XB,[(_(!0),M(ye,null,Pe(m(l),p=>(_(),M("g",{key:p,transform:`translate(0, ${p*m(u)}) scale(${e.scale})`},[C("g",WB,[C("text",JB,Ve(p),1)]),C("line",{x1:"16",x2:e.viewWidth,stroke:"#aaa"},null,8,qB)],8,HB))),128))]))}}),QB=e=>(it("data-v-0852b150"),e=e(),ct(),e),eL=["width","height"],tL=["y"],nL=["transform"],aL=QB(()=>C("rect",{x:"-1",y:"-1",width:"14",height:"14",stroke:"none",class:"fill-background-second"},null,-1)),oL={"stroke-linejoin":"round",stroke:"none",class:"fill-background"},rL={key:0,d:"M2 9L10 9L6 3z"},sL={key:1,d:"M10 3L2 3L6 9z"},lL=J({__name:"TimelineRow",props:{labelWidth:{default:100},labelHeight:{default:24},label:null,expanded:{type:Boolean},showExpanded:{type:Boolean},selected:{type:Boolean},highlight:{type:Boolean,default:!1}},emits:["toggle-expanded"],setup(e,{emit:t}){function n(){t("toggle-expanded")}return(a,o)=>(_(),M("g",{class:"toggle-expanded",onClick:n},[C("rect",{width:e.labelWidth,height:e.labelHeight,class:"fill-background stroke-text"},null,8,eL),C("text",{x:"4",y:e.labelHeight/2,"dominant-baseline":"central",class:et(e.highlight?"fill-highlight":"fill-text")},Ve(e.label),11,tL),e.showExpanded?(_(),M("g",{key:0,transform:`translate(${e.labelWidth-16}, ${e.labelHeight/2-6})`},[aL,C("g",oL,[e.expanded?(_(),M("path",rL)):(_(),M("path",sL))])],8,nL)):ce("",!0)]))}});const lr=Me(lL,[["__scopeId","data-v-0852b150"]]),uL=["width"],iL=["x1","x2"],cL=["transform"],dL=["transform"],fL={key:0},pL=["transform"];function mL(e){return{translateX:"Translate X",translateY:"Translate Y",rotate:"Rotate",scaleX:"Scale X",scaleY:"Scale Y",influence:"Influence"}[e]??""}const hL=J({__name:"TimelineTargets",props:{targetList:{default:()=>[]},labelWidth:{default:200},height:{default:24},scrollY:{default:0},targetExpandedMap:{default:()=>({})},targetTopMap:{default:()=>({})},propsStateMap:{default:()=>({})}},emits:["toggle-target-expanded","select"],setup(e,{emit:t}){const n=e;function a(l){t("toggle-target-expanded",l)}const o=b(()=>n.targetList.map(l=>Lp(n.height,0,l.children)));function r(l,u){var i;return((i=n.propsStateMap[l])==null?void 0:i.props[u])==="selected"}function s(l,u,i=!1){t("select",l,{props:{[u]:"selected"}},i)}return(l,u)=>(_(),M("g",null,[C("rect",{width:e.labelWidth,height:"10000",stroke:"none",class:"fill-background"},null,8,uL),C("line",{x1:e.labelWidth,y1:"0",x2:e.labelWidth,y2:"10000",class:"stroke-text"},null,8,iL),C("g",{transform:`translate(0, ${-e.scrollY})`},[(_(!0),M(ye,null,Pe(e.targetList,(i,c)=>(_(),M("g",{key:i.id,transform:`translate(0, ${e.targetTopMap[i.id]})`},[w(lr,{"label-width":e.labelWidth,"label-height":e.height,label:i.name,expanded:e.targetExpandedMap[i.id],"show-expanded":"",onToggleExpanded:p=>a(i.id)},null,8,["label-width","label-height","label","expanded","onToggleExpanded"]),e.targetExpandedMap[i.id]?(_(),M("g",fL,[(_(!0),M(ye,null,Pe(Object.entries(m(o)[c]),([p,d])=>(_(),Se(lr,{key:p,transform:`translate(10, ${d})`,"label-width":e.labelWidth-10,"label-height":e.height,label:mL(p),highlight:r(i.id,p),onClick:[Ke(f=>s(i.id,p),["left","exact"]),Ke(f=>s(i.id,p,!0),["left","shift","exact"])]},null,8,["transform","label-width","label-height","label","highlight","onClick"]))),128))])):ce("",!0)],8,dL))),128))],8,cL),C("g",null,[w(lr,{"label-width":e.labelWidth,"label-height":e.height,label:""},null,8,["label-width","label-height"])]),C("g",{transform:`translate(0, ${e.height})`},[w(lr,{"label-width":e.labelWidth,"label-height":e.height,label:"Summary"},null,8,["label-width","label-height"])],8,pL)]))}}),yL={key:0},vL=["y","width"],gL=["cy","fill"],bL=["cy","onClick"],id=J({__name:"KeyPoint",props:{top:null,selected:{type:Boolean,default:!1},sameRangeWidth:{default:0},tooltip:{default:""}},emits:["select","shift-select"],setup(e,{emit:t}){const{settings:n}=Ct(),a=b(()=>n.selectedColor);function o(){t("select")}function r(){t("shift-select")}return(s,l)=>(_(),M("g",null,[e.tooltip?(_(),M("title",yL,Ve(e.tooltip),1)):ce("",!0),C("rect",{y:e.top-3,width:e.sameRangeWidth,height:"6",fill:"#aaa","fill-opacity":"0.5",class:"view-only"},null,8,vL),C("circle",{cy:e.top,r:"5",stroke:"#000",fill:e.selected?m(a):"#fff"},null,8,gL),C("circle",{cy:e.top,r:"10",fill:"transparent",onClick:[Ke(o,["left","exact"]),Ke(r,["left","shift","exact"])]},null,8,bL)]))}}),_L=J({__name:"KeyPointGroup",props:{keyFrame:null,childMap:null,top:{default:0},selectedState:{default:()=>({name:"",props:{}})},expanded:{type:Boolean,default:!1},sameRangeWidth:{default:()=>rm(()=>0).props},height:{default:24},scrollY:{default:0}},setup(e){const t=e;function n(r){return r>t.scrollY+t.height*1.5}const a=b(()=>am(t.selectedState)),o=b(()=>Je(Lp(t.height,t.top,t.childMap),(r,s)=>s in t.keyFrame.points&&n(r)));return(r,s)=>(_(),M("g",null,[n(e.top)?(_(),Se(id,{key:0,top:e.top,selected:m(a),"same-range-width":e.sameRangeWidth.all,"data-type":"keyframe-body","data-id":e.keyFrame.id},null,8,["top","selected","same-range-width","data-id"])):ce("",!0),e.expanded?(_(!0),M(ye,{key:1},Pe(m(o),(l,u)=>(_(),Se(id,{key:u,top:l,selected:e.selectedState.props[u],"same-range-width":e.sameRangeWidth[u],tooltip:e.keyFrame.points[u].curve.name,"data-type":"keyframe-prop","data-id":e.keyFrame.id,"data-key":u},null,8,["top","selected","same-range-width","tooltip","data-id","data-key"]))),128)):ce("",!0)]))}}),SL=["transform"],xL=C("line",{x1:"-100000",x2:"100000",class:"stroke-text"},null,-1),wL=[xL],kL=["transform"],EL=["transform"],CL=["data-id","cy","fill"],ML=["transform"],OL=J({__name:"KeyframeGroup",props:{scale:{default:1},keyframeMapByFrame:{default:()=>({})},targetList:{default:()=>[]},selectedKeyframeMap:{default:()=>({})},scrollY:{default:0},height:{default:24},targetExpandedMap:{default:()=>({})},targetTopMap:{default:()=>({})}},setup(e){const t=e,{settings:n}=Ct(),a=b(()=>t.targetList.map(h=>h.id)),o=b(()=>a.value.reduce((h,y,k)=>(h[y]=k,h),{})),r=b(()=>o.value),s=b(()=>Object.keys(t.keyframeMapByFrame).reduce((h,y)=>(h[y]=d(t.keyframeMapByFrame[y]),h),{})),l=b(()=>Ka(Object.keys(t.keyframeMapByFrame).flatMap(h=>t.keyframeMapByFrame[h]))),u=b(()=>NE(l.value));function i(h,y){var g;const k=(g=u.value[h])==null?void 0:g[y];if(!k)return;const E=Q(k.props,v=>v*yn/t.scale);return E.all=Math.min(...Object.keys(E).map(v=>E[v])),E}const c=b(()=>Q(t.keyframeMapByFrame,h=>h.some(y=>t.selectedKeyframeMap[y.id]))),p=b(()=>ie(t.targetList));function d(h){return h.filter(y=>r.value[y.targetId]>-1).sort((y,k)=>r.value[y.targetId]-r.value[k.targetId])}const f=n.selectedColor;return(h,y)=>(_(),M("g",null,[C("g",{transform:`scale(${e.scale}) translate(0, ${e.height*2})`},wL,8,SL),(_(!0),M(ye,null,Pe(m(s),(k,E)=>(_(),M("g",{key:E,transform:`translate(${parseInt(E)*m(yn)}, 0)`},[C("g",{transform:`scale(${e.scale}) translate(0, ${e.height/2})`},[k.length>0?(_(),M("circle",{key:"all","data-type":"keyframes-by-frame","data-id":E,cy:e.height,r:"5",stroke:"#000",fill:m(c)[E]?m(f):"#fff"},null,8,CL)):ce("",!0),C("g",{transform:`translate(0, ${-e.scrollY})`},[(_(!0),M(ye,null,Pe(k,g=>(_(),M("g",{key:g.id},[w(_L,{"key-frame":g,"child-map":m(p)[g.targetId].children,top:e.targetTopMap[g.targetId],"selected-state":e.selectedKeyframeMap[g.id],expanded:e.targetExpandedMap[g.targetId],"same-range-width":i(g.targetId,g.frame),height:e.height,"scroll-y":e.scrollY},null,8,["key-frame","child-map","top","selected-state","expanded","same-range-width","height","scroll-y"])]))),128))],8,ML)],8,EL)],8,kL))),128))]))}}),TL={stroke:"#000",fill:"#fff",class:"view-only"},$L=["x1","y1","x2","y2"],AL=["x1","y1","x2","y2"],IL={stroke:"#000",fill:"#fff"},PL=["x","y","width","height"],BL=["x","y","width","height"],LL={fill:"transparent"},RL=["x","y","width","height","data-id","data-key"],jL=["x","y","width","height","data-id","data-key"],NL=J({__name:"BezierControls",props:{pointId:null,pointKey:null,c0:null,controlIn:{default:void 0},controlOut:{default:void 0},color:{default:"#fff"},scale:{default:1}},setup(e){const t=e,n=b(()=>10*t.scale);return(a,o)=>(_(),M("g",null,[C("g",TL,[e.controlIn?(_(),M("line",{key:0,x1:e.controlIn.x,y1:e.controlIn.y,x2:e.c0.x,y2:e.c0.y},null,8,$L)):ce("",!0),e.controlOut?(_(),M("line",{key:1,x1:e.c0.x,y1:e.c0.y,x2:e.controlOut.x,y2:e.controlOut.y},null,8,AL)):ce("",!0)]),C("g",IL,[e.controlIn?(_(),M("rect",{key:0,x:e.controlIn.x-m(n)/2,y:e.controlIn.y-m(n)/2,width:m(n),height:m(n)},null,8,PL)):ce("",!0),e.controlOut?(_(),M("rect",{key:1,x:e.controlOut.x-m(n)/2,y:e.controlOut.y-m(n)/2,width:m(n),height:m(n)},null,8,BL)):ce("",!0)]),C("g",LL,[e.controlIn?(_(),M("rect",{key:0,x:e.controlIn.x-m(n),y:e.controlIn.y-m(n),width:m(n)*2,height:m(n)*2,"data-type":"bezier-control","data-id":e.pointId,"data-key":e.pointKey,"data-control_in":"true"},null,8,RL)):ce("",!0),e.controlOut?(_(),M("rect",{key:1,x:e.controlOut.x-m(n),y:e.controlOut.y-m(n),width:m(n)*2,height:m(n)*2,"data-type":"bezier-control","data-id":e.pointId,"data-key":e.pointKey,"data-control_out":"true"},null,8,jL)):ce("",!0)])]))}}),VL=["d","stroke","stroke-width"],DL=J({__name:"CurveBezier3",props:{c0:null,c1:null,c2:null,c3:null,color:{default:"#fff"},scale:{default:1},lineWidth:{default:1}},setup(e){const t=e,n=b(()=>`M ${t.c0.x},${t.c0.y} C ${t.c1.x},${t.c1.y} ${t.c2.x},${t.c2.y} ${t.c3.x},${t.c3.y}`);return(a,o)=>(_(),M("path",{d:m(n),stroke:e.color,"stroke-width":e.lineWidth*e.scale},null,8,VL))}}),FL=["stroke-width"],UL=["x1","y1","x2","y2"],GL=["x1","y1","x2","y2"],KL=J({__name:"CurveConstant",props:{from:null,to:null,color:{default:"#fff"},scale:{default:1},lineWidth:{default:1}},setup(e){return(t,n)=>(_(),M("g",{"stroke-width":e.lineWidth*e.scale},[C("line",{x1:e.from.x,y1:e.from.y,x2:e.to.x,y2:e.from.y},null,8,UL),C("line",{x1:e.to.x,y1:e.from.y,x2:e.to.x,y2:e.to.y},null,8,GL)],8,FL))}}),zL=["stroke","stroke-width"],YL=["x1","y1","x2","y2"],XL=["x1","y1","x2","y2"],HL={key:1},WL=["x1","y1","x2","y2","stroke-width"],JL=J({__name:"GraphCurveLine",props:{curve:null,first:{type:Boolean,default:!1},last:{type:Boolean,default:!1},color:{default:"#fff"},scale:{default:1},lineWidth:{default:1}},setup(e){return(t,n)=>(_(),M("g",{stroke:e.color,"stroke-width":e.lineWidth*e.scale,fill:"none"},[e.first?(_(),M("line",{key:0,x1:e.curve.from.x-2e4,y1:e.curve.from.y,x2:e.curve.from.x,y2:e.curve.from.y},null,8,YL)):ce("",!0),e.last?(_(),M("line",{key:1,x1:e.curve.from.x,y1:e.curve.from.y,x2:e.curve.from.x+2e4,y2:e.curve.from.y},null,8,XL)):e.curve.to?(_(),M(ye,{key:2},[e.curve.name==="bezier3"?(_(),Se(DL,{key:0,c0:e.curve.from,c1:e.curve.fixedC1,c2:e.curve.fixedC2,c3:e.curve.to,color:e.color,scale:e.scale,"line-width":e.lineWidth},null,8,["c0","c1","c2","c3","color","scale","line-width"])):e.curve.name==="constant"?(_(),M("g",HL,[w(KL,{from:e.curve.from,to:e.curve.to,color:e.color,scale:e.scale,"line-width":e.lineWidth},null,8,["from","to","color","scale","line-width"])])):(_(),M("line",{key:2,x1:e.curve.from.x,y1:e.curve.from.y,x2:e.curve.to.x,y2:e.curve.to.y,"stroke-width":e.lineWidth*e.scale},null,8,WL))],64)):ce("",!0)],8,zL))}}),qL=J({__name:"GraphCurveLines",props:{curves:null,color:{default:"#fff"},scale:{default:1},lineWidth:{default:1}},setup(e){return(t,n)=>(_(),M("g",null,[(_(!0),M(ye,null,Pe(e.curves,a=>(_(),M("g",{key:a.id},[w(JL,{curve:a,color:e.color,scale:e.scale,first:a.first,last:a.last,"line-width":e.lineWidth},null,8,["curve","color","scale","first","last","line-width"])]))),128))]))}}),ZL={class:"view-only"},QL=["cx","cy","r","stroke","stroke-width","fill","data-id","data-key"],cd=J({__name:"GraphKeyPoints",props:{pointKey:null,keyframes:null,selectedStateMap:{default:()=>({})},color:{default:"#fff"},focused:{type:Boolean,default:!1}},setup(e){const t=e,{settings:n}=Ct(),a=b(()=>cB({keyframes:t.keyframes,selectedStateMap:t.selectedStateMap,pointKey:t.pointKey,valueWidth:n.graphValueWidth})),o=wn(),r=b(()=>t.focused?6.5:5),s=b(()=>t.focused?2.5:1),l=b(o),u=b(()=>n.selectedColor);return(i,c)=>(_(),M("g",null,[C("g",ZL,[w(qL,{curves:m(a),color:e.color,scale:m(l),"line-width":m(s)},null,8,["curves","color","scale","line-width"])]),C("g",null,[(_(!0),M(ye,null,Pe(m(a),p=>(_(),M("g",{key:p.id},[C("title",null,Ve(e.pointKey),1),C("circle",{cx:p.from.x,cy:p.from.y,r:m(r)*m(l),stroke:p.selected?"#000":"#777","stroke-width":m(l),fill:p.selected?m(u):e.color,"data-type":"keyframe-prop","data-id":p.id,"data-key":e.pointKey},null,8,QL)]))),128))]),C("g",null,[(_(!0),M(ye,null,Pe(m(a),p=>(_(),M("g",{key:p.id},[p.selected?(_(),Se(NL,{key:0,"point-id":p.id,"point-key":e.pointKey,c0:p.from,"control-in":p.controlIn,"control-out":p.controlOut,color:e.color,scale:m(l)},null,8,["point-id","point-key","c0","control-in","control-out","color","scale"])):ce("",!0)]))),128))])]))}}),eR=J({__name:"GraphKeyframes",props:{keyframeMapByFrame:{default:()=>({})},selectedKeyframeMap:{default:()=>({})},colorMap:{default:()=>({})},propsStateMap:{default:()=>({})}},emits:["select","shift-select","down-control"],setup(e,{emit:t}){const n=e,a=b(()=>Ka(Object.keys(n.keyframeMapByFrame).flatMap(f=>n.keyframeMapByFrame[f]))),o=b(()=>Object.keys(a.value).reduce((f,h)=>{const y=a.value[h];return f[h]=om(y,y0(y,"name","bone")),f[h].props=Object.keys(f[h].props).reduce((k,E)=>(f[h].props[E].length>0&&(k[E]=f[h].props[E]),k),{}),f},{})),r=b(()=>KE(o.value,s));function s(f,h){var y;return((y=n.propsStateMap[f])==null?void 0:y.props[h])==="selected"}function l(f,h){t("select",f,h)}function u(f,h){t("shift-select",f,h)}function i(f,h,y){t("down-control",f,h,y)}const c=Wb(()=>ie(Of(n.keyframeMapByFrame)),o);pt(()=>n.selectedKeyframeMap,c.updateCache);function p(f,h){return o.value[f].props[h].some(y=>{var k;return(k=n.selectedKeyframeMap[y.id])==null?void 0:k.props[h]})}function d(f,h){var k,E;if(p(f,h))return o.value[f].props[h];const y=(E=(k=c.cache.value)==null?void 0:k[f])==null?void 0:E.props[h];return y||(console.warn(`Invalid cache for id: ${f} key: ${h}: Fallback to original data.`),o.value[f].props[h])}return(f,h)=>(_(),M("g",null,[C("g",null,[(_(!0),M(ye,null,Pe(Object.entries(m(r).falseMap),([y,k])=>(_(),M("g",{key:y},[(_(!0),M(ye,null,Pe(Object.keys(k.props),E=>(_(),Se(cd,{key:E,"point-key":E,keyframes:d(y,E),"selected-state-map":e.selectedKeyframeMap,color:e.colorMap[E],onSelect:l,onShiftSelect:u,onDownControl:i},null,8,["point-key","keyframes","selected-state-map","color"]))),128))]))),128))]),C("g",null,[(_(!0),M(ye,null,Pe(Object.entries(m(r).trueMap),([y,k])=>(_(),M("g",{key:y},[(_(!0),M(ye,null,Pe(Object.keys(k.props),E=>(_(),Se(cd,{key:E,"point-key":E,keyframes:d(y,E),"selected-state-map":e.selectedKeyframeMap,color:e.colorMap[E],focused:"",onSelect:l,onShiftSelect:u,onDownControl:i},null,8,["point-key","keyframes","selected-state-map","color"]))),128))]))),128))])]))}}),tR=["transform"],nR=C("rect",{width:"10",height:"10",stroke:"none",class:"fill-background-second"},null,-1),aR=C("path",{d:"M2 5L7 2L7 8z","stroke-linejoin":"round",stroke:"none",class:"fill-background"},null,-1),oR=[nR,aR],dd=J({__name:"PlayIcon",props:{flipped:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10",transform:`scale(${e.flipped?1:-1}, 1)`},oR,8,tR))}}),rR={},sR={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 21 10"},lR=C("rect",{width:"21",height:"10",stroke:"none",class:"fill-background-second"},null,-1),uR=C("line",{x1:"8",y1:"2",x2:"8",y2:"8",class:"stroke-background","stroke-width":"1.5"},null,-1),iR=C("line",{x1:"12",y1:"2",x2:"12",y2:"8",class:"stroke-background","stroke-width":"1.5"},null,-1),cR=[lR,uR,iR];function dR(e,t){return _(),M("svg",sR,cR)}const fR=Me(rR,[["render",dR]]),pR=["transform"],mR=C("rect",{width:"10",height:"10",stroke:"none",class:"fill-background-second"},null,-1),hR=C("path",{d:"M5 5L8 2L8 8z","stroke-linejoin":"round",stroke:"none",class:"fill-background"},null,-1),yR=C("circle",{cx:"3",cy:"5",r:"1.5",stroke:"none",class:"fill-background"},null,-1),vR=[mR,hR,yR],fd=J({__name:"JumpKeyIcon",props:{flipped:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10",transform:`scale(${e.flipped?1:-1}, 1)`},vR,8,pR))}}),gR=["transform"],bR=C("rect",{width:"10",height:"10",stroke:"none",class:"fill-background-second"},null,-1),_R=C("path",{d:"M5 5L8 2L8 8z","stroke-linejoin":"round",stroke:"none",class:"fill-background"},null,-1),SR=C("line",{x1:"3",y1:"2",x2:"3",y2:"8","stroke-width":"1.2",class:"stroke-background"},null,-1),xR=[bR,_R,SR],pd=J({__name:"JumpEndIcon",props:{flipped:{type:Boolean,default:!1}},setup(e){return(t,n)=>(_(),M("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10",transform:`scale(${e.flipped?1:-1}, 1)`},xR,8,gR))}}),wR={class:"animation-controller"},kR=J({__name:"AnimationController",props:{playing:{default:"pause"}},emits:["jump-end","jump-start","play","pause","reverse","jump-next","jump-prev"],setup(e,{emit:t}){return(n,a)=>(_(),M("div",wR,[C("button",{type:"button",title:"jump to start",onClick:a[0]||(a[0]=o=>t("jump-start"))},[w(pd,{flipped:""})]),C("button",{type:"button",title:"jump to prev keyframe",onClick:a[1]||(a[1]=o=>t("jump-prev"))},[w(fd,{flipped:""})]),e.playing!=="pause"?(_(),M("button",{key:0,type:"button",title:"pause",class:"pause-button",onClick:a[2]||(a[2]=o=>t("pause"))},[w(fR)])):(_(),M(ye,{key:1},[C("button",{type:"button",title:"reverse",onClick:a[3]||(a[3]=o=>t("reverse"))},[w(dd,{flipped:""})]),C("button",{type:"button",title:"play",onClick:a[4]||(a[4]=o=>t("play"))},[w(dd)])],64)),C("button",{type:"button",title:"jump to next keyframe",onClick:a[5]||(a[5]=o=>t("jump-next"))},[w(fd)]),C("button",{type:"button",title:"jump to end",onClick:a[6]||(a[6]=o=>t("jump-end"))},[w(pd)])]))}});const ER=Me(kR,[["__scopeId","data-v-f0f968c5"]]),CR=e=>(it("data-v-8d6d92d7"),e=e(),ct(),e),MR={class:"graph-panel-wrapper"},OR=CR(()=>C("hr",null,null,-1)),TR=Jp.map(e=>({label:e.label,value:e.name})),$R=J({__name:"GraphPanel",props:{keyframe:null,selectedState:null},emits:["update"],setup(e,{emit:t}){const n=e,a=b(()=>{if(n.selectedState)return Object.keys(n.selectedState.props)[0]}),o=b(()=>{var c;if(a.value)return(c=n.keyframe)==null?void 0:c.points[a.value]});function r(c,p){!n.keyframe||!n.selectedState||t("update",sm(n.keyframe,n.selectedState,c),p)}function s(c){r(p=>({...p,curve:Wp(c)}))}function l(c,p){r(d=>({...d,value:c}),p)}const{settings:u}=Ct(),i=b({get(){return u.graphValueWidth},set(c){u.graphValueWidth=c}});return(c,p)=>(_(),M("div",MR,[w(vn,{label:"Value Scale"},{default:F(()=>[w(Ae,{modelValue:m(i),"onUpdate:modelValue":p[0]||(p[0]=d=>Fe(i)?i.value=d:null),min:.5,max:10},null,8,["modelValue","min"])]),_:1}),OR,m(o)?(_(),M(ye,{key:0},[w(vn,{label:"Interpolation"},{default:F(()=>[w(Pt,{"model-value":m(o).curve.name,options:m(TR),"no-placeholder":"","onUpdate:modelValue":s},null,8,["model-value","options"])]),_:1}),w(vn,{label:"Value"},{default:F(()=>[w(Ae,{"model-value":m(o).value,"onUpdate:modelValue":l},null,8,["model-value"])]),_:1})],64)):ce("",!0)]))}});const AR=Me($R,[["__scopeId","data-v-8d6d92d7"]]);function kh(e,t){const n=e?`Resizable_${e}`:void 0,a=n?localStorage.getItem(n):void 0,o=H(!1);function r(l){o.value=l}function s(l){n&&o.value&&localStorage.setItem(n,l.toString()),o.value=!1}return{restoredRate:a?parseFloat(a):t,dirty:b(()=>o.value),setDirty:r,save:s}}const IR=e=>(it("data-v-3489d145"),e=e(),ct(),e),PR=IR(()=>C("div",null,null,-1)),BR=[PR],LR=J({__name:"ResizableH",props:{initialRate:{default:.5},minRate:{default:.1},maxRate:{default:.9},dense:{type:Boolean,default:!1},storageKey:{default:""}},setup(e){const t=e,n=kh(t.storageKey,t.initialRate),a=H(),o=H(),r=H(),s=H(n.restoredRate),l=H(100),u=H(100),i=b(()=>t.dense?0:9),c=b(()=>`calc((100% - ${i.value}px) * ${s.value})`),p=b(()=>`calc((100% - ${i.value}px) * ${1-s.value})`);function d(){var E,g;l.value=((E=o.value)==null?void 0:E.getBoundingClientRect().width)??100,u.value=((g=r.value)==null?void 0:g.getBoundingClientRect().width)??100}async function f(E){if(!a.value)return;const g=a.value.getBoundingClientRect();s.value=zt(-5,lt(t.minRate,t.maxRate,(E.p.x-g.left)/g.width)),n.setDirty(!0),await Ha(),d(),window.dispatchEvent(new Event("resize"))}const h=ta(f,1e3/60,!0),y=ys(h);Vo(E=>{E.preventDefault(),y.onMove(E)}),Do(()=>{n.save(s.value),y.onUp()}),Ut(d);const k=y.onDown;return(E,g)=>(_(),M("div",{ref_key:"root",ref:a,class:"resizable-h-wrapper"},[C("div",{ref_key:"left",ref:o,style:st({width:m(c)})},[at(E.$slots,"left",{size:l.value},void 0,!0)],4),e.dense?ce("",!0):(_(),M("div",{key:0,class:"anchor",onMousedown:g[0]||(g[0]=Ke((...v)=>m(k)&&m(k)(...v),["prevent"]))},BR,32)),C("div",{ref_key:"right",ref:r,class:"right",style:st({width:m(p)})},[at(E.$slots,"right",{size:u.value},void 0,!0),e.dense?(_(),M("div",{key:0,class:"anchor-dence",onMousedown:g[1]||(g[1]=Ke((...v)=>m(k)&&m(k)(...v),["prevent"]))},null,32)):ce("",!0)],4)],512))}});const Fr=Me(LR,[["__scopeId","data-v-3489d145"]]);function md(){var e;return((e=performance==null?void 0:performance.now)==null?void 0:e.call(performance))??Date.now()}function RR(e,t=60){let n=0,a=0,o=!1;function r(){if(o)return;const s=Math.floor((md()-n)/(1e3/t)),l=s-a;l>0&&(e(l),a=s),requestAnimationFrame(r)}return{begin(){n=md(),requestAnimationFrame(r)},stop(){o=!0}}}function jR(e){const t=H({});function n(a){t.value[a]?delete t.value[a]:t.value[a]=!0}return pt(e,a=>{const o=a.reduce((r,s)=>({...r,[s]:!0}),{});t.value=Je(t.value,(r,s)=>s in o)}),{booleanMap:t,toggle:n}}const NR={class:"animation-panel-root"},VR={class:"top"},DR={class:"select-action"},FR={class:"action-buttons"},UR=["disabled"],GR={class:"end-frame-field"},KR=["transform"],zR={class:"timeline-canvas-inner"},YR=["transform"],XR=["transform"],HR=["transform"],WR=["transform"],JR={class:"graph-panel-space"},uo=24,qR=[{label:"Action",value:"action"},{label:"Graph",value:"graph"}],ZR={translateX:"red",translateY:"green",rotate:"blue",scaleX:"hotpink",scaleY:"mediumaquamarine",influence:"darkviolet"},QR=J({__name:"AnimationPanel",setup(e){const t=jt(),n=cn(),a=H({width:0,height:0}),o={scaleMin:1,ignoreNegativeY:!0,scaleAtFixY:!0,viewOrigin:H({x:-20,y:0}),viewSize:a},r=go(o),s=go(o),l=go({scaleMin:1,viewOrigin:H({x:-20,y:-50}),viewSize:a}),u=H("action");function i(me){u.value=me}const c=b(()=>{switch(u.value){case"action":return s;default:return l}}),p=b(()=>n.selectedAction.value),d=b(()=>Object.keys(n.selectedBoneIdMap.value)),f=b(()=>ke(n.selectedBoneMap.value)),h=b(()=>Object.keys(n.selectedConstraintMap.value)),y=b(()=>d.value.concat(h.value)),k=b(()=>{const me=n.keyframeMapByTargetId.value,ne=n.selectedBoneMap.value,we=n.selectedConstraintMap.value;return[...f.value.map($=>pk($,Po(me[$.id]??[]).props)),...h.value.map($=>{const P=we[$];return hk(ne[P.boneId],P,Po(me[$]??[]).props)})]}),E=b(()=>{const me=n.editedKeyframeMap.value;return Zn(me?mm(ke({...n.visibledKeyframeMap.value,...me.notSelected}),ke(me.selected),!0).merged:ke(n.visibledKeyframeMap.value))}),g=H("");rn(()=>{var me;g.value=((me=p.value)==null?void 0:me.name)??""});const v=b(()=>n.actions.value.map(me=>{var we;const ne=((we=t.lastSelectedArmature.value)==null?void 0:we.id)!==me.armatureId;return{value:me.id,label:`${ne?"(x)":""} ${me.name}`}}));function A(){var ne;n.actions.value.map(we=>we.name).includes(g.value)?g.value=((ne=p.value)==null?void 0:ne.name)??"":n.updateAction({name:g.value})}const x=b({get:()=>{var me;return((me=p.value)==null?void 0:me.id)??""},set:me=>n.selectAction(me)}),I=H();let O;rn(()=>{O==null||O.stop(),n.playing.value!=="pause"&&(I.value=`play_${Date.now()}`,O=RR(T,60),O.begin())});function T(me){n.stepFrame(me,n.playing.value==="reverse",I.value)}const L=jR(()=>Object.keys(t.boneMap.value).concat(Object.keys(t.constraintMap.value))),R=b(()=>yk(k.value,L.booleanMap.value,uo,2)),{playing:B,visibledTargetPropsStateMap:N,lastSelectedKeyframe:j,selectedKeyframeMap:K,currentFrame:D,setPlaying:fe,jumpStartFrame:Le,jumpEndFrame:Ge,jumpNextKey:vt,jumpPrevKey:$e,selectTargetProp:oe,endFrame:_e,setEndFrame:De}=n,dt=()=>n.addAction(),Mt=()=>n.deleteAction(),Y=L.booleanMap,pe=L.toggle;function Ee(me,ne){n.execUpdateKeyframes({[me.id]:me},ne)}return(me,ne)=>(_(),M("div",NR,[C("div",VR,[w(Vn,{"model-value":u.value,options:qR,"onUpdate:modelValue":i},null,8,["model-value"]),C("div",DR,[w(Pt,{modelValue:m(x),"onUpdate:modelValue":ne[0]||(ne[0]=we=>Fe(x)?x.value=we:null),options:m(v)},null,8,["modelValue","options"])]),Qn(C("input",{"onUpdate:modelValue":ne[1]||(ne[1]=we=>g.value=we),type:"text",onChange:A},null,544),[[Qr,g.value]]),C("div",FR,[C("button",{type:"button",class:"add-action",title:"Add action",onClick:dt},[w(sh)]),C("button",{type:"button",class:"delete-action",title:"Delete action",disabled:!m(x),onClick:Mt},[w(fs)],8,UR)]),w(ER,{playing:m(B),onPlay:ne[2]||(ne[2]=we=>m(fe)("play")),onReverse:ne[3]||(ne[3]=we=>m(fe)("reverse")),onPause:ne[4]||(ne[4]=we=>m(fe)("pause")),onJumpStart:m(Le),onJumpEnd:m(Ge),onJumpNext:m(vt),onJumpPrev:m($e)},null,8,["playing","onJumpStart","onJumpEnd","onJumpNext","onJumpPrev"]),C("div",GR,[w(ue,{label:"End"},{default:F(()=>[w(Ae,{"model-value":m(_e),min:0,integer:"",class:"slider","onUpdate:modelValue":m(De)},null,8,["model-value","onUpdate:modelValue"])]),_:1})])]),w(Fr,{class:"middle","initial-rate":.15,"storage-key":"animation-label",dense:""},{left:F(({size:we})=>[w(Fs,{class:"label-canvas",canvas:m(r),"canvas-type":"label"},{default:F(({scale:$,viewOrigin:P})=>[C("g",{transform:`translate(${P.x}, ${P.y}) scale(${$})`},[w(hL,{"target-list":m(k),"label-width":we+1,"scroll-y":P.y,"target-expanded-map":m(Y),"target-top-map":m(R),"props-state-map":m(N),height:uo,onToggleTargetExpanded:m(pe),onSelect:m(oe)},null,8,["target-list","label-width","scroll-y","target-expanded-map","target-top-map","props-state-map","onToggleTargetExpanded","onSelect"])],8,KR)]),_:2},1032,["canvas"])]),right:F(()=>[w(Fr,{class:"timeline-canvas-space","initial-rate":.8,"storage-key":"animation-timeline",dense:""},{left:F(()=>[C("div",zR,[u.value==="action"?(_(),Se(Fs,{key:0,canvas:m(c),"canvas-type":"action"},{default:F(we=>[C("g",{transform:`translate(0, ${we.viewOrigin.y})`},[w(ud,{scale:we.scale,"origin-x":we.viewOrigin.x,"view-width":we.viewSize.width,"current-frame":m(D),"end-frame":m(_e),"header-height":uo},{default:F(()=>[w(OL,{scale:we.scale,"keyframe-map-by-frame":m(E),"target-list":m(k),"target-ids":m(y),"selected-keyframe-map":m(K),"scroll-y":we.viewOrigin.y,"target-expanded-map":m(Y),"target-top-map":m(R),height:uo},null,8,["scale","keyframe-map-by-frame","target-list","target-ids","selected-keyframe-map","scroll-y","target-expanded-map","target-top-map"])]),_:2},1032,["scale","origin-x","view-width","current-frame","end-frame"])],8,YR)]),_:1},8,["canvas"])):(_(),Se(Fs,{key:1,canvas:m(c),"canvas-type":"graph"},{default:F(we=>[u.value==="graph"?(_(),M("g",{key:0,transform:`translate(${we.viewOrigin.x}, 0)`},[w(ZB,{scale:we.scale,"origin-y":we.viewOrigin.y,"view-width":we.viewSize.width,"view-height":we.viewSize.height},null,8,["scale","origin-y","view-width","view-height"])],8,XR)):ce("",!0),C("g",{transform:`translate(0, ${we.viewOrigin.y})`},[w(ud,{scale:we.scale,"origin-x":we.viewOrigin.x,"view-width":we.viewSize.width,"current-frame":m(D),"end-frame":m(_e),"header-height":uo},{default:F(()=>[C("g",{transform:`translate(0, ${-we.viewOrigin.y})`},[w(eR,{"keyframe-map-by-frame":m(E),"selected-keyframe-map":m(K),"color-map":ZR,"props-state-map":m(N)},null,8,["keyframe-map-by-frame","selected-keyframe-map","props-state-map"])],8,WR)]),_:2},1032,["scale","origin-x","view-width","current-frame","end-frame"])],8,HR)]),_:1},8,["canvas"]))])]),right:F(()=>{var we;return[C("div",JR,[w(AR,{keyframe:m(j),"selected-state":m(K)[(we=m(j))==null?void 0:we.id],onUpdate:Ee},null,8,["keyframe","selected-state"])])]}),_:1},8,["initial-rate"])]),_:1},8,["initial-rate"])]))}});const e2=Me(QR,[["__scopeId","data-v-fab023ec"]]),{settings:hd}=Ct(),t2=J({__name:"NativeElement",props:{element:null,groupSelected:{type:Boolean,default:!1}},setup(e){const t=e,n=ba("selectedMap",b(()=>({}))),a=b(()=>{if(n.value[t.element.id]||t.groupSelected)return{fill:hd.selectedColor,stroke:hd.selectedColor}}),o=b(()=>t.groupSelected||n.value[t.element.id]),r=b(()=>({...Bp({...t.element.attributes,...a.value??{},...Mp(t.element.tag)?{"data-type":"element","data-id":t.element.id}:{}}),key:t.element.id}));return(s,l)=>{const u=jl("NativeElement",!0);return _(),Se(Nl(e.element.tag),Vh(uf(m(r))),{default:F(()=>[(_(!0),M(ye,null,Pe(e.element.children,i=>(_(),M(ye,null,[m(mt)(i)?(_(),M(ye,{key:0},[$t(Ve(i),1)],64)):(_(),Se(u,{key:i.id,element:i,"group-selected":m(o)},null,8,["element","group-selected"]))],64))),256))]),_:1},16)}}});const n2=Me(t2,[["__scopeId","data-v-d792e947"]]),a2={key:0},o2=["x","y","width","height","stroke-width","stroke-dasharray"],r2=["id"],s2=J({__name:"ElementLayer",props:{boneMap:{default:()=>({})},canvasMode:{default:"object"}},setup(e){const t=e,n=jt(),a=Ko(),o=In(),r=dn(),{settings:s}=Ct(),l=b(()=>t.canvasMode!=="weight"?{}:o.selectedElements.value);Wa("selectedMap",l);const u=b(()=>["pose","weight"].includes(t.canvasMode)?t.boneMap:{}),i=b(()=>{if(!n.lastSelectedArmature.value||!o.lastSelectedActor.value||!a.lastSelectedGraph.value||r.canvasMode.value==="edit")return!1;const g=n.lastSelectedArmature.value.id;return g===o.lastSelectedActor.value.armatureId&&g===a.lastSelectedGraph.value.armatureId}),c=b(()=>{if(o.lastSelectedActor.value)return Sm(u.value,o.elementMap.value,o.lastSelectedActor.value.svgTree)}),p=b(()=>{if(!c.value||!i.value||!a.resolvedGraph.value)return c.value;try{const g=a.resolvedGraph.value.context.getObjectMap();return Cm(g,c.value)}catch(g){return console.warn(g),c.value}}),d=b(()=>{if(p.value)return us(p.value.attributes.viewBox)}),f=b(wn()),h=b(()=>f.value),y=b(()=>[2,2].map(g=>g*f.value).join(" ")),k=p,E=b(()=>{var g;return(g=k.value)==null?void 0:g.children.filter(v=>!mt(v))});return(g,v)=>m(k)?(_(),M("g",a2,[m(d)&&m(s).showViewbox?(_(),M("rect",{key:0,x:m(d).x,y:m(d).y,width:m(d).width,height:m(d).height,fill:"none",stroke:"#777","stroke-width":m(h),"stroke-dasharray":m(y)},null,8,o2)):ce("",!0),C("g",{id:m(k).id},[(_(!0),M(ye,null,Pe(m(E),A=>(_(),Se(n2,{key:A.id,element:A},null,8,["element"]))),128))],8,r2)])):ce("",!0)}}),l2=["fill","opacity","stroke-width"],u2=["data-type","data-id"],i2=["d","fill"],c2=["d"],d2=["r","cx","cy","fill","data-type","data-id"],f2=["r","cx","cy","fill","data-type","data-id"],p2=["x1","y1","x2","y2","stroke-dasharray"],m2=["transform","font-size"],h2={class:"fill-background stroke-background"},y2={class:"fill-text",stroke:"none"};function yd(e,t,n,a=!1){const o=Ne(Ce(t,e),.15),r=ee(e,o);return ee(r,Ne(wt(Ne(o,.6),Math.PI/2*(a?-1:1)),n))}function v2(e,t,n){return Math.max(It(e,t)*.04,2*n)}const g2=J({__name:"BoneElm",props:{bone:null,parent:{default:void 0},opacity:{default:1},scale:{default:1},selectedState:{default:()=>({})},poseMode:{type:Boolean,default:!1},readOnly:{type:Boolean,default:!1}},emits:["select"],setup(e,{emit:t}){const n=e,{settings:a}=Ct(),o=b(()=>n.bone.head),r=b(()=>n.bone.tail),s=b(()=>yd(o.value,r.value,n.bone.transform.scale.x)),l=b(()=>yd(o.value,r.value,n.bone.transform.scale.x,!0)),u=b(()=>n.poseMode?n.selectedState.head||n.selectedState.tail:n.selectedState.head&&n.selectedState.tail),i=b(()=>v2(o.value,r.value,n.scale)),c=b(()=>Math.min(1.2*Math.min(n.scale,1),3)),p=b(()=>n.opacity*a.boneOpacity),d=b(()=>a.showBoneName?n.bone.name:""),f=b(()=>dc([o.value,s.value,l.value],!0)),h=b(()=>dc([r.value,s.value,l.value],!0)),y=b(()=>u.value?a.selectedColor:"#ddd"),k=b(()=>u.value?a.selectedColor:"#bbb"),E=b(()=>n.selectedState.head?a.selectedColor:""),g=b(()=>n.selectedState.tail?a.selectedColor:""),v=(A,x)=>{const I=n.poseMode?{head:!0,tail:!0}:x;Pb(A,{plain:()=>t("select",I),shift:()=>t("select",I,{shift:!0}),ctrl:()=>t("select",I,{ctrl:!0})})};return(A,x)=>(_(),M("g",{stroke:"black",fill:m(y),opacity:m(p),"stroke-width":m(c)},[C("title",null,Ve(e.bone.name),1),C("g",{"stroke-linejoin":"bevel","data-type":e.readOnly?void 0:"bone-body","data-id":e.readOnly?void 0:e.bone.id,onClick:x[0]||(x[0]=I=>v(I,{head:!0,tail:!0}))},[C("path",{d:m(f),fill:m(k)},null,8,i2),C("path",{d:m(h)},null,8,c2)],8,u2),C("circle",{r:m(i),cx:m(o).x,cy:m(o).y,fill:m(E),"data-type":e.readOnly?void 0:"bone-head","data-id":e.readOnly?void 0:e.bone.id,onClick:x[1]||(x[1]=I=>v(I,{head:!0}))},null,8,d2),C("circle",{r:m(i),cx:m(r).x,cy:m(r).y,fill:m(g),"data-type":e.readOnly?void 0:"bone-tail","data-id":e.readOnly?void 0:e.bone.id,onClick:x[2]||(x[2]=I=>v(I,{tail:!0}))},null,8,f2),e.parent?(_(),M("line",{key:0,x1:e.parent.tail.x,y1:e.parent.tail.y,x2:m(o).x,y2:m(o).y,"stroke-dasharray":`${1.5*e.scale} ${6*e.scale}`,class:"view-only stroke-text"},null,8,p2)):ce("",!0),m(d)?(_(),M("g",{key:1,transform:`translate(${(m(o).x+m(r).x)/2}, ${(m(o).y+m(r).y)/2})`,"font-size":Math.min(16*e.scale,16),"text-anchor":"middle","dominant-baseline":"middle",class:"view-only"},[C("text",h2,Ve(m(d)),1),C("text",y2,Ve(m(d)),1)],8,m2)):ce("",!0)],8,l2))}});const Eh=Me(g2,[["__scopeId","data-v-36a79d38"]]),b2=["transform","opacity","data-id"],vd=J({__name:"ArmatureElm",props:{armature:null,bones:null,opacity:{default:.8},selected:{type:Boolean,default:!1}},emits:["select"],setup(e,{emit:t}){const n=e,a=b(()=>sp(n.bones)),o=b(wn()),r=b(()=>ie(n.bones)),s=b(()=>ik(n.armature.transform)),l=b(()=>n.selected?{head:!0,tail:!0}:void 0),u=()=>t("select");return(i,c)=>(_(),M("g",{transform:m(s),opacity:e.opacity,"data-type":"armature-body","data-id":e.armature.id},[(_(!0),M(ye,null,Pe(m(a),p=>(_(),Se(Eh,{key:p.id,"read-only":"",bone:p,"selected-state":m(l),parent:m(r)[p.parentId],scale:m(o),onSelect:u},null,8,["bone","selected-state","parent","scale"]))),128))],8,b2))}}),Ch=e=>(it("data-v-3c45c5df"),e=e(),ct(),e),_2={class:"weight-panel"},S2=Ch(()=>C("h4",null,"Weight Paint",-1)),x2={key:1},w2=Ch(()=>C("p",null,"No Item",-1)),k2=[w2],E2=J({__name:"WeightPanel",setup(e){const t=jt(),n=dn(),a=In(),o=n.canvasMode,r=b(()=>a.lastSelectedActor.value),s=b(()=>a.lastSelectedElement.value),l=b(()=>t.armatures.value.find(h=>{var y;return h.id===((y=a.lastSelectedActor.value)==null?void 0:y.armatureId)})),u=b({get(){var h;return((h=s.value)==null?void 0:h.boneId)??""},set(h){a.updateElement({boneId:h})}}),i=b({get(){var h;return((h=s.value)==null?void 0:h.fillBoneId)??""},set(h){a.updateElement({fillBoneId:h})}}),c=b({get(){var h;return((h=s.value)==null?void 0:h.strokeBoneId)??""},set(h){a.updateElement({strokeBoneId:h})}}),p=b({get(){var h;return((h=s.value)==null?void 0:h.viewBoxBoneId)??""},set(h){a.updateElement({viewBoxBoneId:h})}}),d=b(()=>l.value?$f(t.getBonesByArmatureId(l.value.id).map(h=>({value:h.id,label:h.name})),"label"):[]);function f(h){n.dispatchCanvasEvent({type:"state",data:{name:"pick-bone",options:h}})}return(h,y)=>(_(),M("div",_2,[S2,m(o)==="weight"&&m(r)?(_(),M("form",{key:0,onSubmit:y[4]||(y[4]=Ke(()=>{},["prevent"]))},[m(s)?(_(),M(ye,{key:0},[m(s).tag==="svg"?(_(),Se(vn,{key:0,label:"Viewbox"},{default:F(()=>[w(an,{modelValue:m(p),"onUpdate:modelValue":y[0]||(y[0]=k=>Fe(p)?p.value=k:null),name:"viewBoxBoneId",options:m(d),onStartPick:f},null,8,["modelValue","options"])]),_:1})):(_(),M(ye,{key:1},[w(vn,{label:"Transform"},{default:F(()=>[w(an,{modelValue:m(u),"onUpdate:modelValue":y[1]||(y[1]=k=>Fe(u)?u.value=k:null),name:"boneId",options:m(d),onStartPick:f},null,8,["modelValue","options"])]),_:1}),w(vn,{label:"Fill"},{default:F(()=>[w(an,{modelValue:m(i),"onUpdate:modelValue":y[2]||(y[2]=k=>Fe(i)?i.value=k:null),name:"fillBoneId",options:m(d),onStartPick:f},null,8,["modelValue","options"])]),_:1}),w(vn,{label:"Stroke"},{default:F(()=>[w(an,{modelValue:m(c),"onUpdate:modelValue":y[3]||(y[3]=k=>Fe(c)?c.value=k:null),name:"strokeBoneId",options:m(d),onStartPick:f},null,8,["modelValue","options"])]),_:1})],64))],64)):ce("",!0)],32)):(_(),M("div",x2,k2))]))}});const C2=Me(E2,[["__scopeId","data-v-3c45c5df"]]),kn=e=>(it("data-v-1d13a527"),e=e(),ct(),e),M2={key:1,class:"item-panel"},O2=kn(()=>C("h4",null,"Pose",-1)),T2=kn(()=>C("h5",null,"Translate",-1)),$2=kn(()=>C("h5",null,"Rotate",-1)),A2=kn(()=>C("h5",null,"Scale",-1)),I2={key:0,class:"color-popup"},P2={key:1},B2=kn(()=>C("p",null,"No Item",-1)),L2=[B2],R2={key:2,class:"item-panel"},j2=kn(()=>C("h4",null,"Bone",-1)),N2=kn(()=>C("h5",null,"Head",-1)),V2=kn(()=>C("h5",null,"Tail",-1)),D2={key:1},F2=kn(()=>C("p",null,"No Item",-1)),U2=[F2],G2={key:3},K2=kn(()=>C("p",null,"No Item",-1)),z2=[K2],Y2=J({__name:"ItemPanel",setup(e){const t=jt(),n=cn(),a=dn(),o=ha({translateX:0,translateY:0,rotate:0,scaleX:0,scaleY:0}),r=ha({headX:0,headY:0,tailX:0,tailY:0}),s=b(()=>{if(a.canvasMode.value==="object")return;const K=t.lastSelectedBone.value;if(K)return a.canvasMode.value==="edit"?sl(K,a.getEditTransforms(K.id),t.selectedBones.value[K.id]||{}):t.lastSelectedBone.value}),l=b(()=>{var K;return(K=s.value)==null?void 0:K.connected}),u=b(()=>{if(s.value&&a.canvasMode.value==="pose")return Ga(n.getCurrentSelfTransforms(s.value.id),a.getEditPoseTransforms(s.value.id))});pt(u,K=>{K||(i.value=!1)});const i=H(!1);function c(){i.value=!i.value}const p=b(()=>{if(u.value)return eo(u.value)});function d(K,D){if(!u.value)return;const fe=Ql(K);o.translateX=fe.translate.x,o.translateY=fe.translate.y,o.rotate=fe.rotate,o.scaleX=fe.scale.x,O(D)}function f(K,D){r.headX=K,E(D)}function h(K,D){r.headY=K,E(D)}function y(K,D){r.tailX=K,E(D)}function k(K,D){r.tailY=K,E(D)}function E(K){s.value&&t.updateBones({[s.value.id]:{head:{x:r.headX,y:r.headY},tail:{x:r.tailX,y:r.tailY}}},K)}function g(K,D){o.translateX=K,O(D)}function v(K,D){o.translateY=K,O(D)}function A(K,D){o.rotate=K,O(D)}function x(K,D){o.scaleX=K,O(D)}function I(K,D){o.scaleY=K,O(D)}function O(K){s.value&&n.pastePoses({[s.value.id]:ve({translate:{x:o.translateX,y:o.translateY},rotate:o.rotate,scale:{x:o.scaleX,y:o.scaleY}})},K)}const T=b(()=>{if(!s.value)return{};const D=n.getBoneEditedTransforms(s.value.id);return{translateX:D.translate.x!==0,translateY:D.translate.y!==0,scaleX:D.scale.x!==0,scaleY:D.scale.y!==0,rotate:D.rotate!==0}}),L=b(()=>{if(!s.value)return{};const K=n.keyframeMapByTargetId.value[s.value.id];if(!K)return{};const D=n.currentFrame.value;return Q(Po(K).props,fe=>fe.some(Le=>Le.frame===D)?"self":"others")});function R(K){s.value&&n.execInsertKeyframe({[K]:!0})}function B(K){s.value&&n.execDeleteTargetKeyframe(s.value.id,K)}rn(()=>{s.value&&(r.headX=s.value.head.x,r.headY=s.value.head.y,r.tailX=s.value.tail.x,r.tailY=s.value.tail.y)}),rn(()=>{u.value&&(o.translateX=u.value.translate.x,o.translateY=u.value.translate.y,o.rotate=u.value.rotate,o.scaleX=u.value.scale.x,o.scaleY=u.value.scale.y)});const N="20px",j=a.canvasMode;return(K,D)=>m(j)==="weight"?(_(),Se(C2,{key:0})):m(j)==="pose"?(_(),M("div",M2,[O2,m(u)?(_(),M("form",{key:0,onSubmit:D[11]||(D[11]=Ke(()=>{},["prevent"]))},[T2,w(ue,{label:"x","label-width":N},{default:F(()=>[w(Ae,{"model-value":o.translateX,disabled:m(l),"onUpdate:modelValue":g},null,8,["model-value","disabled"]),w(Jt,{status:m(L).translateX,updated:m(T).translateX,onCreate:D[0]||(D[0]=fe=>R("translateX")),onDelete:D[1]||(D[1]=fe=>B("translateX"))},null,8,["status","updated"])]),_:1}),w(ue,{label:"y","label-width":N},{default:F(()=>[w(Ae,{"model-value":o.translateY,disabled:m(l),"onUpdate:modelValue":v},null,8,["model-value","disabled"]),w(Jt,{status:m(L).translateY,updated:m(T).translateY,onCreate:D[2]||(D[2]=fe=>R("translateY")),onDelete:D[3]||(D[3]=fe=>B("translateY"))},null,8,["status","updated"])]),_:1}),$2,w(ue,{"label-width":N},{default:F(()=>[w(Ae,{"model-value":o.rotate,"onUpdate:modelValue":A},null,8,["model-value"]),w(Jt,{status:m(L).rotate,updated:m(T).rotate,onCreate:D[4]||(D[4]=fe=>R("rotate")),onDelete:D[5]||(D[5]=fe=>B("rotate"))},null,8,["status","updated"])]),_:1}),A2,w(ue,{label:"x","label-width":N},{default:F(()=>[w(Ae,{step:.1,"model-value":o.scaleX,"onUpdate:modelValue":x},null,8,["step","model-value"]),w(Jt,{status:m(L).scaleX,updated:m(T).scaleX,onCreate:D[6]||(D[6]=fe=>R("scaleX")),onDelete:D[7]||(D[7]=fe=>B("scaleX"))},null,8,["status","updated"])]),_:1}),w(ue,{label:"y","label-width":N},{default:F(()=>[w(Ae,{step:.1,"model-value":o.scaleY,"onUpdate:modelValue":I},null,8,["step","model-value"]),w(Jt,{status:m(L).scaleY,updated:m(T).scaleY,onCreate:D[8]||(D[8]=fe=>R("scaleY")),onDelete:D[9]||(D[9]=fe=>B("scaleY"))},null,8,["status","updated"])]),_:1}),w(ue,null,{default:F(()=>[w(ch,{class:"color-field",onClickOutside:D[10]||(D[10]=fe=>i.value=!1)},{default:F(()=>[C("button",{type:"button",class:"color-button",onClick:c},[w(Lu,{hsva:m(p)},null,8,["hsva"])]),i.value?(_(),M("div",I2,[w(ih,null,{default:F(()=>[w(uh,{class:"color-picker","model-value":m(p),"extra-hue":"","onUpdate:modelValue":d},null,8,["model-value"])]),_:1})])):ce("",!0)]),_:1})]),_:1})],32)):(_(),M("div",P2,L2))])):m(j)==="edit"?(_(),M("div",R2,[j2,m(s)?(_(),M("form",{key:0,onSubmit:D[12]||(D[12]=Ke(()=>{},["prevent"]))},[N2,w(ue,{label:"x","label-width":N},{default:F(()=>[w(Ae,{"model-value":r.headX,"onUpdate:modelValue":f},null,8,["model-value"])]),_:1}),w(ue,{label:"y","label-width":N},{default:F(()=>[w(Ae,{"model-value":r.headY,"onUpdate:modelValue":h},null,8,["model-value"])]),_:1}),V2,w(ue,{label:"x","label-width":N},{default:F(()=>[w(Ae,{"model-value":r.tailX,"onUpdate:modelValue":y},null,8,["model-value"])]),_:1}),w(ue,{label:"y","label-width":N},{default:F(()=>[w(Ae,{"model-value":r.tailY,"onUpdate:modelValue":k},null,8,["model-value"])]),_:1})],32)):(_(),M("div",D2,U2))])):(_(),M("div",G2,z2))}});const X2=Me(Y2,[["__scopeId","data-v-1d13a527"]]),H2=e=>(it("data-v-db77698a"),e=e(),ct(),e),W2={class:"view-panel"},J2=H2(()=>C("h4",null,"View",-1)),q2=J({__name:"ViewPanel",setup(e){const{settings:t}=Ct();return(n,a)=>(_(),M("div",W2,[J2,C("form",null,[w(ue,null,{default:F(()=>[w(ut,{modelValue:m(t).showBoneName,"onUpdate:modelValue":a[0]||(a[0]=o=>m(t).showBoneName=o),label:"Bone Name"},null,8,["modelValue"])]),_:1}),w(vn,{label:"Bone Opacity"},{default:F(()=>[w(Ae,{modelValue:m(t).boneOpacity,"onUpdate:modelValue":a[1]||(a[1]=o=>m(t).boneOpacity=o),min:0,max:1,step:.1},null,8,["modelValue","step"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{modelValue:m(t).showViewbox,"onUpdate:modelValue":a[2]||(a[2]=o=>m(t).showViewbox=o),label:"Viewbox"},null,8,["modelValue"])]),_:1}),w(ue,null,{default:F(()=>[w(ut,{modelValue:m(t).showAxis,"onUpdate:modelValue":a[3]||(a[3]=o=>m(t).showAxis=o),label:"Axis"},null,8,["modelValue"])]),_:1})])]))}});const Z2=Me(q2,[["__scopeId","data-v-db77698a"]]),Q2=J({__name:"CanvasSideBar",setup(e){const t=b(()=>[{key:"item",label:"Item"},{key:"view",label:"View"}]);return(n,a)=>(_(),Se(lh,{tabs:m(t),"default-tab":"item"},{item:F(()=>[w(X2)]),view:F(()=>[w(Z2)]),_:1},8,["tabs"]))}}),ej=J({__name:"BoneLayer",props:{boneMap:{default:()=>({})},selectedBones:{default:()=>({})},canvasMode:{default:"object"}},emits:["select"],setup(e,{emit:t}){const n=e,a=b(()=>sp(ke(n.boneMap))),o=b(wn());function r(s,l,u){t("select",s,l,u)}return(s,l)=>(_(),M("g",null,[(_(!0),M(ye,null,Pe(m(a),u=>(_(),Se(Eh,{key:u.id,bone:u,parent:e.boneMap[u.parentId],"selected-state":e.selectedBones[u.id],scale:m(o),"pose-mode":e.canvasMode==="pose",onSelect:(i,c)=>r(u.id,i,c)},null,8,["bone","parent","selected-state","scale","pose-mode","onSelect"]))),128))]))}}),tj=["transform"],nj=["stroke-width","stroke-dasharray"],aj=C("line",{x1:"-50",x2:"50",stroke:"red"},null,-1),oj=C("line",{y1:"-50",y2:"50",stroke:"green"},null,-1),rj=[aj,oj],sj=C("path",{d:"M50,0 L40,-5 L40,5z",fill:"red"},null,-1),lj=C("path",{d:"M0,50 L-5,40 L5,40z",fill:"green"},null,-1),uj=J({__name:"SpaceAxis",props:{origin:null,radian:null},setup(e){const t=e,n=b(wn()),a=b(()=>t.radian*180/Math.PI);return(o,r)=>(_(),M("g",{transform:`translate(${e.origin.x}, ${e.origin.y}) rotate(${m(a)})`},[C("g",{"stroke-width":2*m(n),"stroke-dasharray":`${2*m(n)},${2*m(n)}`},rj,8,nj),sj,lj],8,tj))}}),ij=e=>(it("data-v-381f7acb"),e=e(),ct(),e),cj=ij(()=>C("div",null,null,-1)),dj=[cj],fj=J({__name:"ResizableV",props:{initialRate:{default:.5},minRate:{default:.1},maxRate:{default:.9},dense:{type:Boolean,default:!1},storageKey:{default:""}},setup(e){const t=e,n=kh(t.storageKey,t.initialRate),a=H(),o=H(n.restoredRate),r=b(()=>t.dense?0:9),s=b(()=>`calc((100% - ${r.value}px) * ${o.value})`),l=b(()=>`calc((100% - ${r.value}px) * ${1-o.value})`);async function u(d){if(!a.value)return;const f=a.value.getBoundingClientRect();o.value=zt(-5,lt(t.minRate,t.maxRate,(d.p.y-f.top)/f.height)),n.setDirty(!0),await Ha(),window.dispatchEvent(new Event("resize"))}const i=ta(u,1e3/60,!0),c=ys(i);Vo(d=>{d.preventDefault(),c.onMove(d)}),Do(()=>{n.save(o.value),c.onUp()});const p=c.onDown;return(d,f)=>(_(),M("div",{ref_key:"root",ref:a,class:"resizable-v-wrapper"},[C("div",{class:"top",style:st({height:m(s)})},[at(d.$slots,"top",{},void 0,!0)],4),e.dense?ce("",!0):(_(),M("div",{key:0,class:"anchor",onMousedown:f[0]||(f[0]=Ke((...h)=>m(p)&&m(p)(...h),["prevent"]))},dj,32)),C("div",{class:"bottom",style:st({height:m(l)})},[at(d.$slots,"bottom",{},void 0,!0),e.dense?(_(),M("div",{key:0,class:"anchor-dence",onMousedown:f[1]||(f[1]=Ke((...h)=>m(p)&&m(p)(...h),["prevent"]))},null,32)):ce("",!0)],4)],512))}});const gd=Me(fj,[["__scopeId","data-v-381f7acb"]]),pj={class:"main"},mj={key:0},hj={key:1},yj={class:"bottom"},Ta=jt(),ur=dn(),vj=cn(),bd=ea(),Sl=In(),Us=Pu();Ta.createDefaultEntities();Sl.createDefaultEntities();function gj(e){var t;["input","textarea"].includes((t=e.target)==null?void 0:t.tagName.toLowerCase())||(Kn(e)&&e.key.toLowerCase()==="z"?(e.preventDefault(),e.shiftKey?bd.redo():bd.undo()):e.key.toLowerCase()===" "?(e.preventDefault(),vj.togglePlaying()):Kn(e)&&e.key.toLowerCase()==="s"?(e.preventDefault(),Us.overrideProjectFile()):Kn(e)&&e.key.toLowerCase()==="o"&&(e.preventDefault(),e.shiftKey?Us.loadSvgFile():Us.loadProjectFile()))}const bj=J({__name:"App",setup(e){Rb(gj);const t=b(()=>{var p;return(p=Sl.lastSelectedActor.value)==null?void 0:p.viewBox}),n=ur.canvasMode,a=Ta.armatures,o=b(()=>a.value.filter(p=>{var d;return p.id!==((d=Ta.lastSelectedArmature.value)==null?void 0:d.id)})),r=ur.posedBoneMap,s=ur.visibledBoneMap,l=ur.lastSelectedBoneSpace,u=b(()=>{if(n.value==="weight"){const p=Sl.lastSelectedElement.value;return p!=null&&p.boneId?{[p.boneId]:{head:!0,tail:!0}}:{}}else return Ta.selectedBones.value}),i=b(()=>{var p;return(p=Ta.lastSelectedArmature.value)==null?void 0:p.id}),c=Ta.bonesByArmatureId;return(p,d)=>(_(),Se(gd,{"initial-rate":.7,"storage-key":"app-v",class:"app-root"},{top:F(()=>[w(Fr,{"initial-rate":.8,"storage-key":"app-panel-h",dense:"",class:"top"},{left:F(()=>[w(Fr,{"initial-rate":.1,"storage-key":"app-canvas-h",dense:"",class:"main-wrapper"},{left:F(()=>[w(lB,{class:"animation-graph"})]),right:F(()=>[C("div",pj,[w(wM,{"original-view-box":m(t),class:"canvas"},{default:F(()=>[w(s2,{"bone-map":m(r),"canvas-mode":m(n),class:et({"view-only":m(n)!=="weight"})},null,8,["bone-map","canvas-mode","class"]),m(n)==="object"?(_(),M("g",mj,[(_(!0),M(ye,null,Pe(m(a),f=>(_(),Se(vd,{key:f.id,armature:f,bones:m(c)[f.id],selected:m(i)===f.id},null,8,["armature","bones","selected"]))),128))])):(_(),M("g",hj,[(_(!0),M(ye,null,Pe(m(o),f=>(_(),Se(vd,{key:f.id,armature:f,bones:m(c)[f.id],opacity:.3,class:"view-only"},null,8,["armature","bones","opacity"]))),128)),w(ej,{"bone-map":m(s),"selected-bones":m(u),"canvas-mode":m(n)},null,8,["bone-map","selected-bones","canvas-mode"]),m(l)?(_(),Se(uj,{key:0,origin:m(l).origin,radian:m(l).radian,class:"view-only"},null,8,["origin","radian"])):ce("",!0)]))]),_:1},8,["original-view-box"]),w(Q2,{class:"side-bar"})])]),_:1},8,["initial-rate"])]),right:F(()=>[w(gd,{"initial-rate":.4,"storage-key":"app-side",dense:"",class:"side-panel"},{top:F(()=>[w(Kc)]),bottom:F(()=>[w(Kc,{"initial-tab":"detail"})]),_:1},8,["initial-rate"])]),_:1},8,["initial-rate"])]),bottom:F(()=>[C("div",yj,[w(e2)])]),_:1},8,["initial-rate"]))}});const _j=Me(bj,[["__scopeId","data-v-01a932a6"]]);ag(_j).mount("#app");
